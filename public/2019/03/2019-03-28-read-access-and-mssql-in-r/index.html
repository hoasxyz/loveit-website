<!DOCTYPE html>
<html lang="zh">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>R语言读取Access和MS SQL | hoas&#39; blog | One Stupid Boy</title><meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="robots" content="noodp" />
<meta name="Description" content="R语言读取Access">
<link rel="prev" href="/2019/03/2019-03-25-human-face-detection-with-r/" />
<link rel="next" href="/2019/03/2019-03-28-read-and-write-excel-in-cs/" />
<link rel="canonical" href="/2019/03/2019-03-28-read-access-and-mssql-in-r/" />
<link rel='shortcut icon' type='image/x-icon' href='/favicon.ico' />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="R语言读取Access和MS SQL"/>
<meta name="twitter:description" content="R语言读取Access"/>
<script type="application/ld+json">
    {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "headline": "R语言读取Access和MS SQL",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "\/2019\/03\/2019-03-28-read-access-and-mssql-in-r\/"
    },
    
        "image": {
            "@type": "ImageObject",
            "url": "\/cover.png",
            "width":  800 ,
            "height":  600 
        },
    
    "genre": "posts",
    
        "keywords": "R, Access",
    
    "wordcount":  2065 ,
    "url": "\/2019\/03\/2019-03-28-read-access-and-mssql-in-r\/",
    
        "datePublished": "2019-03-28T00:00:00\x2b00:00",
    
    
        "dateModified": "2019-03-28T12:33:10\x2b08:00",
    
    
        "license": "This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.",
    
    
        "publisher": {
            "@type": "Organization",
            "name": "XXXX",
            "logo": {
            "@type": "ImageObject",
            "url": "\/logo.png",
            "width":  127 ,
            "height":  40 
            }
        },
    
    
    "description": "R语言读取Access"
    }
    </script>
<link rel="stylesheet" href="/css/style.min.css">
<link rel="stylesheet" href="/css/lib/fontawesome-free/all.min.min.css">

<link rel="stylesheet" href="/css/lib/animate/animate.min.min.css">

        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.11.2/css/all.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    </head>
    <body>
        <script>
            window.isDark = (window.localStorage && window.localStorage.getItem('theme')) === 'dark';
            window.isDark && document.body.classList.add('dark-theme');
        </script>
        <div class="wrapper">
            <nav class="navbar">
    <div class="navbar-container">
        <div class="navbar-header">
            <a href="/">hoas&#39; blog | One Stupid Boy</a>
        </div>
        <div class="navbar-menu">
            
            
                <a class="menu-item" href="/posts/" title="">文章</a>
            
                <a class="menu-item" href="/tags/" title="">标签</a>
            
                <a class="menu-item" href="/categories/" title="">目录</a>
            
                <a class="menu-item" href="/about/" title="">关于</a>
            
            <a href="javascript:void(0);" class="theme-switch"><i class="fas fa-adjust fa-rotate-180 fa-fw"></i></a>
        </div>
    </div>
</nav>
<nav class="navbar-mobile">
     <div class="navbar-container">
        <div class="navbar-header">
            <div><a href="javascript:void(0);" class="theme-switch"><i class="fas fa-adjust fa-rotate-180 fa-fw"></i></a><a href="/">hoas&#39; blog | One Stupid Boy</a></div>
            <div class="menu-toggle" id="menu-toggle">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="navbar-menu" id="mobile-menu">
            
            
                <a class="menu-item" href="/posts/" title="">文章</a>
            
                <a class="menu-item" href="/tags/" title="">标签</a>
            
                <a class="menu-item" href="/categories/" title="">目录</a>
            
                <a class="menu-item" href="/about/" title="">关于</a>
            
        </div>
    </div>
</nav><main class="main">
                <div class="container">
                    
    
    
    
       
    

    <article class="post-warp">
        <h1 class="post-title animated flipInX">R语言读取Access和MS SQL</h1>

        <div class="post-meta">
            <div class="post-meta-main">
                <a class="author" href="/" rel="author"><i class="fas fa-user-circle fa-fw"></i>hoas&nbsp;</a>
                <span class="post-category">
                        收录于
                        <i class="far fa-folder fa-fw"></i><a href="/categories/course/">course</a>
                            
                    </span>
            </div>
            <div class="post-meta-other">
                <i class="far fa-calendar-alt fa-fw"></i><time datetime=2019-03-28>2019-03-28</time>&nbsp;
                <i class="fas fa-pencil-alt fa-fw"></i>约 2065 字&nbsp;
                <i class="far fa-clock fa-fw"></i>预计阅读 5 分钟&nbsp;</div>
        </div>

        

        <div class="post-toc" id="post-toc">
                <h2 class="post-toc-title">目录</h2>
                <div class="post-toc-content always-active">
                    <nav id="TableOfContents">
<ul>
<li><a href="#基本配置信息">基本配置信息</a></li>
<li><a href="#access">Access</a>
<ul>
<li><a href="#报错一">报错一</a>
<ul>
<li><a href="#数据源">数据源</a></li>
<li><a href="#驱动程序">驱动程序</a></li>
</ul></li>
<li><a href="#报错二">报错二</a></li>
<li><a href="#读取">读取</a></li>
</ul></li>
<li><a href="#ms-sql">MS SQL</a></li>
</ul>
</nav>
                </div>
            </div>
            <div class="post-toc-mobile" id="post-toc-mobile">
                <details>
                    <summary><div class="post-toc-title"><span>目录</span><span><i class="details icon fas fa-angle-down"></i></span></div></summary>
                    <div class="post-toc-content">
                        
                        
                        <nav id="TableOfContentsMobile">
<ul>
<li><a href="#基本配置信息">基本配置信息</a></li>
<li><a href="#access">Access</a>
<ul>
<li><a href="#报错一">报错一</a>
<ul>
<li><a href="#数据源">数据源</a></li>
<li><a href="#驱动程序">驱动程序</a></li>
</ul></li>
<li><a href="#报错二">报错二</a></li>
<li><a href="#读取">读取</a></li>
</ul></li>
<li><a href="#ms-sql">MS SQL</a></li>
</ul>
</nav>
                    </div>
                </details>
            </div>

        <div class="post-content">
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            <p>用 R 语言读取 Access和MS SQL 的经历，通过 ODBC 。十分感谢万飚老师的帮助！</p>

<blockquote>
<p><strong>ODBC</strong>（<strong>Open Database Connectivity</strong>，开放数据库互连）提供了一种标准的<a href="https://zh.wikipedia.org/wiki/%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E6%8E%A5%E5%8F%A3">API</a>（<a href="https://zh.wikipedia.org/wiki/%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E7%BC%96%E7%A8%8B%E6%8E%A5%E5%8F%A3">应用程序编程接口</a>）方法来访问<a href="https://zh.wikipedia.org/wiki/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F">数据库管理系统</a>（DBMS）。这些API利用<a href="https://zh.wikipedia.org/wiki/SQL">SQL</a>来完成其大部分任务。ODBC本身也提供了对SQL语言的支持，用户可以直接将SQL语句送给ODBC。ODBC的设计者们努力使它具有最大的独立性和开放性：与具体的编程语言无关，与具体的数据库系统无关，与具体的操作系统无关。</p>
</blockquote>

<p>ODBC可以在<code>控制面板</code>&ndash;<code>ODBC</code>中打开。</p>

<a class="post-dummy-target" id="基本配置信息"></a><h1>基本配置信息</h1>

<ul>
<li>win 10 ，x64 系统</li>
<li>O365ProPlusRetail，x64 <strong>体系架构</strong></li>
<li>64和32位的 R</li>
<li>MS SQL 2014</li>
</ul>

<a class="post-dummy-target" id="access"></a><h1>Access</h1>

<a class="post-dummy-target" id="报错一"></a><h2>报错一</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-c" data-lang="c"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-c" data-lang="c"><span class="n">Warning</span> <span class="nl">messages</span><span class="p">:</span>
<span class="mi">1</span><span class="o">:</span> <span class="n">In</span> <span class="n">odbcDriverConnect</span><span class="p">(</span><span class="n">con</span><span class="p">,</span> <span class="p">...)</span> <span class="o">:</span>
  <span class="p">[</span><span class="n">RODBC</span><span class="p">]</span> <span class="nl">ERROR</span><span class="p">:</span> <span class="n">state</span> <span class="n">IM002</span><span class="p">,</span> <span class="n">code</span> <span class="mi">0</span><span class="p">,</span> <span class="n">message</span> <span class="p">[</span><span class="n">Microsoft</span><span class="p">][</span><span class="n">ODBC</span> <span class="err">驱动程序管理器</span><span class="p">]</span> <span class="err">未发现数据源名称并且未指定默认驱动程序</span>
<span class="mi">2</span><span class="o">:</span> <span class="n">In</span> <span class="n">odbcDriverConnect</span><span class="p">(</span><span class="n">con</span><span class="p">,</span> <span class="p">...)</span> <span class="o">:</span> <span class="n">ODBC</span> <span class="n">connection</span> <span class="n">failed</span></code></pre></td></tr></table>
</div>
</div>
<p>这个问题分数据源和默认驱动程序两部分。</p>

<a class="post-dummy-target" id="数据源"></a><h3>数据源</h3>

<p>在控制面板管理工具中的<code>ODBC</code>处——设置 ODBC 数据源。这里分为32位和64位，但是我没有明白明确的区别，不过这个不重要。</p>

<p>随便点开一个可以发现<code>DSN</code>和驱动程序。我的电脑上默认的三个数据源都是不能配置的，只能添加和删除。点开添加，发现32位的 ODBC 的驱动程序比较齐全而64位的就仨（因为我装了 SQL）。</p>

<a class="post-dummy-target" id="驱动程序"></a><h3>驱动程序</h3>

<p>接上，可以看到驱动程序。我的电脑需要安装一个和office没有保持同一个体系架构的<code>engine</code>——Microsoft Access Database Engine 2010 Redistributable。装好后驱动程序就有了，添加后也有了<code>.accdb</code>后缀的驱动程序（<code>driver</code>）。</p>

<p>注意这里是2010版本的，我曾经尝试过16版本的，failed。如果装了64位的engine，那么会<strong>在64位的 ODBC 中进行添加操作会出现64位的数据源</strong>。当然我们这里是32位。</p>

<p>添加好后，需要在自定义的数据源里选择你要导入的数据库——这也是万老师说的使用 ODBC 的缺点，每次都要设置。没设置的情况尚未测试。</p>

<a class="post-dummy-target" id="报错二"></a><h2>报错二</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-c" data-lang="c"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-c" data-lang="c"><span class="n">Warning</span> <span class="nl">messages</span><span class="p">:</span>
<span class="mi">1</span><span class="o">:</span> <span class="n">In</span> <span class="n">RODBC</span><span class="o">::</span><span class="n">odbcDriverConnect</span><span class="p">(</span><span class="s">&#34;DSN=hoas&#34;</span><span class="p">)</span> <span class="o">:</span>
  <span class="p">[</span><span class="n">RODBC</span><span class="p">]</span> <span class="nl">ERROR</span><span class="p">:</span> <span class="n">state</span> <span class="n">IM014</span><span class="p">,</span> <span class="n">code</span> <span class="mi">0</span><span class="p">,</span> <span class="n">message</span> <span class="p">[</span><span class="n">Microsoft</span><span class="p">][</span><span class="n">ODBC</span> <span class="err">驱动程序管理器</span><span class="p">]</span> <span class="err">在指定的</span> <span class="n">DSN</span> <span class="err">中，驱动程序和应用程序之间的体系结构不匹配</span>
<span class="mi">2</span><span class="o">:</span> <span class="n">In</span> <span class="n">RODBC</span><span class="o">::</span><span class="n">odbcDriverConnect</span><span class="p">(</span><span class="s">&#34;DSN=hoas&#34;</span><span class="p">)</span> <span class="o">:</span> <span class="n">ODBC</span> <span class="n">connection</span> <span class="n">failed</span></code></pre></td></tr></table>
</div>
</div>
<p>其实按照上述报错一的操作已经么得这个问题了，网上有很多人测试说要用32位的 R ，但是我这里测试后两个都行。至于这个驱动程序和应用程序分别是什么，我不太清楚。老师的意思应该是<code>engine</code>就是驱动，因为我装的是32位的驱动，创建了32位的数据源，然后调用成功，<strong>尽管我的 office 和 R 都是64位的</strong>。如果要我强行解释，那么我会说向下兼容……</p>

<p>对了，R 中要设置的好像是工作路径要和数据库一致。</p>

<a class="post-dummy-target" id="读取"></a><h2>读取</h2>

<p>这里试了两种最后成功了的方法：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-c" data-lang="c"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-c" data-lang="c"><span class="n">library</span><span class="p">(</span><span class="n">RODBC</span><span class="p">)</span>
<span class="n">a</span> <span class="o">&lt;-</span> <span class="n">odbcConnect</span><span class="p">(</span><span class="s">&#34;hoas&#34;</span><span class="p">)</span>
<span class="n">acc</span> <span class="o">&lt;-</span> <span class="n">odbcConnectAccess2007</span><span class="p">(</span><span class="n">access</span><span class="p">.</span><span class="n">file</span> <span class="o">=</span> <span class="s">&#34;E:/1R/Database1.accdb&#34;</span><span class="p">,</span><span class="n">uid</span> <span class="o">=</span> <span class="s">&#34;hoas&#34;</span><span class="p">)</span>
<span class="cp"># conn &lt;- odbcDriverConnect(&#34;Driver={Microsoft Access Driver (*.mdb, *.accdb)};DBQ=&#39;E:/1R/Database1.accdb&#39;&#34;) 
</span><span class="cp"></span>
<span class="n">a</span>
<span class="cp">#&gt; RODBC Connection 1
</span><span class="cp">#&gt; Details:
</span><span class="cp">#&gt;   case=nochange
</span><span class="cp">#&gt;   DSN=hoas
</span><span class="cp">#&gt;   DBQ=E:\1R\Database1.accdb
</span><span class="cp">#&gt;   DriverId=25
</span><span class="cp">#&gt;   FIL=MS Access
</span><span class="cp">#&gt;   MaxBufferSize=2048
</span><span class="cp">#&gt;   PageTimeout=5
</span><span class="cp"></span><span class="n">acc</span>
<span class="cp">#&gt; RODBC Connection 2
</span><span class="cp">#&gt; Details:
</span><span class="cp">#&gt;   case=nochange
</span><span class="cp">#&gt;   DBQ=E:\1R\Database1.accdb
</span><span class="cp">#&gt;   Driver={Microsoft Access Driver (*.mdb, *.accdb)}
</span><span class="cp">#&gt;   DriverId=25
</span><span class="cp">#&gt;   FIL=MS Access
</span><span class="cp">#&gt;   MaxBufferSize=2048
</span><span class="cp">#&gt;   PageTimeout=5
</span><span class="cp">#&gt;   UID=admin
</span><span class="cp"></span><span class="n">sqlFetch</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="s">&#34;T_Class&#34;</span><span class="p">)</span>
<span class="cp">#&gt;    ClassCode ClassName MajorCode
</span><span class="cp">#&gt; 1      61121   生物061    110002
</span><span class="cp">#&gt; 2      71111   食品071    110001
</span><span class="cp">#&gt; 3      71121   生物071    110002
</span><span class="cp">#&gt; 4      71211 计算机071    120001
</span><span class="cp">#&gt; 5      71212 计算机072    120001
</span><span class="cp">#&gt; 6      71221   软件071    120002
</span><span class="cp">#&gt; 7      81221   软件081    120002
</span><span class="cp">#&gt; 8      91105   软件091    120001
</span><span class="cp">#&gt; 9      91109   软件092    120002
</span><span class="cp">#&gt; 10    222222   软件089    120002
</span><span class="cp"></span><span class="n">sqlFetch</span><span class="p">(</span><span class="n">acc</span><span class="p">,</span> <span class="s">&#34;T_Course&#34;</span><span class="p">)</span>
<span class="cp">#&gt;    CourseCode         CourseName Credit    Academy ClassTime LabTime
</span><span class="cp">#&gt; 1      100002           数学分析      3     理学院        32      16
</span><span class="cp">#&gt; 2      100003       空间解析几何      3     理学院        48       0
</span><span class="cp">#&gt; 3      100004       数学专业导论      1     理学院        20      12
</span><span class="cp">#&gt; 4      110001         生物信息学      2   化工学院        32       8
</span><span class="cp">#&gt; 5      110002       分析化学概论      4   化工学院        48      16
</span><span class="cp">#&gt; 6      110003           物理化学      4   化工学院        48      16
</span><span class="cp">#&gt; 7      110006 食品分析与卫生检验      2   化工学院        20      12
</span><span class="cp">#&gt; 8      120001         计算机原理      3 计算机学院        30      19
</span><span class="cp">#&gt; 9      120002   数据库原理及应用      4 计算机学院        32      35
</span><span class="cp">#&gt; 10     120003           软件工程      3 计算机学院        32      17
</span><span class="cp">#&gt; 11     130001           体育舞蹈      2     文学院        20      18
</span><span class="cp">#&gt; 12     130002             武术史      2     文学院        32       0
</span><span class="cp">#&gt; 13     130004       竞技武术理论      2     文学院        32       0
</span><span class="cp">#&gt; 14     130005         伤科推拿学      2     文学院        16      16
</span><span class="cp">#&gt; 15     150001               软件      3     计算机        48      32
</span><span class="cp">#&gt; 16     500001               历史      1     文学院        10       0
</span><span class="cp">#&gt; 17     700003               政治      2   所有学院        20      10
</span><span class="cp">#&gt;    TotalStudent Teacher Description
</span><span class="cp">#&gt; 1           100  王志民          NA
</span><span class="cp">#&gt; 2            80  赵可霞          NA
</span><span class="cp">#&gt; 3           140  毛芝闻          NA
</span><span class="cp">#&gt; 4            60  白瑞欣          NA
</span><span class="cp">#&gt; 5            80    刘洁          NA
</span><span class="cp">#&gt; 6           130    张超          NA
</span><span class="cp">#&gt; 7            70  马建军          NA
</span><span class="cp">#&gt; 8            80    王岚          NA
</span><span class="cp">#&gt; 9           100    李明          NA
</span><span class="cp">#&gt; 10           80  李政道          NA
</span><span class="cp">#&gt; 11           20    杜岚          NA
</span><span class="cp">#&gt; 12           50  石明明          NA
</span><span class="cp">#&gt; 13           70    萧玄          NA
</span><span class="cp">#&gt; 14           15  宋小波          NA
</span><span class="cp">#&gt; 15           NA      黄          NA
</span><span class="cp">#&gt; 16           NA    章立          NA
</span><span class="cp">#&gt; 17           NA    王磊          NA
</span><span class="cp"></span>
<span class="n">odbcClose</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="n">odbcClose</span><span class="p">(</span><span class="n">acc</span><span class="p">)</span></code></pre></td></tr></table>
</div>
</div>
<p><sup>Created on 2019-03-28 by the <a href="https://reprex.tidyverse.org">reprex package</a> (v0.2.1)</p>

<a class="post-dummy-target" id="ms-sql"></a><h1>MS SQL</h1>

<p>这里设置下32位的dBASE files数据源就行了，服务器为<code>(local)</code>，然后再添加一个数据库就行了。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="kn">library</span><span class="p">(</span>RODBC<span class="p">)</span>
a <span class="o">&lt;-</span> odbcConnect<span class="p">(</span><span class="s">&#34;test&#34;</span><span class="p">)</span>
a
<span class="c1">#&gt; RODBC Connection 1</span>
<span class="c1">#&gt; Details:</span>
<span class="c1">#&gt;   case=nochange</span>
<span class="c1">#&gt;   DSN=test</span>
<span class="c1">#&gt;   UID=</span>
<span class="c1">#&gt;   Trusted_Connection=Yes</span>
<span class="c1">#&gt;   WSID=HOAS-XYZ-RESCUE</span>
<span class="c1">#&gt;   DATABASE=SchoolDB</span>
sqlFetch<span class="p">(</span>a<span class="p">,</span> <span class="s">&#34;dbo.Grade&#34;</span><span class="p">)</span>
<span class="c1">#&gt;    StudentCode CourseCode Grade          WriteStamp</span>
<span class="c1">#&gt; 1         1101        101  86.0 2010-06-10 10:23:12</span>
<span class="c1">#&gt; 2         1101        103  94.0 2010-06-15 08:10:30</span>
<span class="c1">#&gt; 3         1101        106  47.0 2011-06-15 09:30:05</span>
<span class="c1">#&gt; 4         1102        101  80.0 2010-06-10 10:23:40</span>
<span class="c1">#&gt; 5         1102        105  76.0 2011-12-22 10:12:10</span>
<span class="c1">#&gt; 6         1103        102  76.0 2011-01-22 22:15:12</span>
<span class="c1">#&gt; 7         1103        108  65.0 2011-01-22 21:10:45</span>
<span class="c1">#&gt; 8         1103        113    NA 2011-09-02 11:10:15</span>
<span class="c1">#&gt; 9         2101        109  58.0 2011-01-22 10:05:20</span>
<span class="c1">#&gt; 10        2101        111  70.0 2011-06-15 12:10:13</span>
<span class="c1">#&gt; 11        2101        113  84.5 2011-09-02 11:10:10</span>
<span class="c1">#&gt; 12        2202        101  88.0 2010-06-10 10:24:20</span>
<span class="c1">#&gt; 13        2202        106  67.0 2011-06-15 09:30:30</span>
<span class="c1">#&gt; 14        2202        113    NA 2011-09-02 11:11:11</span>
<span class="c1">#&gt; 15        2202        115  90.5 2010-12-30 09:40:20</span>
<span class="c1">#&gt; 16        3101        112  88.0 2011-06-15 07:30:30</span>
<span class="c1">#&gt; 17        3101        114  60.0 2010-12-30 22:30:04</span>
<span class="c1">#&gt; 18        3104        101  98.0 2010-06-10 10:24:50</span>
<span class="c1">#&gt; 19        3104        105  87.7 2011-12-22 10:12:40</span>
<span class="c1">#&gt; 20        3104        107  90.0 2011-06-22 09:20:25</span>
<span class="c1">#&gt; 21        4101        111  97.0 2011-06-15 12:10:45</span>
<span class="c1">#&gt; 22        4102        103 100.0 2010-06-15 08:10:50</span>
<span class="c1">#&gt; 23        4102        106  95.0 2011-06-15 09:31:10</span>
<span class="c1">#&gt; 24        4102        113    NA 2011-09-02 11:12:30</span>
<span class="c1">#&gt; 25        6101        105  70.0 2011-12-22 10:13:10</span>
<span class="c1">#&gt; 26        6101        113    NA 2011-09-02 11:13:05</span>
<span class="c1">#&gt; 27        6102        108  65.0 2011-01-22 21:11:20</span>
<span class="c1">#&gt; 28        6102        109  55.0 2011-01-22 10:06:10</span>
<span class="c1">#&gt; 29        7102        104  80.0 2011-06-19 21:20:35</span>
<span class="c1">#&gt; 30        7102        108  78.0 2011-01-22 21:12:01</span>
<span class="c1">#&gt; 31        7102        110  60.5 2011-07-10 20:10:44</span>
<span class="c1">#&gt; 32        8101        103  90.0 2011-06-15 08:11:00</span>
<span class="c1">#&gt; 33        8101        106  88.0 2011-06-15 09:32:50</span>
<span class="c1">#&gt; 34        8101        113    NA 2011-09-02 11:13:10</span>
<span class="c1">#&gt; 35        8103        115  96.0 2010-12-30 09:41:10</span></code></pre></td></tr></table>
</div>
</div>
<p><sup>Created on 2019-04-01 by the <a href="https://reprex.tidyverse.org">reprex package</a> (v0.2.1)</sup></p>
        </div>

        <div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>本文于 2019-03-28 更新</span>
            </div>
            <div class="post-info-license">
                
            </div>
        </div>
        <div class="post-info-line">
            <div class="post-info-md">
                
                    
                        <span><a class="link-to-markdown" href="/2019/03/2019-03-28-read-access-and-mssql-in-r/index.md" target="_blank">阅读原始文档</a></span>
                    
                
            </div>
            <div class="post-info-share">
                
                    <span></span>
                
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section>
            
                
                    <span class="tag">
                        <a href="/tags/r/"><i class="fas fa-tag fa-fw"></i>R</a>
                    </span>
                
                    <span class="tag">
                        <a href="/tags/access/"><i class="fas fa-tag fa-fw"></i>Access</a>
                    </span>
                
            
        </section>
        <section>
            <span><a href="javascript:window.history.back();">返回</a></span>&nbsp;|&nbsp;<span><a href="/">主页</a></span>
        </section>
    </div>

    <div class="post-nav">
        
            <a href="/2019/03/2019-03-25-human-face-detection-with-r/" class="prev" rel="prev" title="R语言人脸识别"><i class="fas fa-angle-left fa-fw"></i>R语言人脸识别</a>
        
        
            <a href="/2019/03/2019-03-28-read-and-write-excel-in-cs/" class="next" rel="next" title="C#读取写入Excel">C#读取写入Excel<i class="fas fa-angle-right fa-fw"></i></a>
        
    </div>
</div>

        <div class="post-comment">
            
            

            
        </div>
    </article></div>
            </main>
            <footer class="footer">
    <div class="copyright">
        <div class="copyright-line">
            由 <a href="https://gohugo.io/" target="_blank" rel="external nofollow noopener noreffer">Hugo</a> 强力驱动&nbsp;|&nbsp;主题 - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="external nofollow noopener noreffer">LoveIt<i class="far fa-heart fa-fw"></i></a>
        </div>
        <div class="copyright-line">
            <i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2018 - 2019</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/">hoas</a></span><span class="license">&nbsp;|&nbsp;<a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
    </div>
    <script>
        (function(u, c) {
         var d = document, t = 'script', o = d.createElement(t),
              s = d.getElementsByTagName(t)[0];
         o.src = u;
         if (c) { o.addEventListener('load', function(e) { c(e); }); }
         s.parentNode.insertBefore(o, s);
        })('//cdn.bootcss.com/pangu/3.3.0/pangu.min.js', function() {
            pangu.spacingPage();
            
        });
    </script>
</footer>


    
    




    
    




    
    





    
    



    
    



    
    





    
    





    
    



    
    





    
    




    
    




    
    



    
    





    
    


<script src="/js/lib/jquery/jquery.slim.min.min.js"></script>
<script src="/js/lib/lazysizes/lazysizes.min.min.js"></script>
<script src="/js/lib/smooth-scroll/smooth-scroll.polyfills.min.min.js"></script><script>window.scroll = new SmoothScroll('[data-scroll]', {speed: 300, speedAsDuration: true});</script>


    
    

    

    

    

    






<script src="/js/blog.min.js"></script>


    
</div>
        <a href="#" class="dynamic-to-top" id="dynamic-to-top" data-scroll><span>&nbsp;</span></a>
    </body>
</html>