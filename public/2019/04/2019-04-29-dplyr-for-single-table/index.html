<!DOCTYPE html>
<html lang="zh">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>dplyr for single table | hoas&#39; blog | One Stupid Boy</title><meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="robots" content="noodp" />
<meta name="Description" content="dplyr for single table">
<link rel="prev" href="/2019/04/2019-04-27-update-r/" />
<link rel="next" href="/2019/04/2019-04-30-k-nearest-neighbor/" />
<link rel="canonical" href="/2019/04/2019-04-29-dplyr-for-single-table/" />
<link rel='shortcut icon' type='image/x-icon' href='/favicon.ico' />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="dplyr for single table"/>
<meta name="twitter:description" content="dplyr for single table"/>
<script type="application/ld+json">
    {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "headline": "dplyr for single table",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "\/2019\/04\/2019-04-29-dplyr-for-single-table\/"
    },
    
        "image": {
            "@type": "ImageObject",
            "url": "\/cover.png",
            "width":  800 ,
            "height":  600 
        },
    
    "genre": "posts",
    
        "keywords": "R, 中文",
    
    "wordcount":  10622 ,
    "url": "\/2019\/04\/2019-04-29-dplyr-for-single-table\/",
    
        "datePublished": "2019-04-28T00:00:00\x2b00:00",
    
    
        "dateModified": "2019-04-29T15:47:03\x2b08:00",
    
    
        "license": "This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.",
    
    
        "publisher": {
            "@type": "Organization",
            "name": "XXXX",
            "logo": {
            "@type": "ImageObject",
            "url": "\/logo.png",
            "width":  127 ,
            "height":  40 
            }
        },
    
    
    "description": "dplyr for single table"
    }
    </script>
<link rel="stylesheet" href="/css/style.min.css">
<link rel="stylesheet" href="/css/lib/fontawesome-free/all.min.min.css">

<link rel="stylesheet" href="/css/lib/animate/animate.min.min.css">

        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.11.2/css/all.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    </head>
    <body>
        <script>
            window.isDark = (window.localStorage && window.localStorage.getItem('theme')) === 'dark';
            window.isDark && document.body.classList.add('dark-theme');
        </script>
        <div class="wrapper">
            <nav class="navbar">
    <div class="navbar-container">
        <div class="navbar-header">
            <a href="/">hoas&#39; blog | One Stupid Boy</a>
        </div>
        <div class="navbar-menu">
            
            
                <a class="menu-item" href="/posts/" title="">文章</a>
            
                <a class="menu-item" href="/tags/" title="">标签</a>
            
                <a class="menu-item" href="/categories/" title="">目录</a>
            
                <a class="menu-item" href="/about/" title="">关于</a>
            
            <a href="javascript:void(0);" class="theme-switch"><i class="fas fa-adjust fa-rotate-180 fa-fw"></i></a>
        </div>
    </div>
</nav>
<nav class="navbar-mobile">
     <div class="navbar-container">
        <div class="navbar-header">
            <div><a href="javascript:void(0);" class="theme-switch"><i class="fas fa-adjust fa-rotate-180 fa-fw"></i></a><a href="/">hoas&#39; blog | One Stupid Boy</a></div>
            <div class="menu-toggle" id="menu-toggle">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="navbar-menu" id="mobile-menu">
            
            
                <a class="menu-item" href="/posts/" title="">文章</a>
            
                <a class="menu-item" href="/tags/" title="">标签</a>
            
                <a class="menu-item" href="/categories/" title="">目录</a>
            
                <a class="menu-item" href="/about/" title="">关于</a>
            
        </div>
    </div>
</nav><main class="main">
                <div class="container">
                    
    
    
    
       
    

    <article class="post-warp">
        <h1 class="post-title animated flipInX">dplyr for single table</h1>

        <div class="post-meta">
            <div class="post-meta-main">
                <a class="author" href="/" rel="author"><i class="fas fa-user-circle fa-fw"></i>hoas&nbsp;</a>
                <span class="post-category">
                        收录于
                        <i class="far fa-folder fa-fw"></i><a href="/categories/fragmentray/">fragmentray</a>
                            
                    </span>
            </div>
            <div class="post-meta-other">
                <i class="far fa-calendar-alt fa-fw"></i><time datetime=2019-04-28>2019-04-28</time>&nbsp;
                <i class="fas fa-pencil-alt fa-fw"></i>约 10622 字&nbsp;
                <i class="far fa-clock fa-fw"></i>预计阅读 22 分钟&nbsp;</div>
        </div>

        

        <div class="post-toc" id="post-toc">
                <h2 class="post-toc-title">目录</h2>
                <div class="post-toc-content">
                    <nav id="TableOfContents">
<ul>
<li><a href="#filter"><code>filter()</code></a>
<ul>
<li><a href="#variation">Variation</a></li>
</ul></li>
<li><a href="#arrange"><code>arrange()</code></a></li>
<li><a href="#select-rename"><code>select()</code>/<code>rename()</code></a>
<ul>
<li><a href="#num-range"><code>num_range()</code></a></li>
<li><a href="#group-cols"><code>group_cols()</code></a></li>
<li><a href="#data"><code>.data$*</code></a></li>
<li><a href="#rename"><code>rename()</code></a></li>
<li><a href="#variation-1">Variation</a></li>
</ul></li>
<li><a href="#pull"><code>pull()</code></a></li>
<li><a href="#mutate-transmute"><code>mutate()</code>/<code>transmute()</code></a>
<ul>
<li><a href="#useful-functions">Useful functions</a>
<ul>
<li><a href="#lead-lag">lead-lag</a></li>
<li><a href="#ranking">ranking</a></li>
<li><a href="#cum"><code>cum*()</code></a></li>
<li><a href="#coalesce"><code>coalesce()</code></a></li>
<li><a href="#if-else"><code>if_else()</code></a></li>
<li><a href="#recode"><code>recode()</code></a></li>
<li><a href="#case-when"><code>case_when()</code></a></li>
</ul></li>
<li><a href="#the-point">The point</a></li>
<li><a href="#variation-2">Variation</a></li>
</ul></li>
<li><a href="#group-by"><code>group_by</code></a></li>
<li><a href="#summarize"><code>summarize()</code></a>
<ul>
<li><a href="#useful-functions-1">Useful functions</a></li>
</ul></li>
<li><a href="#distinct"><code>distinct()</code></a></li>
<li><a href="#do"><code>do()</code></a></li>
<li><a href="#sample-n-sample-frac"><code>sample_n()</code>/<code>sample_frac()</code></a></li>
<li><a href="#slice"><code>slice()</code></a></li>
<li><a href="#tally-count"><code>tally()</code>/<code>count()</code></a></li>
<li><a href="#top-n"><code>top_n()</code></a></li>
<li><a href="#scoped">Scoped</a></li>
</ul>
</nav>
                </div>
            </div>
            <div class="post-toc-mobile" id="post-toc-mobile">
                <details>
                    <summary><div class="post-toc-title"><span>目录</span><span><i class="details icon fas fa-angle-down"></i></span></div></summary>
                    <div class="post-toc-content">
                        
                        
                        <nav id="TableOfContentsMobile">
<ul>
<li><a href="#filter"><code>filter()</code></a>
<ul>
<li><a href="#variation">Variation</a></li>
</ul></li>
<li><a href="#arrange"><code>arrange()</code></a></li>
<li><a href="#select-rename"><code>select()</code>/<code>rename()</code></a>
<ul>
<li><a href="#num-range"><code>num_range()</code></a></li>
<li><a href="#group-cols"><code>group_cols()</code></a></li>
<li><a href="#data"><code>.data$*</code></a></li>
<li><a href="#rename"><code>rename()</code></a></li>
<li><a href="#variation-1">Variation</a></li>
</ul></li>
<li><a href="#pull"><code>pull()</code></a></li>
<li><a href="#mutate-transmute"><code>mutate()</code>/<code>transmute()</code></a>
<ul>
<li><a href="#useful-functions">Useful functions</a>
<ul>
<li><a href="#lead-lag">lead-lag</a></li>
<li><a href="#ranking">ranking</a></li>
<li><a href="#cum"><code>cum*()</code></a></li>
<li><a href="#coalesce"><code>coalesce()</code></a></li>
<li><a href="#if-else"><code>if_else()</code></a></li>
<li><a href="#recode"><code>recode()</code></a></li>
<li><a href="#case-when"><code>case_when()</code></a></li>
</ul></li>
<li><a href="#the-point">The point</a></li>
<li><a href="#variation-2">Variation</a></li>
</ul></li>
<li><a href="#group-by"><code>group_by</code></a></li>
<li><a href="#summarize"><code>summarize()</code></a>
<ul>
<li><a href="#useful-functions-1">Useful functions</a></li>
</ul></li>
<li><a href="#distinct"><code>distinct()</code></a></li>
<li><a href="#do"><code>do()</code></a></li>
<li><a href="#sample-n-sample-frac"><code>sample_n()</code>/<code>sample_frac()</code></a></li>
<li><a href="#slice"><code>slice()</code></a></li>
<li><a href="#tally-count"><code>tally()</code>/<code>count()</code></a></li>
<li><a href="#top-n"><code>top_n()</code></a></li>
<li><a href="#scoped">Scoped</a></li>
</ul>
</nav>
                    </div>
                </details>
            </div>

        <div class="post-content">
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            <p>数据处理就它了！</p>

<blockquote>
<p><strong>dplyr</strong> is a grammar of data manipulation, providing a consistent set of verbs that help you solve the most common data manipulation challenges:</p>

<ul>
<li><code>mutate()</code> adds new variables that are functions of existing variables</li>
<li><code>select()</code> picks variables based on their names.</li>
<li><code>filter()</code> picks cases based on their values.</li>
<li><code>summarise()</code> reduces multiple values down to a single summary.</li>
<li><code>arrange()</code> changes the ordering of the rows.</li>
</ul>
</blockquote>

<p>以上为五个核心函数，不过若只停留在核心怎么能体会到边界的美妙？</p>

<p><center></p>

<p><figure><img src=/images/loading.svg data-sizes=auto data-src=https://github.com/tidyverse/dplyr/raw/master/man/figures/logo.png alt=dplyr class=lazyload><figcaption class=image-caption>dplyr</figcaption></figure></p>

<p></center></p>

<a class="post-dummy-target" id="filter"></a><h1><code>filter()</code></h1>

<p>里面可以塞很多比较运算符：</p>

<ul>
<li><code>==</code>, <code>&gt;</code>, <code>&gt;=</code> etc</li>
<li><code>&amp;</code>, <code>|</code>, <code>!</code>, <code>xor()</code></li>
<li><code>is.na()</code></li>
<li><code>beteen()</code>, <code>near()</code></li>
</ul>

<a class="post-dummy-target" id="variation"></a><h2>Variation</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r">filter_all<span class="p">(</span><span class="m">.</span>tbl<span class="p">,</span> <span class="m">.</span>vars_predicate<span class="p">,</span> <span class="m">.</span>preserve <span class="o">=</span> <span class="kc">FALSE</span><span class="p">)</span>

filter_if<span class="p">(</span><span class="m">.</span>tbl<span class="p">,</span> <span class="m">.</span>predicate<span class="p">,</span> <span class="m">.</span>vars_predicate<span class="p">,</span> <span class="m">.</span>preserve <span class="o">=</span> <span class="kc">FALSE</span><span class="p">)</span>

filter_at<span class="p">(</span><span class="m">.</span>tbl<span class="p">,</span> <span class="m">.</span>vars<span class="p">,</span> <span class="m">.</span>vars_predicate<span class="p">,</span> <span class="m">.</span>preserve <span class="o">=</span> <span class="kc">FALSE</span><span class="p">)</span></code></pre></td></tr></table>
</div>
</div>
<p><code>filter()</code>是<strong>行筛选</strong>，所以这里的<code>all</code> / <code>if</code> / <code>at</code>对应的是 所有的/需要判断的/定义位置的 行。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="kn">library</span><span class="p">(</span>pacman<span class="p">)</span>
p_load<span class="p">(</span>dplyr<span class="p">)</span>

filter_all<span class="p">(</span>mtcars<span class="p">,</span> all_vars<span class="p">(</span><span class="m">.</span> <span class="o">&gt;</span> <span class="m">150</span><span class="p">))</span>
<span class="c1">#&gt;  [1] mpg  cyl  disp hp   drat wt   qsec vs   am   gear carb</span>
<span class="c1">#&gt; &lt;0 行&gt; (或0-长度的row.names)</span>

filter_all<span class="p">(</span>mtcars<span class="p">,</span> any_vars<span class="p">(</span><span class="m">.</span> <span class="o">&gt;</span> <span class="m">150</span><span class="p">))</span>
<span class="c1">#&gt;     mpg cyl  disp  hp drat    wt  qsec vs am gear carb</span>
<span class="c1">#&gt; 1  21.0   6 160.0 110 3.90 2.620 16.46  0  1    4    4</span>
<span class="c1">#&gt; 2  21.0   6 160.0 110 3.90 2.875 17.02  0  1    4    4</span>
<span class="c1">#&gt; 3  21.4   6 258.0 110 3.08 3.215 19.44  1  0    3    1</span>
<span class="c1">#&gt; 4  18.7   8 360.0 175 3.15 3.440 17.02  0  0    3    2</span>
<span class="c1">#&gt; 5  18.1   6 225.0 105 2.76 3.460 20.22  1  0    3    1</span>
<span class="c1">#&gt; 6  14.3   8 360.0 245 3.21 3.570 15.84  0  0    3    4</span>
<span class="c1">#&gt; 7  19.2   6 167.6 123 3.92 3.440 18.30  1  0    4    4</span>
<span class="c1">#&gt; 8  17.8   6 167.6 123 3.92 3.440 18.90  1  0    4    4</span>
<span class="c1">#&gt; 9  16.4   8 275.8 180 3.07 4.070 17.40  0  0    3    3</span>
<span class="c1">#&gt; 10 17.3   8 275.8 180 3.07 3.730 17.60  0  0    3    3</span>
<span class="c1">#&gt; 11 15.2   8 275.8 180 3.07 3.780 18.00  0  0    3    3</span>
<span class="c1">#&gt; 12 10.4   8 472.0 205 2.93 5.250 17.98  0  0    3    4</span>
<span class="c1">#&gt; 13 10.4   8 460.0 215 3.00 5.424 17.82  0  0    3    4</span>
<span class="c1">#&gt; 14 14.7   8 440.0 230 3.23 5.345 17.42  0  0    3    4</span>
<span class="c1">#&gt; 15 15.5   8 318.0 150 2.76 3.520 16.87  0  0    3    2</span>
<span class="c1">#&gt; 16 15.2   8 304.0 150 3.15 3.435 17.30  0  0    3    2</span>
<span class="c1">#&gt; 17 13.3   8 350.0 245 3.73 3.840 15.41  0  0    3    4</span>
<span class="c1">#&gt; 18 19.2   8 400.0 175 3.08 3.845 17.05  0  0    3    2</span>
<span class="c1">#&gt; 19 15.8   8 351.0 264 4.22 3.170 14.50  0  1    5    4</span>
<span class="c1">#&gt; 20 19.7   6 145.0 175 3.62 2.770 15.50  0  1    5    6</span>
<span class="c1">#&gt; 21 15.0   8 301.0 335 3.54 3.570 14.60  0  1    5    8</span></code></pre></td></tr></table>
</div>
</div>
<p><sup>Created on 2019-04-28 by the <a href="https://reprex.tidyverse.org">reprex package</a> (v0.2.1)</sup></p>

<p>沿用上述思想，是否整行的变量都大于150？是否存在大于150的变量？若是，返回该变量所在的行。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r">filter_at<span class="p">(</span>mtcars<span class="p">,</span> vars<span class="p">(</span>starts_with<span class="p">(</span><span class="s">&#34;d&#34;</span><span class="p">)),</span> any_vars<span class="p">((</span><span class="m">.</span> <span class="o">%%</span> <span class="m">2</span><span class="p">)</span> <span class="o">==</span> <span class="m">0</span><span class="p">))</span>
<span class="c1">#&gt;     mpg cyl disp  hp drat    wt  qsec vs am gear carb</span>
<span class="c1">#&gt; 1  21.0   6  160 110 3.90 2.620 16.46  0  1    4    4</span>
<span class="c1">#&gt; 2  21.0   6  160 110 3.90 2.875 17.02  0  1    4    4</span>
<span class="c1">#&gt; 3  22.8   4  108  93 3.85 2.320 18.61  1  1    4    1</span>
<span class="c1">#&gt; 4  21.4   6  258 110 3.08 3.215 19.44  1  0    3    1</span>
<span class="c1">#&gt; 5  18.7   8  360 175 3.15 3.440 17.02  0  0    3    2</span>
<span class="c1">#&gt; 6  14.3   8  360 245 3.21 3.570 15.84  0  0    3    4</span>
<span class="c1">#&gt; 7  10.4   8  472 205 2.93 5.250 17.98  0  0    3    4</span>
<span class="c1">#&gt; 8  10.4   8  460 215 3.00 5.424 17.82  0  0    3    4</span>
<span class="c1">#&gt; 9  14.7   8  440 230 3.23 5.345 17.42  0  0    3    4</span>
<span class="c1">#&gt; 10 15.5   8  318 150 2.76 3.520 16.87  0  0    3    2</span>
<span class="c1">#&gt; 11 15.2   8  304 150 3.15 3.435 17.30  0  0    3    2</span>
<span class="c1">#&gt; 12 13.3   8  350 245 3.73 3.840 15.41  0  0    3    4</span>
<span class="c1">#&gt; 13 19.2   8  400 175 3.08 3.845 17.05  0  0    3    2</span>
filter_at<span class="p">(</span>mtcars<span class="p">,</span> vars<span class="p">(</span>starts_with<span class="p">(</span><span class="s">&#34;d&#34;</span><span class="p">)),</span> all_vars<span class="p">((</span><span class="m">.</span> <span class="o">%%</span> <span class="m">2</span><span class="p">)</span> <span class="o">==</span> <span class="m">0</span><span class="p">))</span>
<span class="c1">#&gt;  [1] mpg  cyl  disp hp   drat wt   qsec vs   am   gear carb</span>
<span class="c1">#&gt; &lt;0 行&gt; (或0-长度的row.names)</span>
filter_at<span class="p">(</span>mtcars<span class="p">,</span> vars<span class="p">(</span>starts_with<span class="p">(</span><span class="s">&#34;dr&#34;</span><span class="p">)),</span> any_vars<span class="p">((</span><span class="m">.</span> <span class="o">%%</span> <span class="m">2</span><span class="p">)</span> <span class="o">==</span> <span class="m">0</span><span class="p">))</span>
<span class="c1">#&gt;  [1] mpg  cyl  disp hp   drat wt   qsec vs   am   gear carb</span>
<span class="c1">#&gt; &lt;0 行&gt; (或0-长度的row.names)</span>

filter_at<span class="p">(</span>mtcars<span class="p">,</span> vars<span class="p">(</span>hp<span class="p">,</span> vs<span class="p">),</span> <span class="o">~</span> <span class="m">.</span> <span class="o">%%</span> <span class="m">2</span> <span class="o">==</span> <span class="m">0</span><span class="p">)</span>
<span class="c1">#&gt;    mpg cyl  disp  hp drat    wt  qsec vs am gear carb</span>
<span class="c1">#&gt; 1 21.0   6 160.0 110 3.90 2.620 16.46  0  1    4    4</span>
<span class="c1">#&gt; 2 21.0   6 160.0 110 3.90 2.875 17.02  0  1    4    4</span>
<span class="c1">#&gt; 3 16.4   8 275.8 180 3.07 4.070 17.40  0  0    3    3</span>
<span class="c1">#&gt; 4 17.3   8 275.8 180 3.07 3.730 17.60  0  0    3    3</span>
<span class="c1">#&gt; 5 15.2   8 275.8 180 3.07 3.780 18.00  0  0    3    3</span>
<span class="c1">#&gt; 6 14.7   8 440.0 230 3.23 5.345 17.42  0  0    3    4</span>
<span class="c1">#&gt; 7 15.5   8 318.0 150 2.76 3.520 16.87  0  0    3    2</span>
<span class="c1">#&gt; 8 15.2   8 304.0 150 3.15 3.435 17.30  0  0    3    2</span>
<span class="c1">#&gt; 9 15.8   8 351.0 264 4.22 3.170 14.50  0  1    5    4</span>
filter_at<span class="p">(</span>mtcars<span class="p">,</span> vars<span class="p">(</span>hp<span class="p">,</span> vs<span class="p">),</span> all_vars<span class="p">(</span><span class="m">.</span> <span class="o">%%</span> <span class="m">2</span> <span class="o">==</span> <span class="m">0</span><span class="p">))</span>
<span class="c1">#&gt;    mpg cyl  disp  hp drat    wt  qsec vs am gear carb</span>
<span class="c1">#&gt; 1 21.0   6 160.0 110 3.90 2.620 16.46  0  1    4    4</span>
<span class="c1">#&gt; 2 21.0   6 160.0 110 3.90 2.875 17.02  0  1    4    4</span>
<span class="c1">#&gt; 3 16.4   8 275.8 180 3.07 4.070 17.40  0  0    3    3</span>
<span class="c1">#&gt; 4 17.3   8 275.8 180 3.07 3.730 17.60  0  0    3    3</span>
<span class="c1">#&gt; 5 15.2   8 275.8 180 3.07 3.780 18.00  0  0    3    3</span>
<span class="c1">#&gt; 6 14.7   8 440.0 230 3.23 5.345 17.42  0  0    3    4</span>
<span class="c1">#&gt; 7 15.5   8 318.0 150 2.76 3.520 16.87  0  0    3    2</span>
<span class="c1">#&gt; 8 15.2   8 304.0 150 3.15 3.435 17.30  0  0    3    2</span>
<span class="c1">#&gt; 9 15.8   8 351.0 264 4.22 3.170 14.50  0  1    5    4</span>
filter_at<span class="p">(</span>mtcars<span class="p">,</span> vars<span class="p">(</span>hp<span class="p">,</span> vs<span class="p">),</span> any_vars<span class="p">(</span><span class="m">.</span> <span class="o">%%</span> <span class="m">2</span> <span class="o">==</span> <span class="m">0</span><span class="p">))</span>
<span class="c1">#&gt;     mpg cyl  disp  hp drat    wt  qsec vs am gear carb</span>
<span class="c1">#&gt; 1  21.0   6 160.0 110 3.90 2.620 16.46  0  1    4    4</span>
<span class="c1">#&gt; 2  21.0   6 160.0 110 3.90 2.875 17.02  0  1    4    4</span>
<span class="c1">#&gt; 3  21.4   6 258.0 110 3.08 3.215 19.44  1  0    3    1</span>
<span class="c1">#&gt; 4  18.7   8 360.0 175 3.15 3.440 17.02  0  0    3    2</span>
<span class="c1">#&gt; 5  14.3   8 360.0 245 3.21 3.570 15.84  0  0    3    4</span>
<span class="c1">#&gt; 6  24.4   4 146.7  62 3.69 3.190 20.00  1  0    4    2</span>
<span class="c1">#&gt; 7  16.4   8 275.8 180 3.07 4.070 17.40  0  0    3    3</span>
<span class="c1">#&gt; 8  17.3   8 275.8 180 3.07 3.730 17.60  0  0    3    3</span>
<span class="c1">#&gt; 9  15.2   8 275.8 180 3.07 3.780 18.00  0  0    3    3</span>
<span class="c1">#&gt; 10 10.4   8 472.0 205 2.93 5.250 17.98  0  0    3    4</span>
<span class="c1">#&gt; 11 10.4   8 460.0 215 3.00 5.424 17.82  0  0    3    4</span>
<span class="c1">#&gt; 12 14.7   8 440.0 230 3.23 5.345 17.42  0  0    3    4</span>
<span class="c1">#&gt; 13 32.4   4  78.7  66 4.08 2.200 19.47  1  1    4    1</span>
<span class="c1">#&gt; 14 30.4   4  75.7  52 4.93 1.615 18.52  1  1    4    2</span>
<span class="c1">#&gt; 15 15.5   8 318.0 150 2.76 3.520 16.87  0  0    3    2</span>
<span class="c1">#&gt; 16 15.2   8 304.0 150 3.15 3.435 17.30  0  0    3    2</span>
<span class="c1">#&gt; 17 13.3   8 350.0 245 3.73 3.840 15.41  0  0    3    4</span>
<span class="c1">#&gt; 18 19.2   8 400.0 175 3.08 3.845 17.05  0  0    3    2</span>
<span class="c1">#&gt; 19 27.3   4  79.0  66 4.08 1.935 18.90  1  1    4    1</span>
<span class="c1">#&gt; 20 26.0   4 120.3  91 4.43 2.140 16.70  0  1    5    2</span>
<span class="c1">#&gt; 21 15.8   8 351.0 264 4.22 3.170 14.50  0  1    5    4</span>
<span class="c1">#&gt; 22 19.7   6 145.0 175 3.62 2.770 15.50  0  1    5    6</span>
<span class="c1">#&gt; 23 15.0   8 301.0 335 3.54 3.570 14.60  0  1    5    8</span></code></pre></td></tr></table>
</div>
</div>
<p><sup>Created on 2019-04-28 by the <a href="https://reprex.tidyverse.org">reprex package</a> (v0.2.1)</sup></p>

<p>注意<code>start_with()</code>返回所有满足条件的<strong>列</strong>。对，这里转列的条件了，而且是多列筛选，因为这里不止一列满足限定条件，<code>_at</code>指的是列。使用<code>any_</code>对<code>*_vars()</code>里面的代词（列变量）进行筛选并返回整行，因此也解释了<code>all_vars()</code>返回空行的原因。</p>

<p>对多行都需要满足同一条件的筛选来讲，有一个简便写法，就是使用<code>~</code>（这里应该不被视为formula）。</p>

<a class="post-dummy-target" id="arrange"></a><h1><code>arrange()</code></h1>

<p>该函数用来改变行的顺序。可以有多个想要排序的参数，按照优先级从左往右写，用逗号分开。另外也可以降序。另外<code>NA</code>会被排在最后。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r">arrange<span class="p">(</span>mtcars<span class="p">,</span> cyl<span class="p">,</span> disp<span class="p">)</span>
<span class="c1">#&gt;     mpg cyl  disp  hp drat    wt  qsec vs am gear carb</span>
<span class="c1">#&gt; 1  33.9   4  71.1  65 4.22 1.835 19.90  1  1    4    1</span>
<span class="c1">#&gt; 2  30.4   4  75.7  52 4.93 1.615 18.52  1  1    4    2</span>
<span class="c1">#&gt; 3  32.4   4  78.7  66 4.08 2.200 19.47  1  1    4    1</span>
<span class="c1">#&gt; 4  27.3   4  79.0  66 4.08 1.935 18.90  1  1    4    1</span>
<span class="c1">#&gt; 5  30.4   4  95.1 113 3.77 1.513 16.90  1  1    5    2</span>
<span class="c1">#&gt; 6  22.8   4 108.0  93 3.85 2.320 18.61  1  1    4    1</span>
<span class="c1">#&gt; 7  21.5   4 120.1  97 3.70 2.465 20.01  1  0    3    1</span>
<span class="c1">#&gt; 8  26.0   4 120.3  91 4.43 2.140 16.70  0  1    5    2</span>
<span class="c1">#&gt; 9  21.4   4 121.0 109 4.11 2.780 18.60  1  1    4    2</span>
<span class="c1">#&gt; 10 22.8   4 140.8  95 3.92 3.150 22.90  1  0    4    2</span>
<span class="c1">#&gt; 11 24.4   4 146.7  62 3.69 3.190 20.00  1  0    4    2</span>
<span class="c1">#&gt; 12 19.7   6 145.0 175 3.62 2.770 15.50  0  1    5    6</span>
<span class="c1">#&gt; 13 21.0   6 160.0 110 3.90 2.620 16.46  0  1    4    4</span>
<span class="c1">#&gt; 14 21.0   6 160.0 110 3.90 2.875 17.02  0  1    4    4</span>
<span class="c1">#&gt; 15 19.2   6 167.6 123 3.92 3.440 18.30  1  0    4    4</span>
<span class="c1">#&gt; 16 17.8   6 167.6 123 3.92 3.440 18.90  1  0    4    4</span>
<span class="c1">#&gt; 17 18.1   6 225.0 105 2.76 3.460 20.22  1  0    3    1</span>
<span class="c1">#&gt; 18 21.4   6 258.0 110 3.08 3.215 19.44  1  0    3    1</span>
<span class="c1">#&gt; 19 16.4   8 275.8 180 3.07 4.070 17.40  0  0    3    3</span>
<span class="c1">#&gt; 20 17.3   8 275.8 180 3.07 3.730 17.60  0  0    3    3</span>
<span class="c1">#&gt; 21 15.2   8 275.8 180 3.07 3.780 18.00  0  0    3    3</span>
<span class="c1">#&gt; 22 15.0   8 301.0 335 3.54 3.570 14.60  0  1    5    8</span>
<span class="c1">#&gt; 23 15.2   8 304.0 150 3.15 3.435 17.30  0  0    3    2</span>
<span class="c1">#&gt; 24 15.5   8 318.0 150 2.76 3.520 16.87  0  0    3    2</span>
<span class="c1">#&gt; 25 13.3   8 350.0 245 3.73 3.840 15.41  0  0    3    4</span>
<span class="c1">#&gt; 26 15.8   8 351.0 264 4.22 3.170 14.50  0  1    5    4</span>
<span class="c1">#&gt; 27 18.7   8 360.0 175 3.15 3.440 17.02  0  0    3    2</span>
<span class="c1">#&gt; 28 14.3   8 360.0 245 3.21 3.570 15.84  0  0    3    4</span>
<span class="c1">#&gt; 29 19.2   8 400.0 175 3.08 3.845 17.05  0  0    3    2</span>
<span class="c1">#&gt; 30 14.7   8 440.0 230 3.23 5.345 17.42  0  0    3    4</span>
<span class="c1">#&gt; 31 10.4   8 460.0 215 3.00 5.424 17.82  0  0    3    4</span>
<span class="c1">#&gt; 32 10.4   8 472.0 205 2.93 5.250 17.98  0  0    3    4</span>

arrange<span class="p">(</span>mtcars<span class="p">,</span> desc<span class="p">(</span>disp<span class="p">))</span>
<span class="c1">#&gt;     mpg cyl  disp  hp drat    wt  qsec vs am gear carb</span>
<span class="c1">#&gt; 1  10.4   8 472.0 205 2.93 5.250 17.98  0  0    3    4</span>
<span class="c1">#&gt; 2  10.4   8 460.0 215 3.00 5.424 17.82  0  0    3    4</span>
<span class="c1">#&gt; 3  14.7   8 440.0 230 3.23 5.345 17.42  0  0    3    4</span>
<span class="c1">#&gt; 4  19.2   8 400.0 175 3.08 3.845 17.05  0  0    3    2</span>
<span class="c1">#&gt; 5  18.7   8 360.0 175 3.15 3.440 17.02  0  0    3    2</span>
<span class="c1">#&gt; 6  14.3   8 360.0 245 3.21 3.570 15.84  0  0    3    4</span>
<span class="c1">#&gt; 7  15.8   8 351.0 264 4.22 3.170 14.50  0  1    5    4</span>
<span class="c1">#&gt; 8  13.3   8 350.0 245 3.73 3.840 15.41  0  0    3    4</span>
<span class="c1">#&gt; 9  15.5   8 318.0 150 2.76 3.520 16.87  0  0    3    2</span>
<span class="c1">#&gt; 10 15.2   8 304.0 150 3.15 3.435 17.30  0  0    3    2</span>
<span class="c1">#&gt; 11 15.0   8 301.0 335 3.54 3.570 14.60  0  1    5    8</span>
<span class="c1">#&gt; 12 16.4   8 275.8 180 3.07 4.070 17.40  0  0    3    3</span>
<span class="c1">#&gt; 13 17.3   8 275.8 180 3.07 3.730 17.60  0  0    3    3</span>
<span class="c1">#&gt; 14 15.2   8 275.8 180 3.07 3.780 18.00  0  0    3    3</span>
<span class="c1">#&gt; 15 21.4   6 258.0 110 3.08 3.215 19.44  1  0    3    1</span>
<span class="c1">#&gt; 16 18.1   6 225.0 105 2.76 3.460 20.22  1  0    3    1</span>
<span class="c1">#&gt; 17 19.2   6 167.6 123 3.92 3.440 18.30  1  0    4    4</span>
<span class="c1">#&gt; 18 17.8   6 167.6 123 3.92 3.440 18.90  1  0    4    4</span>
<span class="c1">#&gt; 19 21.0   6 160.0 110 3.90 2.620 16.46  0  1    4    4</span>
<span class="c1">#&gt; 20 21.0   6 160.0 110 3.90 2.875 17.02  0  1    4    4</span>
<span class="c1">#&gt; 21 24.4   4 146.7  62 3.69 3.190 20.00  1  0    4    2</span>
<span class="c1">#&gt; 22 19.7   6 145.0 175 3.62 2.770 15.50  0  1    5    6</span>
<span class="c1">#&gt; 23 22.8   4 140.8  95 3.92 3.150 22.90  1  0    4    2</span>
<span class="c1">#&gt; 24 21.4   4 121.0 109 4.11 2.780 18.60  1  1    4    2</span>
<span class="c1">#&gt; 25 26.0   4 120.3  91 4.43 2.140 16.70  0  1    5    2</span>
<span class="c1">#&gt; 26 21.5   4 120.1  97 3.70 2.465 20.01  1  0    3    1</span>
<span class="c1">#&gt; 27 22.8   4 108.0  93 3.85 2.320 18.61  1  1    4    1</span>
<span class="c1">#&gt; 28 30.4   4  95.1 113 3.77 1.513 16.90  1  1    5    2</span>
<span class="c1">#&gt; 29 27.3   4  79.0  66 4.08 1.935 18.90  1  1    4    1</span>
<span class="c1">#&gt; 30 32.4   4  78.7  66 4.08 2.200 19.47  1  1    4    1</span>
<span class="c1">#&gt; 31 30.4   4  75.7  52 4.93 1.615 18.52  1  1    4    2</span>
<span class="c1">#&gt; 32 33.9   4  71.1  65 4.22 1.835 19.90  1  1    4    1</span></code></pre></td></tr></table>
</div>
</div>
<p><sup>Created on 2019-04-28 by the <a href="https://reprex.tidyverse.org">reprex package</a> (v0.2.1)</sup></p>

<p>对于分组来讲，直接排序是没用的，需要在<code>arrange()</code>中指定<code>.by_group = TRUE</code>。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="kn">library</span><span class="p">(</span>pacman<span class="p">)</span>
p_load<span class="p">(</span>dplyr<span class="p">)</span>

by_cyl <span class="o">&lt;-</span> mtcars <span class="o">%&gt;%</span> group_by<span class="p">(</span>cyl<span class="p">)</span>
by_cyl <span class="o">%&gt;%</span> arrange<span class="p">(</span>desc<span class="p">(</span>wt<span class="p">))</span>
<span class="c1">#&gt; # A tibble: 32 x 11</span>
<span class="c1">#&gt; # Groups:   cyl [3]</span>
<span class="c1">#&gt;      mpg   cyl  disp    hp  drat    wt  qsec    vs    am  gear  carb</span>
<span class="c1">#&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="c1">#&gt;  1  10.4     8  460    215  3     5.42  17.8     0     0     3     4</span>
<span class="c1">#&gt;  2  14.7     8  440    230  3.23  5.34  17.4     0     0     3     4</span>
<span class="c1">#&gt;  3  10.4     8  472    205  2.93  5.25  18.0     0     0     3     4</span>
<span class="c1">#&gt;  4  16.4     8  276.   180  3.07  4.07  17.4     0     0     3     3</span>
<span class="c1">#&gt;  5  19.2     8  400    175  3.08  3.84  17.0     0     0     3     2</span>
<span class="c1">#&gt;  6  13.3     8  350    245  3.73  3.84  15.4     0     0     3     4</span>
<span class="c1">#&gt;  7  15.2     8  276.   180  3.07  3.78  18       0     0     3     3</span>
<span class="c1">#&gt;  8  17.3     8  276.   180  3.07  3.73  17.6     0     0     3     3</span>
<span class="c1">#&gt;  9  14.3     8  360    245  3.21  3.57  15.8     0     0     3     4</span>
<span class="c1">#&gt; 10  15       8  301    335  3.54  3.57  14.6     0     1     5     8</span>
<span class="c1">#&gt; # ... with 22 more rows</span>

by_cyl <span class="o">%&gt;%</span> arrange<span class="p">(</span>desc<span class="p">(</span>wt<span class="p">),</span> <span class="m">.</span>by_group <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>
<span class="c1">#&gt; # A tibble: 32 x 11</span>
<span class="c1">#&gt; # Groups:   cyl [3]</span>
<span class="c1">#&gt;      mpg   cyl  disp    hp  drat    wt  qsec    vs    am  gear  carb</span>
<span class="c1">#&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="c1">#&gt;  1  24.4     4 147.     62  3.69  3.19  20       1     0     4     2</span>
<span class="c1">#&gt;  2  22.8     4 141.     95  3.92  3.15  22.9     1     0     4     2</span>
<span class="c1">#&gt;  3  21.4     4 121     109  4.11  2.78  18.6     1     1     4     2</span>
<span class="c1">#&gt;  4  21.5     4 120.     97  3.7   2.46  20.0     1     0     3     1</span>
<span class="c1">#&gt;  5  22.8     4 108      93  3.85  2.32  18.6     1     1     4     1</span>
<span class="c1">#&gt;  6  32.4     4  78.7    66  4.08  2.2   19.5     1     1     4     1</span>
<span class="c1">#&gt;  7  26       4 120.     91  4.43  2.14  16.7     0     1     5     2</span>
<span class="c1">#&gt;  8  27.3     4  79      66  4.08  1.94  18.9     1     1     4     1</span>
<span class="c1">#&gt;  9  33.9     4  71.1    65  4.22  1.84  19.9     1     1     4     1</span>
<span class="c1">#&gt; 10  30.4     4  75.7    52  4.93  1.62  18.5     1     1     4     2</span>
<span class="c1">#&gt; # ... with 22 more rows</span></code></pre></td></tr></table>
</div>
</div>
<p><sup>Created on 2019-04-28 by the <a href="https://reprex.tidyverse.org">reprex package</a> (v0.2.1)</sup></p>

<a class="post-dummy-target" id="select-rename"></a><h1><code>select()</code>/<code>rename()</code></h1>

<p><strong>列</strong>选择。这个函数也有一些辅助函数，它们都是<strong>tidyselect</strong>中的一部分：</p>

<p>These functions allow you to select variables based on their names.</p>

<ul>
<li><p><code>starts_with()</code>: Starts with a prefix.</p></li>

<li><p><code>ends_with()</code>: Ends with a suffix.</p></li>

<li><p><code>contains()</code>: Contains a literal string.</p></li>

<li><p><code>matches()</code>: Matches a regular expression.</p></li>

<li><p><code>num_range()</code>: Matches a numerical range like x01, x02, x03.</p></li>

<li><p><code>one_of()</code>: Matches variable names in a character vector.</p></li>

<li><p><code>everything()</code>: Matches all variables.</p></li>

<li><p><code>last_col()</code>: Select last variable, possibly with an offset.</p></li>
</ul>

<p><code>select()</code>和<code>arrange()</code>一样也可以包含多个列名类参数，负号表示不选择，不过表示的是<strong>重复选择</strong>。重复选择可以改变列的顺序。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r">iris <span class="o">&lt;-</span> as_tibble<span class="p">(</span>iris<span class="p">)</span>
select<span class="p">(</span>iris<span class="p">,</span> Species<span class="p">,</span> everything<span class="p">())</span>
<span class="c1">#&gt; # A tibble: 150 x 5</span>
<span class="c1">#&gt;    Species Sepal.Length Sepal.Width Petal.Length Petal.Width</span>
<span class="c1">#&gt;    &lt;fct&gt;          &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;</span>
<span class="c1">#&gt;  1 setosa           5.1         3.5          1.4         0.2</span>
<span class="c1">#&gt;  2 setosa           4.9         3            1.4         0.2</span>
<span class="c1">#&gt;  3 setosa           4.7         3.2          1.3         0.2</span>
<span class="c1">#&gt;  4 setosa           4.6         3.1          1.5         0.2</span>
<span class="c1">#&gt;  5 setosa           5           3.6          1.4         0.2</span>
<span class="c1">#&gt;  6 setosa           5.4         3.9          1.7         0.4</span>
<span class="c1">#&gt;  7 setosa           4.6         3.4          1.4         0.3</span>
<span class="c1">#&gt;  8 setosa           5           3.4          1.5         0.2</span>
<span class="c1">#&gt;  9 setosa           4.4         2.9          1.4         0.2</span>
<span class="c1">#&gt; 10 setosa           4.9         3.1          1.5         0.1</span>
<span class="c1">#&gt; # ... with 140 more rows</span>

select<span class="p">(</span>iris<span class="p">,</span> <span class="o">-</span>Sepal.Length<span class="p">,</span> Sepal.Length<span class="p">)</span>
<span class="c1">#&gt; # A tibble: 150 x 5</span>
<span class="c1">#&gt;    Sepal.Width Petal.Length Petal.Width Species Sepal.Length</span>
<span class="c1">#&gt;          &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt; &lt;fct&gt;          &lt;dbl&gt;</span>
<span class="c1">#&gt;  1         3.5          1.4         0.2 setosa           5.1</span>
<span class="c1">#&gt;  2         3            1.4         0.2 setosa           4.9</span>
<span class="c1">#&gt;  3         3.2          1.3         0.2 setosa           4.7</span>
<span class="c1">#&gt;  4         3.1          1.5         0.2 setosa           4.6</span>
<span class="c1">#&gt;  5         3.6          1.4         0.2 setosa           5  </span>
<span class="c1">#&gt;  6         3.9          1.7         0.4 setosa           5.4</span>
<span class="c1">#&gt;  7         3.4          1.4         0.3 setosa           4.6</span>
<span class="c1">#&gt;  8         3.4          1.5         0.2 setosa           5  </span>
<span class="c1">#&gt;  9         2.9          1.4         0.2 setosa           4.4</span>
<span class="c1">#&gt; 10         3.1          1.5         0.1 setosa           4.9</span>
<span class="c1">#&gt; # ... with 140 more rows</span></code></pre></td></tr></table>
</div>
</div>
<p><sup>Created on 2019-04-28 by the <a href="https://reprex.tidyverse.org">reprex package</a> (v0.2.1)</sup></p>

<a class="post-dummy-target" id="num-range"></a><h2><code>num_range()</code></h2>

<p>注意这个有意思的顺序，默认选择是按照列从左到右的顺序来的。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r">df <span class="o">&lt;-</span> <span class="kp">as.data.frame</span><span class="p">(</span><span class="kt">matrix</span><span class="p">(</span>runif<span class="p">(</span><span class="m">100</span><span class="p">),</span> nrow <span class="o">=</span> <span class="m">10</span><span class="p">))</span>
df <span class="o">&lt;-</span> tbl_df<span class="p">(</span>df<span class="p">[</span><span class="kt">c</span><span class="p">(</span><span class="m">3</span><span class="p">,</span> <span class="m">4</span><span class="p">,</span> <span class="m">7</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">9</span><span class="p">,</span> <span class="m">8</span><span class="p">,</span> <span class="m">5</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">6</span><span class="p">,</span> <span class="m">10</span><span class="p">)])</span>
select<span class="p">(</span>df<span class="p">,</span> V4<span class="o">:</span>V6<span class="p">)</span>
<span class="c1">#&gt; # A tibble: 10 x 8</span>
<span class="c1">#&gt;        V4     V7     V1      V9     V8     V5     V2    V6</span>
<span class="c1">#&gt;     &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="c1">#&gt;  1 0.648  0.880  0.880  0.00695 0.267  0.799  0.977  0.185</span>
<span class="c1">#&gt;  2 0.0648 0.375  0.253  0.390   0.608  0.132  0.110  0.562</span>
<span class="c1">#&gt;  3 0.337  0.434  0.906  0.239   0.772  0.548  0.999  0.731</span>
<span class="c1">#&gt;  4 0.570  0.807  0.0534 0.384   0.520  0.0970 0.0962 0.661</span>
<span class="c1">#&gt;  5 0.338  0.636  0.519  0.0731  0.860  0.986  0.0623 0.732</span>
<span class="c1">#&gt;  6 0.499  0.0687 0.924  0.767   0.793  0.840  0.807  0.631</span>
<span class="c1">#&gt;  7 0.308  0.145  0.249  0.688   0.784  0.400  0.810  0.352</span>
<span class="c1">#&gt;  8 0.840  0.295  0.537  0.842   0.424  0.952  0.812  0.464</span>
<span class="c1">#&gt;  9 0.0652 0.0414 0.654  0.105   0.0155 0.0595 0.202  0.891</span>
<span class="c1">#&gt; 10 0.440  0.117  0.131  0.340   0.416  0.277  0.627  0.537</span>
select<span class="p">(</span>df<span class="p">,</span> num_range<span class="p">(</span><span class="s">&#34;V&#34;</span><span class="p">,</span> <span class="m">4</span><span class="o">:</span><span class="m">6</span><span class="p">))</span>
<span class="c1">#&gt; # A tibble: 10 x 3</span>
<span class="c1">#&gt;        V4     V5    V6</span>
<span class="c1">#&gt;     &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="c1">#&gt;  1 0.648  0.799  0.185</span>
<span class="c1">#&gt;  2 0.0648 0.132  0.562</span>
<span class="c1">#&gt;  3 0.337  0.548  0.731</span>
<span class="c1">#&gt;  4 0.570  0.0970 0.661</span>
<span class="c1">#&gt;  5 0.338  0.986  0.732</span>
<span class="c1">#&gt;  6 0.499  0.840  0.631</span>
<span class="c1">#&gt;  7 0.308  0.400  0.352</span>
<span class="c1">#&gt;  8 0.840  0.952  0.464</span>
<span class="c1">#&gt;  9 0.0652 0.0595 0.891</span>
<span class="c1">#&gt; 10 0.440  0.277  0.537</span></code></pre></td></tr></table>
</div>
</div>
<a class="post-dummy-target" id="group-cols"></a><h2><code>group_cols()</code></h2>

<p>分组的处理。使用<code>select()</code>时只会选出用来分组的列。<code>mutate_at()</code>的重写也就没什么疑问了。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r">starwars <span class="o">%&gt;%</span> group_by<span class="p">(</span>gender<span class="p">)</span> <span class="o">%&gt;%</span> select<span class="p">(</span>group_cols<span class="p">())</span>
<span class="c1">#&gt; # A tibble: 87 x 1</span>
<span class="c1">#&gt; # Groups:   gender [5]</span>
<span class="c1">#&gt;    gender</span>
<span class="c1">#&gt;    &lt;chr&gt; </span>
<span class="c1">#&gt;  1 male  </span>
<span class="c1">#&gt;  2 &lt;NA&gt;  </span>
<span class="c1">#&gt;  3 &lt;NA&gt;  </span>
<span class="c1">#&gt;  4 male  </span>
<span class="c1">#&gt;  5 female</span>
<span class="c1">#&gt;  6 male  </span>
<span class="c1">#&gt;  7 female</span>
<span class="c1">#&gt;  8 &lt;NA&gt;  </span>
<span class="c1">#&gt;  9 male  </span>
<span class="c1">#&gt; 10 male  </span>
<span class="c1">#&gt; # ... with 77 more rows</span>

gdf <span class="o">&lt;-</span> iris <span class="o">%&gt;%</span> group_by<span class="p">(</span>Species<span class="p">)</span>
gdf
<span class="c1">#&gt; # A tibble: 150 x 5</span>
<span class="c1">#&gt; # Groups:   Species [3]</span>
<span class="c1">#&gt;    Sepal.Length Sepal.Width Petal.Length Petal.Width Species</span>
<span class="c1">#&gt;           &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt; &lt;fct&gt;  </span>
<span class="c1">#&gt;  1          5.1         3.5          1.4         0.2 setosa </span>
<span class="c1">#&gt;  2          4.9         3            1.4         0.2 setosa </span>
<span class="c1">#&gt;  3          4.7         3.2          1.3         0.2 setosa </span>
<span class="c1">#&gt;  4          4.6         3.1          1.5         0.2 setosa </span>
<span class="c1">#&gt;  5          5           3.6          1.4         0.2 setosa </span>
<span class="c1">#&gt;  6          5.4         3.9          1.7         0.4 setosa </span>
<span class="c1">#&gt;  7          4.6         3.4          1.4         0.3 setosa </span>
<span class="c1">#&gt;  8          5           3.4          1.5         0.2 setosa </span>
<span class="c1">#&gt;  9          4.4         2.9          1.4         0.2 setosa </span>
<span class="c1">#&gt; 10          4.9         3.1          1.5         0.1 setosa </span>
<span class="c1">#&gt; # ... with 140 more rows</span>
gdf <span class="o">%&gt;%</span> mutate_at<span class="p">(</span>vars<span class="p">(</span><span class="o">-</span>group_cols<span class="p">()),</span> <span class="sb">`/`</span><span class="p">,</span> <span class="m">100</span><span class="p">)</span>
<span class="c1">#&gt; # A tibble: 150 x 5</span>
<span class="c1">#&gt; # Groups:   Species [3]</span>
<span class="c1">#&gt;    Sepal.Length Sepal.Width Petal.Length Petal.Width Species</span>
<span class="c1">#&gt;           &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt; &lt;fct&gt;  </span>
<span class="c1">#&gt;  1        0.051      0.035        0.0140       0.002 setosa </span>
<span class="c1">#&gt;  2        0.049      0.03         0.0140       0.002 setosa </span>
<span class="c1">#&gt;  3        0.047      0.032        0.013        0.002 setosa </span>
<span class="c1">#&gt;  4        0.046      0.031        0.015        0.002 setosa </span>
<span class="c1">#&gt;  5        0.05       0.036        0.0140       0.002 setosa </span>
<span class="c1">#&gt;  6        0.054      0.039        0.017        0.004 setosa </span>
<span class="c1">#&gt;  7        0.046      0.034        0.0140       0.003 setosa </span>
<span class="c1">#&gt;  8        0.05       0.034        0.015        0.002 setosa </span>
<span class="c1">#&gt;  9        0.044      0.0290       0.0140       0.002 setosa </span>
<span class="c1">#&gt; 10        0.049      0.031        0.015        0.001 setosa </span>
<span class="c1">#&gt; # ... with 140 more rows</span></code></pre></td></tr></table>
</div>
</div>
<p><sup>Created on 2019-04-28 by the <a href="https://reprex.tidyverse.org">reprex package</a> (v0.2.1)</sup></p>

<a class="post-dummy-target" id="data"></a><h2><code>.data$*</code></h2>

<p>这不是多此一举吗？😂</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r">select<span class="p">(</span>mtcars<span class="p">,</span> <span class="m">.</span>data<span class="o">$</span>disp<span class="p">)</span>
<span class="c1">#&gt;                      disp</span>
<span class="c1">#&gt; Mazda RX4           160.0</span>
<span class="c1">#&gt; Mazda RX4 Wag       160.0</span>
<span class="c1">#&gt; Datsun 710          108.0</span>
<span class="c1">#&gt; Hornet 4 Drive      258.0</span>
<span class="c1">#&gt; Hornet Sportabout   360.0</span>
<span class="c1">#&gt; Valiant             225.0</span>
<span class="c1">#&gt; Duster 360          360.0</span>
<span class="c1">#&gt; Merc 240D           146.7</span>
<span class="c1">#&gt; Merc 230            140.8</span>
<span class="c1">#&gt; Merc 280            167.6</span>
<span class="c1">#&gt; Merc 280C           167.6</span>
<span class="c1">#&gt; Merc 450SE          275.8</span>
<span class="c1">#&gt; Merc 450SL          275.8</span>
<span class="c1">#&gt; Merc 450SLC         275.8</span>
<span class="c1">#&gt; Cadillac Fleetwood  472.0</span>
<span class="c1">#&gt; Lincoln Continental 460.0</span>
<span class="c1">#&gt; Chrysler Imperial   440.0</span>
<span class="c1">#&gt; Fiat 128             78.7</span>
<span class="c1">#&gt; Honda Civic          75.7</span>
<span class="c1">#&gt; Toyota Corolla       71.1</span>
<span class="c1">#&gt; Toyota Corona       120.1</span>
<span class="c1">#&gt; Dodge Challenger    318.0</span>
<span class="c1">#&gt; AMC Javelin         304.0</span>
<span class="c1">#&gt; Camaro Z28          350.0</span>
<span class="c1">#&gt; Pontiac Firebird    400.0</span>
<span class="c1">#&gt; Fiat X1-9            79.0</span>
<span class="c1">#&gt; Porsche 914-2       120.3</span>
<span class="c1">#&gt; Lotus Europa         95.1</span>
<span class="c1">#&gt; Ford Pantera L      351.0</span>
<span class="c1">#&gt; Ferrari Dino        145.0</span>
<span class="c1">#&gt; Maserati Bora       301.0</span>
<span class="c1">#&gt; Volvo 142E          121.0</span>
select<span class="p">(</span>mtcars<span class="p">,</span> disp<span class="p">)</span>
<span class="c1">#&gt;                      disp</span>
<span class="c1">#&gt; Mazda RX4           160.0</span>
<span class="c1">#&gt; Mazda RX4 Wag       160.0</span>
<span class="c1">#&gt; Datsun 710          108.0</span>
<span class="c1">#&gt; Hornet 4 Drive      258.0</span>
<span class="c1">#&gt; Hornet Sportabout   360.0</span>
<span class="c1">#&gt; Valiant             225.0</span>
<span class="c1">#&gt; Duster 360          360.0</span>
<span class="c1">#&gt; Merc 240D           146.7</span>
<span class="c1">#&gt; Merc 230            140.8</span>
<span class="c1">#&gt; Merc 280            167.6</span>
<span class="c1">#&gt; Merc 280C           167.6</span>
<span class="c1">#&gt; Merc 450SE          275.8</span>
<span class="c1">#&gt; Merc 450SL          275.8</span>
<span class="c1">#&gt; Merc 450SLC         275.8</span>
<span class="c1">#&gt; Cadillac Fleetwood  472.0</span>
<span class="c1">#&gt; Lincoln Continental 460.0</span>
<span class="c1">#&gt; Chrysler Imperial   440.0</span>
<span class="c1">#&gt; Fiat 128             78.7</span>
<span class="c1">#&gt; Honda Civic          75.7</span>
<span class="c1">#&gt; Toyota Corolla       71.1</span>
<span class="c1">#&gt; Toyota Corona       120.1</span>
<span class="c1">#&gt; Dodge Challenger    318.0</span>
<span class="c1">#&gt; AMC Javelin         304.0</span>
<span class="c1">#&gt; Camaro Z28          350.0</span>
<span class="c1">#&gt; Pontiac Firebird    400.0</span>
<span class="c1">#&gt; Fiat X1-9            79.0</span>
<span class="c1">#&gt; Porsche 914-2       120.3</span>
<span class="c1">#&gt; Lotus Europa         95.1</span>
<span class="c1">#&gt; Ford Pantera L      351.0</span>
<span class="c1">#&gt; Ferrari Dino        145.0</span>
<span class="c1">#&gt; Maserati Bora       301.0</span>
<span class="c1">#&gt; Volvo 142E          121.0</span>

select<span class="p">(</span>mtcars<span class="p">,</span> <span class="m">.</span>data<span class="o">$</span>mpg <span class="o">:</span> <span class="m">.</span>data<span class="o">$</span>disp<span class="p">)</span>
<span class="c1">#&gt;                      mpg cyl  disp</span>
<span class="c1">#&gt; Mazda RX4           21.0   6 160.0</span>
<span class="c1">#&gt; Mazda RX4 Wag       21.0   6 160.0</span>
<span class="c1">#&gt; Datsun 710          22.8   4 108.0</span>
<span class="c1">#&gt; Hornet 4 Drive      21.4   6 258.0</span>
<span class="c1">#&gt; Hornet Sportabout   18.7   8 360.0</span>
<span class="c1">#&gt; Valiant             18.1   6 225.0</span>
<span class="c1">#&gt; Duster 360          14.3   8 360.0</span>
<span class="c1">#&gt; Merc 240D           24.4   4 146.7</span>
<span class="c1">#&gt; Merc 230            22.8   4 140.8</span>
<span class="c1">#&gt; Merc 280            19.2   6 167.6</span>
<span class="c1">#&gt; Merc 280C           17.8   6 167.6</span>
<span class="c1">#&gt; Merc 450SE          16.4   8 275.8</span>
<span class="c1">#&gt; Merc 450SL          17.3   8 275.8</span>
<span class="c1">#&gt; Merc 450SLC         15.2   8 275.8</span>
<span class="c1">#&gt; Cadillac Fleetwood  10.4   8 472.0</span>
<span class="c1">#&gt; Lincoln Continental 10.4   8 460.0</span>
<span class="c1">#&gt; Chrysler Imperial   14.7   8 440.0</span>
<span class="c1">#&gt; Fiat 128            32.4   4  78.7</span>
<span class="c1">#&gt; Honda Civic         30.4   4  75.7</span>
<span class="c1">#&gt; Toyota Corolla      33.9   4  71.1</span>
<span class="c1">#&gt; Toyota Corona       21.5   4 120.1</span>
<span class="c1">#&gt; Dodge Challenger    15.5   8 318.0</span>
<span class="c1">#&gt; AMC Javelin         15.2   8 304.0</span>
<span class="c1">#&gt; Camaro Z28          13.3   8 350.0</span>
<span class="c1">#&gt; Pontiac Firebird    19.2   8 400.0</span>
<span class="c1">#&gt; Fiat X1-9           27.3   4  79.0</span>
<span class="c1">#&gt; Porsche 914-2       26.0   4 120.3</span>
<span class="c1">#&gt; Lotus Europa        30.4   4  95.1</span>
<span class="c1">#&gt; Ford Pantera L      15.8   8 351.0</span>
<span class="c1">#&gt; Ferrari Dino        19.7   6 145.0</span>
<span class="c1">#&gt; Maserati Bora       15.0   8 301.0</span>
<span class="c1">#&gt; Volvo 142E          21.4   4 121.0</span>
select<span class="p">(</span>mtcars<span class="p">,</span> mpg <span class="o">:</span> disp<span class="p">)</span>
<span class="c1">#&gt;                      mpg cyl  disp</span>
<span class="c1">#&gt; Mazda RX4           21.0   6 160.0</span>
<span class="c1">#&gt; Mazda RX4 Wag       21.0   6 160.0</span>
<span class="c1">#&gt; Datsun 710          22.8   4 108.0</span>
<span class="c1">#&gt; Hornet 4 Drive      21.4   6 258.0</span>
<span class="c1">#&gt; Hornet Sportabout   18.7   8 360.0</span>
<span class="c1">#&gt; Valiant             18.1   6 225.0</span>
<span class="c1">#&gt; Duster 360          14.3   8 360.0</span>
<span class="c1">#&gt; Merc 240D           24.4   4 146.7</span>
<span class="c1">#&gt; Merc 230            22.8   4 140.8</span>
<span class="c1">#&gt; Merc 280            19.2   6 167.6</span>
<span class="c1">#&gt; Merc 280C           17.8   6 167.6</span>
<span class="c1">#&gt; Merc 450SE          16.4   8 275.8</span>
<span class="c1">#&gt; Merc 450SL          17.3   8 275.8</span>
<span class="c1">#&gt; Merc 450SLC         15.2   8 275.8</span>
<span class="c1">#&gt; Cadillac Fleetwood  10.4   8 472.0</span>
<span class="c1">#&gt; Lincoln Continental 10.4   8 460.0</span>
<span class="c1">#&gt; Chrysler Imperial   14.7   8 440.0</span>
<span class="c1">#&gt; Fiat 128            32.4   4  78.7</span>
<span class="c1">#&gt; Honda Civic         30.4   4  75.7</span>
<span class="c1">#&gt; Toyota Corolla      33.9   4  71.1</span>
<span class="c1">#&gt; Toyota Corona       21.5   4 120.1</span>
<span class="c1">#&gt; Dodge Challenger    15.5   8 318.0</span>
<span class="c1">#&gt; AMC Javelin         15.2   8 304.0</span>
<span class="c1">#&gt; Camaro Z28          13.3   8 350.0</span>
<span class="c1">#&gt; Pontiac Firebird    19.2   8 400.0</span>
<span class="c1">#&gt; Fiat X1-9           27.3   4  79.0</span>
<span class="c1">#&gt; Porsche 914-2       26.0   4 120.3</span>
<span class="c1">#&gt; Lotus Europa        30.4   4  95.1</span>
<span class="c1">#&gt; Ford Pantera L      15.8   8 351.0</span>
<span class="c1">#&gt; Ferrari Dino        19.7   6 145.0</span>
<span class="c1">#&gt; Maserati Bora       15.0   8 301.0</span>
<span class="c1">#&gt; Volvo 142E          21.4   4 121.0</span></code></pre></td></tr></table>
</div>
</div>
<p><sup>Created on 2019-04-28 by the <a href="https://reprex.tidyverse.org">reprex package</a> (v0.2.1)</sup></p>

<a class="post-dummy-target" id="rename"></a><h2><code>rename()</code></h2>

<p>重命名。其实<code>select()</code>函数本也可以重命名，不过是在选择后，而<code>rename()</code>没有选择而是直接改名。</p>

<p><code>rename()</code>的列位置要是数量。虽然我并没有看懂。🤣</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r">select<span class="p">(</span>iris<span class="p">,</span> petal_length <span class="o">=</span> Petal.Length<span class="p">)</span> <span class="o">%&gt;%</span> <span class="kp">head</span><span class="p">()</span>
<span class="c1">#&gt;   petal_length</span>
<span class="c1">#&gt; 1          1.4</span>
<span class="c1">#&gt; 2          1.4</span>
<span class="c1">#&gt; 3          1.3</span>
<span class="c1">#&gt; 4          1.5</span>
<span class="c1">#&gt; 5          1.4</span>
<span class="c1">#&gt; 6          1.7</span>
select<span class="p">(</span>iris<span class="p">,</span> obs <span class="o">=</span> starts_with<span class="p">(</span><span class="s">&#39;S&#39;</span><span class="p">))</span> <span class="o">%&gt;%</span> <span class="kp">head</span><span class="p">()</span>
<span class="c1">#&gt;   obs1 obs2   obs3</span>
<span class="c1">#&gt; 1  5.1  3.5 setosa</span>
<span class="c1">#&gt; 2  4.9  3.0 setosa</span>
<span class="c1">#&gt; 3  4.7  3.2 setosa</span>
<span class="c1">#&gt; 4  4.6  3.1 setosa</span>
<span class="c1">#&gt; 5  5.0  3.6 setosa</span>
<span class="c1">#&gt; 6  5.4  3.9 setosa</span>

rename<span class="p">(</span>iris<span class="p">,</span> petal_length <span class="o">=</span> Petal.Length<span class="p">)</span> <span class="o">%&gt;%</span> <span class="kp">head</span><span class="p">()</span>
<span class="c1">#&gt;   Sepal.Length Sepal.Width petal_length Petal.Width Species</span>
<span class="c1">#&gt; 1          5.1         3.5          1.4         0.2  setosa</span>
<span class="c1">#&gt; 2          4.9         3.0          1.4         0.2  setosa</span>
<span class="c1">#&gt; 3          4.7         3.2          1.3         0.2  setosa</span>
<span class="c1">#&gt; 4          4.6         3.1          1.5         0.2  setosa</span>
<span class="c1">#&gt; 5          5.0         3.6          1.4         0.2  setosa</span>
<span class="c1">#&gt; 6          5.4         3.9          1.7         0.4  setosa</span>
rename<span class="p">(</span>iris<span class="p">,</span> obs <span class="o">=</span> starts_with<span class="p">(</span><span class="s">&#39;S&#39;</span><span class="p">))</span> <span class="o">%&gt;%</span> <span class="kp">head</span><span class="p">()</span>
<span class="c1">#&gt; Column positions must be scalar</span></code></pre></td></tr></table>
</div>
</div>
<p><sup>Created on 2019-04-28 by the <a href="https://reprex.tidyverse.org">reprex package</a> (v0.2.1)</sup></p>

<p>因为已经是name格式了所以可以直接改名的原因吧。如果是字符（串）的话可以少一个感叹号，但是我心中的感叹号又加了一个……😹</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span><span class="lnt">86
</span><span class="lnt">87
</span><span class="lnt">88
</span><span class="lnt">89
</span><span class="lnt">90
</span><span class="lnt">91
</span><span class="lnt">92
</span><span class="lnt">93
</span><span class="lnt">94
</span><span class="lnt">95
</span><span class="lnt">96
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="kn">library</span><span class="p">(</span>pacman<span class="p">)</span>
p_load<span class="p">(</span>dplyr<span class="p">)</span>

vars <span class="o">&lt;-</span> <span class="kt">list</span><span class="p">(</span>
  var1 <span class="o">=</span> sym<span class="p">(</span><span class="s">&#34;cyl&#34;</span><span class="p">),</span>
  var2 <span class="o">=</span> sym<span class="p">(</span><span class="s">&#34;am&#34;</span><span class="p">)</span>
<span class="p">)</span>
vars
<span class="c1">#&gt; $var1</span>
<span class="c1">#&gt; cyl</span>
<span class="c1">#&gt; </span>
<span class="c1">#&gt; $var2</span>
<span class="c1">#&gt; am</span>
<span class="kp">class</span><span class="p">(</span>sym<span class="p">(</span><span class="s">&#34;cyl&#34;</span><span class="p">))</span>
<span class="c1">#&gt; [1] &#34;name&#34;</span>

<span class="kt">list</span><span class="p">(</span>
  var1 <span class="o">=</span> <span class="s">&#34;cyl&#34;</span><span class="p">,</span>
  var2 <span class="o">=</span> <span class="s">&#34;am&#34;</span>
<span class="p">)</span>
<span class="c1">#&gt; $var1</span>
<span class="c1">#&gt; [1] &#34;cyl&#34;</span>
<span class="c1">#&gt; </span>
<span class="c1">#&gt; $var2</span>
<span class="c1">#&gt; [1] &#34;am&#34;</span>

select<span class="p">(</span>mtcars<span class="p">,</span> <span class="o">!!!</span>vars<span class="p">)</span>
<span class="c1">#&gt;                     var1 var2</span>
<span class="c1">#&gt; Mazda RX4              6    1</span>
<span class="c1">#&gt; Mazda RX4 Wag          6    1</span>
<span class="c1">#&gt; Datsun 710             4    1</span>
<span class="c1">#&gt; Hornet 4 Drive         6    0</span>
<span class="c1">#&gt; Hornet Sportabout      8    0</span>
<span class="c1">#&gt; Valiant                6    0</span>
<span class="c1">#&gt; Duster 360             8    0</span>
<span class="c1">#&gt; Merc 240D              4    0</span>
<span class="c1">#&gt; Merc 230               4    0</span>
<span class="c1">#&gt; Merc 280               6    0</span>
<span class="c1">#&gt; Merc 280C              6    0</span>
<span class="c1">#&gt; Merc 450SE             8    0</span>
<span class="c1">#&gt; Merc 450SL             8    0</span>
<span class="c1">#&gt; Merc 450SLC            8    0</span>
<span class="c1">#&gt; Cadillac Fleetwood     8    0</span>
<span class="c1">#&gt; Lincoln Continental    8    0</span>
<span class="c1">#&gt; Chrysler Imperial      8    0</span>
<span class="c1">#&gt; Fiat 128               4    1</span>
<span class="c1">#&gt; Honda Civic            4    1</span>
<span class="c1">#&gt; Toyota Corolla         4    1</span>
<span class="c1">#&gt; Toyota Corona          4    0</span>
<span class="c1">#&gt; Dodge Challenger       8    0</span>
<span class="c1">#&gt; AMC Javelin            8    0</span>
<span class="c1">#&gt; Camaro Z28             8    0</span>
<span class="c1">#&gt; Pontiac Firebird       8    0</span>
<span class="c1">#&gt; Fiat X1-9              4    1</span>
<span class="c1">#&gt; Porsche 914-2          4    1</span>
<span class="c1">#&gt; Lotus Europa           4    1</span>
<span class="c1">#&gt; Ford Pantera L         8    1</span>
<span class="c1">#&gt; Ferrari Dino           6    1</span>
<span class="c1">#&gt; Maserati Bora          8    1</span>
<span class="c1">#&gt; Volvo 142E             4    1</span>

vars <span class="o">&lt;-</span> <span class="kt">c</span><span class="p">(</span>var1 <span class="o">=</span> <span class="s">&#34;cyl&#34;</span><span class="p">,</span> var2 <span class="o">=</span><span class="s">&#34;am&#34;</span><span class="p">)</span>
select<span class="p">(</span>mtcars<span class="p">,</span> <span class="o">!!</span>vars<span class="p">)</span>
<span class="c1">#&gt;                     var1 var2</span>
<span class="c1">#&gt; Mazda RX4              6    1</span>
<span class="c1">#&gt; Mazda RX4 Wag          6    1</span>
<span class="c1">#&gt; Datsun 710             4    1</span>
<span class="c1">#&gt; Hornet 4 Drive         6    0</span>
<span class="c1">#&gt; Hornet Sportabout      8    0</span>
<span class="c1">#&gt; Valiant                6    0</span>
<span class="c1">#&gt; Duster 360             8    0</span>
<span class="c1">#&gt; Merc 240D              4    0</span>
<span class="c1">#&gt; Merc 230               4    0</span>
<span class="c1">#&gt; Merc 280               6    0</span>
<span class="c1">#&gt; Merc 280C              6    0</span>
<span class="c1">#&gt; Merc 450SE             8    0</span>
<span class="c1">#&gt; Merc 450SL             8    0</span>
<span class="c1">#&gt; Merc 450SLC            8    0</span>
<span class="c1">#&gt; Cadillac Fleetwood     8    0</span>
<span class="c1">#&gt; Lincoln Continental    8    0</span>
<span class="c1">#&gt; Chrysler Imperial      8    0</span>
<span class="c1">#&gt; Fiat 128               4    1</span>
<span class="c1">#&gt; Honda Civic            4    1</span>
<span class="c1">#&gt; Toyota Corolla         4    1</span>
<span class="c1">#&gt; Toyota Corona          4    0</span>
<span class="c1">#&gt; Dodge Challenger       8    0</span>
<span class="c1">#&gt; AMC Javelin            8    0</span>
<span class="c1">#&gt; Camaro Z28             8    0</span>
<span class="c1">#&gt; Pontiac Firebird       8    0</span>
<span class="c1">#&gt; Fiat X1-9              4    1</span>
<span class="c1">#&gt; Porsche 914-2          4    1</span>
<span class="c1">#&gt; Lotus Europa           4    1</span>
<span class="c1">#&gt; Ford Pantera L         8    1</span>
<span class="c1">#&gt; Ferrari Dino           6    1</span>
<span class="c1">#&gt; Maserati Bora          8    1</span>
<span class="c1">#&gt; Volvo 142E             4    1</span></code></pre></td></tr></table>
</div>
</div>
<p><sup>Created on 2019-04-28 by the <a href="https://reprex.tidyverse.org">reprex package</a> (v0.2.1)</sup></p>

<p>好像<strong>ggplot2</strong>也有用到<code>expression()</code>类似的语法，先贴这里：</p>

<ol>
<li><a href="https://dplyr.tidyverse.org/reference/tidyeval.html">https://dplyr.tidyverse.org/reference/tidyeval.html</a></li>
<li><a href="https://rlang.r-lib.org/reference/index.html">https://rlang.r-lib.org/reference/index.html</a></li>
</ol>

<a class="post-dummy-target" id="variation-1"></a><h2>Variation</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r">select_all<span class="p">(</span><span class="m">.</span>tbl<span class="p">,</span> <span class="m">.</span>funs <span class="o">=</span> <span class="kt">list</span><span class="p">(),</span> <span class="kc">...</span><span class="p">)</span>

rename_all<span class="p">(</span><span class="m">.</span>tbl<span class="p">,</span> <span class="m">.</span>funs <span class="o">=</span> <span class="kt">list</span><span class="p">(),</span> <span class="kc">...</span><span class="p">)</span>

select_if<span class="p">(</span><span class="m">.</span>tbl<span class="p">,</span> <span class="m">.</span>predicate<span class="p">,</span> <span class="m">.</span>funs <span class="o">=</span> <span class="kt">list</span><span class="p">(),</span> <span class="kc">...</span><span class="p">)</span>

rename_if<span class="p">(</span><span class="m">.</span>tbl<span class="p">,</span> <span class="m">.</span>predicate<span class="p">,</span> <span class="m">.</span>funs <span class="o">=</span> <span class="kt">list</span><span class="p">(),</span> <span class="kc">...</span><span class="p">)</span>

select_at<span class="p">(</span><span class="m">.</span>tbl<span class="p">,</span> <span class="m">.</span>vars<span class="p">,</span> <span class="m">.</span>funs <span class="o">=</span> <span class="kt">list</span><span class="p">(),</span> <span class="kc">...</span><span class="p">)</span>

rename_at<span class="p">(</span><span class="m">.</span>tbl<span class="p">,</span> <span class="m">.</span>vars<span class="p">,</span> <span class="m">.</span>funs <span class="o">=</span> <span class="kt">list</span><span class="p">(),</span> <span class="kc">...</span><span class="p">)</span></code></pre></td></tr></table>
</div>
</div>
<p>对列的先判断再选择/命名。注意<code>vars()</code>中若包含多个条件那么就是<strong>且</strong>！如果想要<strong>或</strong>的话还是减少判定条件吧。</p>

<p>例子中用到了几个base函数这里介绍下：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r">x <span class="o">&lt;-</span> <span class="s">&#34;MiXeD cAsE 123&#34;</span>
<span class="kp">chartr</span><span class="p">(</span><span class="s">&#34;iXs&#34;</span><span class="p">,</span> <span class="s">&#34;why&#34;</span><span class="p">,</span> x<span class="p">)</span>
<span class="c1">#&gt; [1] &#34;MwheD cAyE 123&#34;</span>
<span class="kp">chartr</span><span class="p">(</span><span class="s">&#34;a-cX&#34;</span><span class="p">,</span> <span class="s">&#34;D-Fw&#34;</span><span class="p">,</span> x<span class="p">)</span>
<span class="c1">#&gt; [1] &#34;MiweD FAsE 123&#34;</span>
<span class="kp">tolower</span><span class="p">(</span>x<span class="p">)</span>
<span class="c1">#&gt; [1] &#34;mixed case 123&#34;</span>
<span class="kp">toupper</span><span class="p">(</span>x<span class="p">)</span>
<span class="c1">#&gt; [1] &#34;MIXED CASE 123&#34;</span></code></pre></td></tr></table>
</div>
</div>
<p><sup>Created on 2019-04-29 by the <a href="https://reprex.tidyverse.org">reprex package</a> (v0.2.1)</sup></p>

<p><code>rename()</code>和<code>select()</code>很像，于是就不解释了。</p>

<a class="post-dummy-target" id="pull"></a><h1><code>pull()</code></h1>

<p>用来输出数据。参数为列名，不支持多个输入以及其它表达。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r">mtcars <span class="o">%&gt;%</span> pull<span class="p">(</span><span class="m">-1</span><span class="p">)</span>
<span class="c1">#&gt;  [1] 4 4 1 1 2 1 4 2 2 4 4 3 3 3 4 4 4 1 2 1 1 2 2 4 2 1 2 2 4 6 8 2</span>

mtcars <span class="o">%&gt;%</span> pull<span class="p">(</span><span class="m">1</span><span class="p">)</span>
<span class="c1">#&gt;  [1] 21.0 21.0 22.8 21.4 18.7 18.1 14.3 24.4 22.8 19.2 17.8 16.4 17.3 15.2</span>
<span class="c1">#&gt; [15] 10.4 10.4 14.7 32.4 30.4 33.9 21.5 15.5 15.2 13.3 19.2 27.3 26.0 30.4</span>
<span class="c1">#&gt; [29] 15.8 19.7 15.0 21.4</span>

mtcars <span class="o">%&gt;%</span> pull<span class="p">(</span>cyl<span class="p">)</span>
<span class="c1">#&gt;  [1] 6 6 4 6 8 6 8 4 4 6 6 8 8 8 8 8 8 4 4 4 4 8 8 8 8 4 4 4 8 6 8 4</span>

mtcars <span class="o">%&gt;%</span> pull<span class="p">(</span><span class="s">&#34;hp&#34;</span><span class="p">)</span>
<span class="c1">#&gt;  [1] 110 110  93 110 175 105 245  62  95 123 123 180 180 180 205 215 230</span>
<span class="c1">#&gt; [18]  66  52  65  97 150 150 245 175  66  91 113 264 175 335 109</span>

mtcars <span class="o">%&gt;%</span> pull<span class="p">(</span><span class="kt">c</span><span class="p">(</span>cyl<span class="p">,</span>hp<span class="p">))</span>
<span class="c1">#&gt; `var` must evaluate to a single number or a column name, not an integer</span>
<span class="c1">#&gt; vector</span>

mtcars <span class="o">%&gt;%</span> pull<span class="p">(</span>cyl<span class="o">:</span>hp<span class="p">)</span>
<span class="c1">#&gt; `var` must evaluate to a single number or a column name, not an integer</span>
<span class="c1">#&gt; vector</span></code></pre></td></tr></table>
</div>
</div>
<p><sup>Created on 2019-04-29 by the <a href="https://reprex.tidyverse.org">reprex package</a> (v0.2.1)</sup></p>

<a class="post-dummy-target" id="mutate-transmute"></a><h1><code>mutate()</code>/<code>transmute()</code></h1>

<p><code>mutate()</code> adds new variables and preserves existing ones; <code>transmute()</code> adds new variables and drops existing ones. Both functions preserve the number of rows of the input. New variables overwrite existing variables of the same name.</p>

<a class="post-dummy-target" id="useful-functions"></a><h2>Useful functions</h2>

<p>因为这里辅助函数太多，所以还是记载下来：</p>

<ul>
<li><code>+</code>, <code>-</code>, <code>log()</code>, etc., for their usual mathematical meanings</li>
<li><code>lead()</code>, <code>lag()</code></li>
<li><code>dense_rank()</code>, <code>min_rank()</code>, <code>percent_rank()</code>, <code>row_number()</code>, <code>cume_dist()</code>, <code>ntile()</code></li>
<li><code>cumsum()</code>, <code>cummean()</code>, <code>cummin()</code>, <code>cummax()</code>, <code>cumany()</code>, <code>cumall()</code></li>
<li><code>na_if()</code>, <code>coalesce()</code></li>
<li><code>if_else()</code>, <code>recode()</code>, <code>case_when()</code></li>
</ul>

<a class="post-dummy-target" id="lead-lag"></a><h3>lead-lag</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r">lead<span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">10</span><span class="p">,</span> <span class="m">1</span><span class="p">)</span>
<span class="c1">#&gt;  [1]  2  3  4  5  6  7  8  9 10 NA</span>

lead<span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">10</span><span class="p">,</span> <span class="m">2</span><span class="p">)</span>
<span class="c1">#&gt;  [1]  3  4  5  6  7  8  9 10 NA NA</span>

lag<span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">10</span><span class="p">,</span> <span class="m">1</span><span class="p">)</span>
<span class="c1">#&gt;  [1] NA  1  2  3  4  5  6  7  8  9</span>

lag<span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">10</span><span class="p">,</span> <span class="m">2</span><span class="p">)</span>
<span class="c1">#&gt;  [1] NA NA  1  2  3  4  5  6  7  8</span>

x <span class="o">&lt;-</span> runif<span class="p">(</span><span class="m">5</span><span class="p">)</span>
<span class="kp">cbind</span><span class="p">(</span>ahead <span class="o">=</span> lead<span class="p">(</span>x<span class="p">),</span> x<span class="p">,</span> behind <span class="o">=</span> lag<span class="p">(</span>x<span class="p">))</span>
<span class="c1">#&gt;          ahead         x    behind</span>
<span class="c1">#&gt; [1,] 0.5571471 0.8306671        NA</span>
<span class="c1">#&gt; [2,] 0.5874060 0.5571471 0.8306671</span>
<span class="c1">#&gt; [3,] 0.3256915 0.5874060 0.5571471</span>
<span class="c1">#&gt; [4,] 0.7930587 0.3256915 0.5874060</span>
<span class="c1">#&gt; [5,]        NA 0.7930587 0.3256915</span></code></pre></td></tr></table>
</div>
</div>
<p><sup>Created on 2019-04-29 by the <a href="https://reprex.tidyverse.org">reprex package</a> (v0.2.1)</sup></p>

<p>以及<code>order_by()</code>的处理。我这里试的情况是一样，但是官方不一样，可能是更改了吧。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r">df <span class="o">&lt;-</span> <span class="kt">data.frame</span><span class="p">(</span>year <span class="o">=</span> <span class="m">2000</span><span class="o">:</span><span class="m">2005</span><span class="p">,</span> value <span class="o">=</span> <span class="p">(</span><span class="m">0</span><span class="o">:</span><span class="m">5</span><span class="p">)</span> <span class="o">^</span> <span class="m">2</span><span class="p">)</span>
scrambled <span class="o">&lt;-</span> df<span class="p">[</span><span class="kp">sample</span><span class="p">(</span><span class="kp">nrow</span><span class="p">(</span>df<span class="p">)),</span> <span class="p">]</span>

wrong <span class="o">&lt;-</span> mutate<span class="p">(</span>scrambled<span class="p">,</span> prev <span class="o">=</span> lag<span class="p">(</span>value<span class="p">))</span>
arrange<span class="p">(</span>wrong<span class="p">,</span> year<span class="p">)</span>
<span class="c1">#&gt;   year value prev</span>
<span class="c1">#&gt; 1 2000     0   NA</span>
<span class="c1">#&gt; 2 2001     1    0</span>
<span class="c1">#&gt; 3 2002     4   25</span>
<span class="c1">#&gt; 4 2003     9   16</span>
<span class="c1">#&gt; 5 2004    16    4</span>
<span class="c1">#&gt; 6 2005    25    1</span>

right <span class="o">&lt;-</span> mutate<span class="p">(</span>scrambled<span class="p">,</span> prev <span class="o">=</span> lag<span class="p">(</span>value<span class="p">,</span> order_by <span class="o">=</span> year<span class="p">))</span>
arrange<span class="p">(</span>right<span class="p">,</span> year<span class="p">)</span>
<span class="c1">#&gt;   year value prev</span>
<span class="c1">#&gt; 1 2000     0   NA</span>
<span class="c1">#&gt; 2 2001     1    0</span>
<span class="c1">#&gt; 3 2002     4    1</span>
<span class="c1">#&gt; 4 2003     9    4</span>
<span class="c1">#&gt; 5 2004    16    9</span>
<span class="c1">#&gt; 6 2005    25   16</span></code></pre></td></tr></table>
</div>
</div>
<p><sup>Created on 2019-04-29 by the <a href="https://reprex.tidyverse.org">reprex package</a> (v0.2.1)</sup></p>

<a class="post-dummy-target" id="ranking"></a><h3>ranking</h3>

<ul>
<li><code>row_number()</code>: equivalent to <code>rank(ties.method = &quot;first&quot;)</code></li>
<li><code>min_rank()</code>: equivalent to <code>rank(ties.method = &quot;min&quot;)</code></li>
<li><code>dense_rank()</code>: like <code>min_rank()</code>, but with no gaps between ranks</li>
<li><code>percent_rank()</code>: a number between 0 and 1 computed by rescaling <code>min_rank</code> to <code>[0, 1]</code></li>
<li><code>cume_dist()</code>: a cumulative distribution function. Proportion of all values less than or equal to the current rank.</li>

<li><p><code>ntile()</code>: a rough rank, which breaks the input vector into <code>n</code> buckets.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r">x <span class="o">&lt;-</span> <span class="kt">c</span><span class="p">(</span><span class="m">5</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">3</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="kc">NA</span><span class="p">)</span>
row_number<span class="p">(</span>x<span class="p">)</span>
<span class="c1">#&gt; [1]  5  1  4  2  3 NA</span>
min_rank<span class="p">(</span>x<span class="p">)</span>
<span class="c1">#&gt; [1]  5  1  4  2  2 NA</span>
dense_rank<span class="p">(</span>x<span class="p">)</span>
<span class="c1">#&gt; [1]  4  1  3  2  2 NA</span>
percent_rank<span class="p">(</span>x<span class="p">)</span>
<span class="c1">#&gt; [1] 1.00 0.00 0.75 0.25 0.25   NA</span>
cume_dist<span class="p">(</span>x<span class="p">)</span>
<span class="c1">#&gt; [1] 1.0 0.2 0.8 0.6 0.6  NA</span>
ntile<span class="p">(</span>x<span class="p">,</span><span class="m">2</span><span class="p">)</span>
<span class="c1">#&gt; [1]  2  1  2  1  1 NA</span>
ntile<span class="p">(</span>x<span class="p">,</span><span class="m">4</span><span class="p">)</span>
<span class="c1">#&gt; [1]  4  1  3  1  2 NA</span>
ntile<span class="p">(</span>x<span class="p">,</span><span class="m">5</span><span class="p">)</span>
<span class="c1">#&gt; [1]  5  1  4  2  3 NA</span></code></pre></td></tr></table>
</div>
</div></li>
</ul>

<p><sup>Created on 2019-04-29 by the <a href="https://reprex.tidyverse.org">reprex package</a> (v0.2.1)</sup></p>

<a class="post-dummy-target" id="cum"></a><h3><code>cum*()</code></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="kp">cumsum</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">10</span><span class="p">)</span>
<span class="c1">#&gt;  [1]  1  3  6 10 15 21 28 36 45 55</span>
<span class="kp">cumprod</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">10</span><span class="p">)</span>
<span class="c1">#&gt;  [1]       1       2       6      24     120     720    5040   40320</span>
<span class="c1">#&gt;  [9]  362880 3628800</span>
<span class="kp">cummin</span><span class="p">(</span><span class="kt">c</span><span class="p">(</span><span class="m">3</span><span class="o">:</span><span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="o">:</span><span class="m">0</span><span class="p">,</span> <span class="m">4</span><span class="o">:</span><span class="m">2</span><span class="p">))</span>
<span class="c1">#&gt; [1] 3 2 1 1 1 0 0 0 0</span>
<span class="kp">cummin</span><span class="p">(</span><span class="kt">c</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">2</span><span class="p">,</span><span class="m">0</span><span class="o">:</span><span class="m">3</span><span class="p">))</span>
<span class="c1">#&gt; [1] 1 1 0 0 0 0</span>

<span class="kp">cummax</span><span class="p">(</span><span class="kt">c</span><span class="p">(</span><span class="m">3</span><span class="o">:</span><span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="o">:</span><span class="m">0</span><span class="p">,</span> <span class="m">4</span><span class="o">:</span><span class="m">2</span><span class="p">))</span>
<span class="c1">#&gt; [1] 3 3 3 3 3 3 4 4 4</span>

x <span class="o">&lt;-</span> <span class="kt">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">3</span><span class="p">,</span> <span class="m">5</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">2</span><span class="p">)</span>
cummean<span class="p">(</span>x<span class="p">)</span>
<span class="c1">#&gt; [1] 1.00 2.00 3.00 2.75 2.60</span>
<span class="kp">cumsum</span><span class="p">(</span>x<span class="p">)</span> <span class="o">/</span> <span class="kp">seq_along</span><span class="p">(</span>x<span class="p">)</span>
<span class="c1">#&gt; [1] 1.00 2.00 3.00 2.75 2.60</span>

<span class="c1"># `cumall()` and `cumany()` return logicals</span>
cumall<span class="p">(</span>x <span class="o">&lt;</span> <span class="m">5</span><span class="p">)</span>
<span class="c1">#&gt; [1]  TRUE  TRUE FALSE FALSE FALSE</span>
cumany<span class="p">(</span>x <span class="o">==</span> <span class="m">3</span><span class="p">)</span>
<span class="c1">#&gt; [1] FALSE  TRUE  TRUE  TRUE  TRUE</span></code></pre></td></tr></table>
</div>
</div>
<p><sup>Created on 2019-04-29 by the <a href="https://reprex.tidyverse.org">reprex package</a> (v0.2.1)</sup></p>

<p>除了<code>cumsum()</code>，<code>cumprod()</code>，<code>cummean()</code>外我都没看懂……</p>

<p><code>na_if()</code></p>

<p>如果数据满足第二个参数里的条件那么对应的值被赋为<code>NA</code>。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r">na_if<span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">5</span><span class="p">,</span> <span class="m">5</span><span class="o">:</span><span class="m">1</span><span class="p">)</span>
<span class="c1">#&gt; [1]  1  2 NA  4  5</span>

x <span class="o">&lt;-</span> <span class="kt">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">-1</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">10</span><span class="p">)</span>
<span class="m">100</span> <span class="o">/</span> x
<span class="c1">#&gt; [1]  100 -100  Inf   10</span>
<span class="m">100</span> <span class="o">/</span> na_if<span class="p">(</span>x<span class="p">,</span> <span class="m">0</span><span class="p">)</span>
<span class="c1">#&gt; [1]  100 -100   NA   10</span>

y <span class="o">&lt;-</span> <span class="kt">c</span><span class="p">(</span><span class="s">&#34;abc&#34;</span><span class="p">,</span> <span class="s">&#34;def&#34;</span><span class="p">,</span> <span class="s">&#34;&#34;</span><span class="p">,</span> <span class="s">&#34;ghi&#34;</span><span class="p">)</span>
na_if<span class="p">(</span>y<span class="p">,</span> <span class="s">&#34;&#34;</span><span class="p">)</span>
<span class="c1">#&gt; [1] &#34;abc&#34; &#34;def&#34; NA    &#34;ghi&#34;</span></code></pre></td></tr></table>
</div>
</div>
<p><sup>Created on 2019-04-29 by the <a href="https://reprex.tidyverse.org">reprex package</a> (v0.2.1)</sup></p>

<p>当然也可以配合使用：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r">starwars <span class="o">%&gt;%</span>
  select<span class="p">(</span>name<span class="p">,</span> eye_color<span class="p">)</span> <span class="o">%&gt;%</span>
  mutate<span class="p">(</span>eye_color <span class="o">=</span> na_if<span class="p">(</span>eye_color<span class="p">,</span> <span class="s">&#34;unknown&#34;</span><span class="p">))</span>
<span class="c1">#&gt; # A tibble: 87 x 2</span>
<span class="c1">#&gt;    name               eye_color</span>
<span class="c1">#&gt;    &lt;chr&gt;              &lt;chr&gt;    </span>
<span class="c1">#&gt;  1 Luke Skywalker     blue     </span>
<span class="c1">#&gt;  2 C-3PO              yellow   </span>
<span class="c1">#&gt;  3 R2-D2              red      </span>
<span class="c1">#&gt;  4 Darth Vader        yellow   </span>
<span class="c1">#&gt;  5 Leia Organa        brown    </span>
<span class="c1">#&gt;  6 Owen Lars          blue     </span>
<span class="c1">#&gt;  7 Beru Whitesun lars blue     </span>
<span class="c1">#&gt;  8 R5-D4              red      </span>
<span class="c1">#&gt;  9 Biggs Darklighter  brown    </span>
<span class="c1">#&gt; 10 Obi-Wan Kenobi     blue-gray</span>
<span class="c1">#&gt; # ... with 77 more rows</span>

starwars <span class="o">%&gt;%</span>
  mutate_if<span class="p">(</span><span class="kp">is.character</span><span class="p">,</span> <span class="kt">list</span><span class="p">(</span><span class="o">~</span>na_if<span class="p">(</span><span class="m">.</span><span class="p">,</span> <span class="s">&#34;unknown&#34;</span><span class="p">)))</span>
<span class="c1">#&gt; # A tibble: 87 x 13</span>
<span class="c1">#&gt;    name  height  mass hair_color skin_color eye_color birth_year gender</span>
<span class="c1">#&gt;    &lt;chr&gt;  &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; </span>
<span class="c1">#&gt;  1 Luke~    172    77 blond      fair       blue            19   male  </span>
<span class="c1">#&gt;  2 C-3PO    167    75 &lt;NA&gt;       gold       yellow         112   &lt;NA&gt;  </span>
<span class="c1">#&gt;  3 R2-D2     96    32 &lt;NA&gt;       white, bl~ red             33   &lt;NA&gt;  </span>
<span class="c1">#&gt;  4 Dart~    202   136 none       white      yellow          41.9 male  </span>
<span class="c1">#&gt;  5 Leia~    150    49 brown      light      brown           19   female</span>
<span class="c1">#&gt;  6 Owen~    178   120 brown, gr~ light      blue            52   male  </span>
<span class="c1">#&gt;  7 Beru~    165    75 brown      light      blue            47   female</span>
<span class="c1">#&gt;  8 R5-D4     97    32 &lt;NA&gt;       white, red red             NA   &lt;NA&gt;  </span>
<span class="c1">#&gt;  9 Bigg~    183    84 black      light      brown           24   male  </span>
<span class="c1">#&gt; 10 Obi-~    182    77 auburn, w~ fair       blue-gray       57   male  </span>
<span class="c1">#&gt; # ... with 77 more rows, and 5 more variables: homeworld &lt;chr&gt;,</span>
<span class="c1">#&gt; #   species &lt;chr&gt;, films &lt;list&gt;, vehicles &lt;list&gt;, starships &lt;list&gt;</span></code></pre></td></tr></table>
</div>
</div>
<p><sup>Created on 2019-04-29 by the <a href="https://reprex.tidyverse.org">reprex package</a> (v0.2.1)</sup></p>

<a class="post-dummy-target" id="coalesce"></a><h3><code>coalesce()</code></h3>

<p>以<code>NA</code>为判定条件的合并。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r">x <span class="o">&lt;-</span> <span class="kp">sample</span><span class="p">(</span><span class="kt">c</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">5</span><span class="p">,</span> <span class="kc">NA</span><span class="p">,</span> <span class="kc">NA</span><span class="p">,</span> <span class="kc">NA</span><span class="p">))</span>
coalesce<span class="p">(</span>x<span class="p">,</span> <span class="m">0L</span><span class="p">)</span>
<span class="c1">#&gt; [1] 4 3 0 1 2 0 5 0</span>

y <span class="o">&lt;-</span> <span class="kt">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="kc">NA</span><span class="p">,</span> <span class="kc">NA</span><span class="p">,</span> <span class="m">5</span><span class="p">)</span>
z <span class="o">&lt;-</span> <span class="kt">c</span><span class="p">(</span><span class="kc">NA</span><span class="p">,</span> <span class="kc">NA</span><span class="p">,</span> <span class="m">3</span><span class="p">,</span> <span class="m">4</span><span class="p">,</span> <span class="m">5</span><span class="p">)</span>
coalesce<span class="p">(</span>y<span class="p">,</span> z<span class="p">)</span>
<span class="c1">#&gt; [1] 1 2 3 4 5</span>

vecs <span class="o">&lt;-</span> <span class="kt">list</span><span class="p">(</span>
  <span class="kt">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="kc">NA</span><span class="p">,</span> <span class="kc">NA</span><span class="p">,</span> <span class="m">5</span><span class="p">),</span>
  <span class="kt">c</span><span class="p">(</span><span class="kc">NA</span><span class="p">,</span> <span class="kc">NA</span><span class="p">,</span> <span class="m">3</span><span class="p">,</span> <span class="m">4</span><span class="p">,</span> <span class="m">5</span><span class="p">)</span>
<span class="p">)</span>
coalesce<span class="p">(</span><span class="o">!!!</span>vecs<span class="p">)</span>
<span class="c1">#&gt; [1] 1 2 3 4 5</span></code></pre></td></tr></table>
</div>
</div>
<p><sup>Created on 2019-04-29 by the <a href="https://reprex.tidyverse.org">reprex package</a> (v0.2.1)</sup></p>

<a class="post-dummy-target" id="if-else"></a><h3><code>if_else()</code></h3>

<p>判定条件+为<code>TRUE</code>时赋值+为<code>FALSE</code>时赋值+为<code>NA</code>时赋值。因为<code>NA</code>也算是logical的一个（严格来讲不是）。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r">x <span class="o">&lt;-</span> <span class="kt">c</span><span class="p">(</span><span class="m">-5</span><span class="o">:</span><span class="m">5</span><span class="p">,</span> <span class="kc">NA</span><span class="p">)</span>
if_else<span class="p">(</span>x <span class="o">&lt;</span> <span class="m">0</span><span class="p">,</span> <span class="kc">NA_integer_</span><span class="p">,</span> x<span class="p">)</span>
<span class="c1">#&gt;  [1] NA NA NA NA NA  0  1  2  3  4  5 NA</span>

if_else<span class="p">(</span>x <span class="o">&lt;</span> <span class="m">0</span><span class="p">,</span> <span class="s">&#34;negative&#34;</span><span class="p">,</span> <span class="s">&#34;positive&#34;</span><span class="p">,</span> <span class="s">&#34;missing&#34;</span><span class="p">)</span>
<span class="c1">#&gt;  [1] &#34;negative&#34; &#34;negative&#34; &#34;negative&#34; &#34;negative&#34; &#34;negative&#34; &#34;positive&#34;</span>
<span class="c1">#&gt;  [7] &#34;positive&#34; &#34;positive&#34; &#34;positive&#34; &#34;positive&#34; &#34;positive&#34; &#34;missing&#34;</span>

<span class="m">1</span> <span class="o">&lt;</span> <span class="kc">NA</span>
<span class="c1">#&gt; [1] NA</span></code></pre></td></tr></table>
</div>
</div>
<p><sup>Created on 2019-04-29 by the <a href="https://reprex.tidyverse.org">reprex package</a> (v0.2.1)</sup></p>

<a class="post-dummy-target" id="recode"></a><h3><code>recode()</code></h3>

<p>根据向量的位置或者它们的名字更换对应的值。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r">char_vec <span class="o">&lt;-</span> <span class="kp">sample</span><span class="p">(</span><span class="kt">c</span><span class="p">(</span><span class="s">&#34;a&#34;</span><span class="p">,</span> <span class="s">&#34;b&#34;</span><span class="p">,</span> <span class="s">&#34;c&#34;</span><span class="p">),</span> <span class="m">10</span><span class="p">,</span> replace <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>
recode<span class="p">(</span>char_vec<span class="p">,</span> a <span class="o">=</span> <span class="s">&#34;Apple&#34;</span><span class="p">)</span>
<span class="c1">#&gt;  [1] &#34;b&#34;     &#34;Apple&#34; &#34;Apple&#34; &#34;b&#34;     &#34;Apple&#34; &#34;b&#34;     &#34;Apple&#34; &#34;b&#34;    </span>
<span class="c1">#&gt;  [9] &#34;b&#34;     &#34;b&#34;</span>

recode<span class="p">(</span>char_vec<span class="p">,</span> a <span class="o">=</span> <span class="s">&#34;Apple&#34;</span><span class="p">,</span> b <span class="o">=</span> <span class="s">&#34;Banana&#34;</span><span class="p">,</span> <span class="m">.</span>default <span class="o">=</span> <span class="kc">NA_character_</span><span class="p">)</span>
<span class="c1">#&gt;  [1] &#34;Banana&#34; &#34;Apple&#34;  &#34;Apple&#34;  &#34;Banana&#34; &#34;Apple&#34;  &#34;Banana&#34; &#34;Apple&#34; </span>
<span class="c1">#&gt;  [8] &#34;Banana&#34; &#34;Banana&#34; &#34;Banana&#34;</span>

num_vec <span class="o">&lt;-</span> <span class="kt">c</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">,</span> <span class="kc">NA</span><span class="p">)</span>
recode<span class="p">(</span>num_vec<span class="p">,</span> <span class="s">&#34;a&#34;</span><span class="p">,</span> <span class="s">&#34;b&#34;</span><span class="p">,</span> <span class="s">&#34;c&#34;</span><span class="p">,</span> <span class="m">.</span>default <span class="o">=</span> <span class="s">&#34;other&#34;</span><span class="p">,</span> <span class="m">.</span>missing <span class="o">=</span> <span class="s">&#34;missing&#34;</span><span class="p">)</span>
<span class="c1">#&gt; [1] &#34;a&#34;       &#34;b&#34;       &#34;c&#34;       &#34;other&#34;   &#34;missing&#34;</span></code></pre></td></tr></table>
</div>
</div>
<p><sup>Created on 2019-04-29 by the <a href="https://reprex.tidyverse.org">reprex package</a> (v0.2.1)</sup></p>

<a class="post-dummy-target" id="case-when"></a><h3><code>case_when()</code></h3>

<p>注意可能因为顺序的原因导致结果和自己的预期不一样，另外<code>NA</code>的占位符性质也得有个交代。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r">x <span class="o">&lt;-</span> <span class="m">1</span><span class="o">:</span><span class="m">50</span>
case_when<span class="p">(</span>
  x <span class="o">%%</span> <span class="m">35</span> <span class="o">==</span> <span class="m">0</span> <span class="o">~</span> <span class="s">&#34;fizz buzz&#34;</span><span class="p">,</span>
  x <span class="o">%%</span> <span class="m">5</span> <span class="o">==</span> <span class="m">0</span> <span class="o">~</span> <span class="s">&#34;fizz&#34;</span><span class="p">,</span>
  x <span class="o">%%</span> <span class="m">7</span> <span class="o">==</span> <span class="m">0</span> <span class="o">~</span> <span class="s">&#34;buzz&#34;</span><span class="p">,</span>
  <span class="kc">TRUE</span> <span class="o">~</span> <span class="kp">as.character</span><span class="p">(</span>x<span class="p">)</span>
<span class="p">)</span>
<span class="c1">#&gt;  [1] &#34;1&#34;         &#34;2&#34;         &#34;3&#34;         &#34;4&#34;         &#34;fizz&#34;     </span>
<span class="c1">#&gt;  [6] &#34;6&#34;         &#34;buzz&#34;      &#34;8&#34;         &#34;9&#34;         &#34;fizz&#34;     </span>
<span class="c1">#&gt; [11] &#34;11&#34;        &#34;12&#34;        &#34;13&#34;        &#34;buzz&#34;      &#34;fizz&#34;     </span>
<span class="c1">#&gt; [16] &#34;16&#34;        &#34;17&#34;        &#34;18&#34;        &#34;19&#34;        &#34;fizz&#34;     </span>
<span class="c1">#&gt; [21] &#34;buzz&#34;      &#34;22&#34;        &#34;23&#34;        &#34;24&#34;        &#34;fizz&#34;     </span>
<span class="c1">#&gt; [26] &#34;26&#34;        &#34;27&#34;        &#34;buzz&#34;      &#34;29&#34;        &#34;fizz&#34;     </span>
<span class="c1">#&gt; [31] &#34;31&#34;        &#34;32&#34;        &#34;33&#34;        &#34;34&#34;        &#34;fizz buzz&#34;</span>
<span class="c1">#&gt; [36] &#34;36&#34;        &#34;37&#34;        &#34;38&#34;        &#34;39&#34;        &#34;fizz&#34;     </span>
<span class="c1">#&gt; [41] &#34;41&#34;        &#34;buzz&#34;      &#34;43&#34;        &#34;44&#34;        &#34;fizz&#34;     </span>
<span class="c1">#&gt; [46] &#34;46&#34;        &#34;47&#34;        &#34;48&#34;        &#34;buzz&#34;      &#34;fizz&#34;</span>

case_when<span class="p">(</span>
  <span class="kc">TRUE</span> <span class="o">~</span> <span class="kp">as.character</span><span class="p">(</span>x<span class="p">),</span>
  x <span class="o">%%</span>  <span class="m">5</span> <span class="o">==</span> <span class="m">0</span> <span class="o">~</span> <span class="s">&#34;fizz&#34;</span><span class="p">,</span>
  x <span class="o">%%</span>  <span class="m">7</span> <span class="o">==</span> <span class="m">0</span> <span class="o">~</span> <span class="s">&#34;buzz&#34;</span><span class="p">,</span>
  x <span class="o">%%</span> <span class="m">35</span> <span class="o">==</span> <span class="m">0</span> <span class="o">~</span> <span class="s">&#34;fizz buzz&#34;</span>
<span class="p">)</span>
<span class="c1">#&gt;  [1] &#34;1&#34;  &#34;2&#34;  &#34;3&#34;  &#34;4&#34;  &#34;5&#34;  &#34;6&#34;  &#34;7&#34;  &#34;8&#34;  &#34;9&#34;  &#34;10&#34; &#34;11&#34; &#34;12&#34; &#34;13&#34; &#34;14&#34;</span>
<span class="c1">#&gt; [15] &#34;15&#34; &#34;16&#34; &#34;17&#34; &#34;18&#34; &#34;19&#34; &#34;20&#34; &#34;21&#34; &#34;22&#34; &#34;23&#34; &#34;24&#34; &#34;25&#34; &#34;26&#34; &#34;27&#34; &#34;28&#34;</span>
<span class="c1">#&gt; [29] &#34;29&#34; &#34;30&#34; &#34;31&#34; &#34;32&#34; &#34;33&#34; &#34;34&#34; &#34;35&#34; &#34;36&#34; &#34;37&#34; &#34;38&#34; &#34;39&#34; &#34;40&#34; &#34;41&#34; &#34;42&#34;</span>
<span class="c1">#&gt; [43] &#34;43&#34; &#34;44&#34; &#34;45&#34; &#34;46&#34; &#34;47&#34; &#34;48&#34; &#34;49&#34; &#34;50&#34;</span>

case_when<span class="p">(</span>
  x <span class="o">%%</span>  <span class="m">5</span> <span class="o">==</span> <span class="m">0</span> <span class="o">~</span> <span class="s">&#34;fizz&#34;</span><span class="p">,</span>
  x <span class="o">%%</span>  <span class="m">7</span> <span class="o">==</span> <span class="m">0</span> <span class="o">~</span> <span class="s">&#34;buzz&#34;</span><span class="p">,</span>
  x <span class="o">%%</span> <span class="m">35</span> <span class="o">==</span> <span class="m">0</span> <span class="o">~</span> <span class="s">&#34;fizz buzz&#34;</span>
<span class="p">)</span>
<span class="c1">#&gt;  [1] NA     NA     NA     NA     &#34;fizz&#34; NA     &#34;buzz&#34; NA     NA     &#34;fizz&#34;</span>
<span class="c1">#&gt; [11] NA     NA     NA     &#34;buzz&#34; &#34;fizz&#34; NA     NA     NA     NA     &#34;fizz&#34;</span>
<span class="c1">#&gt; [21] &#34;buzz&#34; NA     NA     NA     &#34;fizz&#34; NA     NA     &#34;buzz&#34; NA     &#34;fizz&#34;</span>
<span class="c1">#&gt; [31] NA     NA     NA     NA     &#34;fizz&#34; NA     NA     NA     NA     &#34;fizz&#34;</span>
<span class="c1">#&gt; [41] NA     &#34;buzz&#34; NA     NA     &#34;fizz&#34; NA     NA     NA     &#34;buzz&#34; &#34;fizz&#34;</span>

x<span class="p">[</span><span class="m">2</span><span class="o">:</span><span class="m">4</span><span class="p">]</span> <span class="o">&lt;-</span> <span class="kc">NA_real_</span>
case_when<span class="p">(</span>
  x <span class="o">%%</span> <span class="m">35</span> <span class="o">==</span> <span class="m">0</span> <span class="o">~</span> <span class="s">&#34;fizz buzz&#34;</span><span class="p">,</span>
  x <span class="o">%%</span> <span class="m">5</span> <span class="o">==</span> <span class="m">0</span> <span class="o">~</span> <span class="s">&#34;fizz&#34;</span><span class="p">,</span>
  x <span class="o">%%</span> <span class="m">7</span> <span class="o">==</span> <span class="m">0</span> <span class="o">~</span> <span class="s">&#34;buzz&#34;</span><span class="p">,</span>
  <span class="kp">is.na</span><span class="p">(</span>x<span class="p">)</span> <span class="o">~</span> <span class="s">&#34;nope&#34;</span><span class="p">,</span>
  <span class="kc">TRUE</span> <span class="o">~</span> <span class="kp">as.character</span><span class="p">(</span>x<span class="p">)</span>
<span class="p">)</span>
<span class="c1">#&gt;  [1] &#34;1&#34;         &#34;nope&#34;      &#34;nope&#34;      &#34;nope&#34;      &#34;fizz&#34;     </span>
<span class="c1">#&gt;  [6] &#34;6&#34;         &#34;buzz&#34;      &#34;8&#34;         &#34;9&#34;         &#34;fizz&#34;     </span>
<span class="c1">#&gt; [11] &#34;11&#34;        &#34;12&#34;        &#34;13&#34;        &#34;buzz&#34;      &#34;fizz&#34;     </span>
<span class="c1">#&gt; [16] &#34;16&#34;        &#34;17&#34;        &#34;18&#34;        &#34;19&#34;        &#34;fizz&#34;     </span>
<span class="c1">#&gt; [21] &#34;buzz&#34;      &#34;22&#34;        &#34;23&#34;        &#34;24&#34;        &#34;fizz&#34;     </span>
<span class="c1">#&gt; [26] &#34;26&#34;        &#34;27&#34;        &#34;buzz&#34;      &#34;29&#34;        &#34;fizz&#34;     </span>
<span class="c1">#&gt; [31] &#34;31&#34;        &#34;32&#34;        &#34;33&#34;        &#34;34&#34;        &#34;fizz buzz&#34;</span>
<span class="c1">#&gt; [36] &#34;36&#34;        &#34;37&#34;        &#34;38&#34;        &#34;39&#34;        &#34;fizz&#34;     </span>
<span class="c1">#&gt; [41] &#34;41&#34;        &#34;buzz&#34;      &#34;43&#34;        &#34;44&#34;        &#34;fizz&#34;     </span>
<span class="c1">#&gt; [46] &#34;46&#34;        &#34;47&#34;        &#34;48&#34;        &#34;buzz&#34;      &#34;fizz&#34;</span></code></pre></td></tr></table>
</div>
</div>
<p><sup>Created on 2019-04-29 by the <a href="https://reprex.tidyverse.org">reprex package</a> (v0.2.1)</sup></p>

<a class="post-dummy-target" id="the-point"></a><h2>The point</h2>

<p>一个可以写入、删除、覆盖；另一个可以提取。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r">mtcars <span class="o">%&gt;%</span>
  mutate<span class="p">(</span>mpg <span class="o">=</span> <span class="kc">NULL</span><span class="p">,</span>
         displ_l <span class="o">=</span> disp <span class="o">/</span> <span class="m">61.0237</span><span class="p">)</span> <span class="o">%&gt;%</span> <span class="kp">head</span><span class="p">()</span>
<span class="c1">#&gt;   cyl disp  hp drat    wt  qsec vs am gear carb  displ_l</span>
<span class="c1">#&gt; 1   6  160 110 3.90 2.620 16.46  0  1    4    4 2.621932</span>
<span class="c1">#&gt; 2   6  160 110 3.90 2.875 17.02  0  1    4    4 2.621932</span>
<span class="c1">#&gt; 3   4  108  93 3.85 2.320 18.61  1  1    4    1 1.769804</span>
<span class="c1">#&gt; 4   6  258 110 3.08 3.215 19.44  1  0    3    1 4.227866</span>
<span class="c1">#&gt; 5   8  360 175 3.15 3.440 17.02  0  0    3    2 5.899347</span>
<span class="c1">#&gt; 6   6  225 105 2.76 3.460 20.22  1  0    3    1 3.687092</span>

mtcars <span class="o">%&gt;%</span>
  transmute<span class="p">(</span>mpg <span class="o">=</span> <span class="kc">NULL</span><span class="p">,</span>
            displ_l <span class="o">=</span> disp <span class="o">/</span> <span class="m">61.0237</span><span class="p">)</span> <span class="o">%&gt;%</span> <span class="kp">head</span><span class="p">()</span>
<span class="c1">#&gt; Warning: Unknown columns: `mpg`</span>
<span class="c1">#&gt;    displ_l</span>
<span class="c1">#&gt; 1 2.621932</span>
<span class="c1">#&gt; 2 2.621932</span>
<span class="c1">#&gt; 3 1.769804</span>
<span class="c1">#&gt; 4 4.227866</span>
<span class="c1">#&gt; 5 5.899347</span>
<span class="c1">#&gt; 6 3.687092</span></code></pre></td></tr></table>
</div>
</div>
<p><sup>Created on 2019-04-29 by the <a href="https://reprex.tidyverse.org">reprex package</a> (v0.2.1)</sup></p>

<a class="post-dummy-target" id="variation-2"></a><h2>Variation</h2>

<p>还是不变的套路。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r">mutate_all<span class="p">(</span><span class="m">.</span>tbl<span class="p">,</span> <span class="m">.</span>funs<span class="p">,</span> <span class="kc">...</span><span class="p">)</span>

mutate_if<span class="p">(</span><span class="m">.</span>tbl<span class="p">,</span> <span class="m">.</span>predicate<span class="p">,</span> <span class="m">.</span>funs<span class="p">,</span> <span class="kc">...</span><span class="p">)</span>

mutate_at<span class="p">(</span><span class="m">.</span>tbl<span class="p">,</span> <span class="m">.</span>vars<span class="p">,</span> <span class="m">.</span>funs<span class="p">,</span> <span class="kc">...</span><span class="p">,</span> <span class="m">.</span>cols <span class="o">=</span> <span class="kc">NULL</span><span class="p">)</span>

transmute_all<span class="p">(</span><span class="m">.</span>tbl<span class="p">,</span> <span class="m">.</span>funs<span class="p">,</span> <span class="kc">...</span><span class="p">)</span>

transmute_if<span class="p">(</span><span class="m">.</span>tbl<span class="p">,</span> <span class="m">.</span>predicate<span class="p">,</span> <span class="m">.</span>funs<span class="p">,</span> <span class="kc">...</span><span class="p">)</span>

transmute_at<span class="p">(</span><span class="m">.</span>tbl<span class="p">,</span> <span class="m">.</span>vars<span class="p">,</span> <span class="m">.</span>funs<span class="p">,</span> <span class="kc">...</span><span class="p">,</span> <span class="m">.</span>cols <span class="o">=</span> <span class="kc">NULL</span><span class="p">)</span></code></pre></td></tr></table>
</div>
</div>
<p>这里提到了*purrr-style formulas*，不急我马上就要折腾到这里了😂！</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="c1"># The list can contain purrr-style formulas:</span>
iris <span class="o">%&gt;%</span> mutate_if<span class="p">(</span><span class="kp">is.numeric</span><span class="p">,</span> <span class="kt">list</span><span class="p">(</span><span class="o">~</span>scale2<span class="p">(</span><span class="m">.</span><span class="p">),</span> <span class="o">~</span><span class="kp">log</span><span class="p">(</span><span class="m">.</span><span class="p">)))</span>
<span class="c1">#&gt; # A tibble: 150 x 13</span>
<span class="c1">#&gt;    Sepal.Length Sepal.Width Petal.Length Petal.Width Species Sepal.Length_sc…</span>
<span class="c1">#&gt;           &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt; &lt;fct&gt;              &lt;dbl&gt;</span>
<span class="c1">#&gt;  1          5.1         3.5          1.4         0.2 setosa            -0.898</span>
<span class="c1">#&gt;  2          4.9         3            1.4         0.2 setosa            -1.14 </span>
<span class="c1">#&gt;  3          4.7         3.2          1.3         0.2 setosa            -1.38 </span>
<span class="c1">#&gt;  4          4.6         3.1          1.5         0.2 setosa            -1.50 </span>
<span class="c1">#&gt;  5          5           3.6          1.4         0.2 setosa            -1.02 </span>
<span class="c1">#&gt;  6          5.4         3.9          1.7         0.4 setosa            -0.535</span>
<span class="c1">#&gt;  7          4.6         3.4          1.4         0.3 setosa            -1.50 </span>
<span class="c1">#&gt;  8          5           3.4          1.5         0.2 setosa            -1.02 </span>
<span class="c1">#&gt;  9          4.4         2.9          1.4         0.2 setosa            -1.74 </span>
<span class="c1">#&gt; 10          4.9         3.1          1.5         0.1 setosa            -1.14 </span>
<span class="c1">#&gt; # … with 140 more rows, and 7 more variables: Sepal.Width_scale2 &lt;dbl&gt;,</span>
<span class="c1">#&gt; #   Petal.Length_scale2 &lt;dbl&gt;, Petal.Width_scale2 &lt;dbl&gt;,</span>
<span class="c1">#&gt; #   Sepal.Length_log &lt;dbl&gt;, Sepal.Width_log &lt;dbl&gt;, Petal.Length_log &lt;dbl&gt;,</span>
<span class="c1">#&gt; #   Petal.Width_log &lt;dbl&gt;</span></code></pre></td></tr></table>
</div>
</div>
<a class="post-dummy-target" id="group-by"></a><h1><code>group_by</code></h1>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r">by_vs_am <span class="o">&lt;-</span> mtcars <span class="o">%&gt;%</span> group_by<span class="p">(</span>vs<span class="p">,</span> am<span class="p">)</span>
by_vs_am <span class="o">%&gt;%</span> summarise<span class="p">(</span>n <span class="o">=</span> n<span class="p">())</span>
<span class="c1">#&gt; # A tibble: 4 x 3</span>
<span class="c1">#&gt; # Groups:   vs [2]</span>
<span class="c1">#&gt;      vs    am     n</span>
<span class="c1">#&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt;</span>
<span class="c1">#&gt; 1     0     0    12</span>
<span class="c1">#&gt; 2     0     1     6</span>
<span class="c1">#&gt; 3     1     0     7</span>
<span class="c1">#&gt; 4     1     1     7</span>

by_cyl <span class="o">&lt;-</span> mtcars <span class="o">%&gt;%</span> group_by<span class="p">(</span>cyl<span class="p">)</span>

by_cyl <span class="o">%&gt;%</span>
  group_by<span class="p">(</span>vs<span class="p">,</span> am<span class="p">,</span> add <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span> <span class="o">%&gt;%</span>
  group_vars<span class="p">()</span>
<span class="c1">#&gt; [1] &#34;cyl&#34; &#34;vs&#34;  &#34;am&#34;</span>

by_cyl <span class="o">%&gt;%</span>
  group_by<span class="p">(</span>vs<span class="p">,</span> am<span class="p">)</span> <span class="o">%&gt;%</span>
  group_vars<span class="p">()</span>
<span class="c1">#&gt; [1] &#34;vs&#34; &#34;am&#34;</span></code></pre></td></tr></table>
</div>
</div>
<p><sup>Created on 2019-04-29 by the <a href="https://reprex.tidyverse.org">reprex package</a> (v0.2.1)</sup></p>

<p>当然，想scoped一下也可以……</p>

<a class="post-dummy-target" id="summarize"></a><h1><code>summarize()</code></h1>

<a class="post-dummy-target" id="useful-functions-1"></a><h2>Useful functions</h2>

<p>这里当然会有很多辅助函数的啦~</p>

<ul>
<li>Center: <code>mean()</code>, <code>median()</code></li>
<li>Spread: <code>sd()</code>, <code>IQR()</code>, <code>mad()</code></li>
<li>Range: <code>min()</code>, <code>max()</code>, <code>quantile()</code></li>
<li>Position: <code>first()</code>, <code>last()</code>, <code>nth()</code>,</li>
<li>Count: <code>n()</code>, <code>n_distinct()</code>: a faster and more concise equivalent of <code>length(unique(x))</code></li>

<li><p>Logical: <code>any()</code>, <code>all()</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r">x <span class="o">&lt;-</span> <span class="m">1</span><span class="o">:</span><span class="m">10</span>
y <span class="o">&lt;-</span> <span class="m">10</span><span class="o">:</span><span class="m">1</span>

first<span class="p">(</span>x<span class="p">)</span>
<span class="c1">#&gt; [1] 1</span>
last<span class="p">(</span>y<span class="p">)</span>
<span class="c1">#&gt; [1] 1</span>

nth<span class="p">(</span>x<span class="p">,</span> <span class="m">1</span><span class="p">)</span>
<span class="c1">#&gt; [1] 1</span>
nth<span class="p">(</span>x<span class="p">,</span> <span class="m">5</span><span class="p">)</span>
<span class="c1">#&gt; [1] 5</span>
nth<span class="p">(</span>x<span class="p">,</span> <span class="m">-2</span><span class="p">)</span>
<span class="c1">#&gt; [1] 9</span>
nth<span class="p">(</span>x<span class="p">,</span> <span class="m">11</span><span class="p">)</span>
<span class="c1">#&gt; [1] NA</span>

last<span class="p">(</span>x<span class="p">)</span>
<span class="c1">#&gt; [1] 10</span>
<span class="c1"># Second argument provides optional ordering</span>
last<span class="p">(</span>x<span class="p">,</span> y<span class="p">)</span>
<span class="c1">#&gt; [1] 1</span></code></pre></td></tr></table>
</div>
</div></li>
</ul>

<p><sup>Created on 2019-04-29 by the <a href="https://reprex.tidyverse.org">reprex package</a> (v0.2.1)</sup></p>

<a class="post-dummy-target" id="distinct"></a><h1><code>distinct()</code></h1>

<p>打印无重复的数据。如果参数只是一个数据框，那么会选择数据框独一无二的每一行打印；如果加上数据框内的列名，那么会按照列来，多少列都可以的，因为是<code>...</code>；又因为是<code>...</code>，写入一个值也可以不过也要distinct一下。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r">df <span class="o">&lt;-</span> tibble<span class="p">(</span>
  x <span class="o">=</span> <span class="kp">sample</span><span class="p">(</span><span class="m">10</span><span class="p">,</span> <span class="m">100</span><span class="p">,</span> rep <span class="o">=</span> <span class="kc">TRUE</span><span class="p">),</span>
  y <span class="o">=</span> <span class="kp">sample</span><span class="p">(</span><span class="m">10</span><span class="p">,</span> <span class="m">100</span><span class="p">,</span> rep <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>
<span class="p">)</span>
<span class="kp">nrow</span><span class="p">(</span>df<span class="p">)</span>
<span class="c1">#&gt; [1] 100</span>

<span class="kp">nrow</span><span class="p">(</span>distinct<span class="p">(</span>df<span class="p">))</span>
<span class="c1">#&gt; [1] 66</span>

<span class="kp">nrow</span><span class="p">(</span>distinct<span class="p">(</span>df<span class="p">,</span> x<span class="p">,</span> y<span class="p">))</span>
<span class="c1">#&gt; [1] 66</span>

distinct<span class="p">(</span>df<span class="p">,</span> x<span class="p">)</span>
<span class="c1">#&gt; # A tibble: 10 x 1</span>
<span class="c1">#&gt;        x</span>
<span class="c1">#&gt;    &lt;int&gt;</span>
<span class="c1">#&gt;  1     1</span>
<span class="c1">#&gt;  2    10</span>
<span class="c1">#&gt;  3     9</span>
<span class="c1">#&gt;  4     3</span>
<span class="c1">#&gt;  5     2</span>
<span class="c1">#&gt;  6     7</span>
<span class="c1">#&gt;  7     8</span>
<span class="c1">#&gt;  8     4</span>
<span class="c1">#&gt;  9     5</span>
<span class="c1">#&gt; 10     6</span>

distinct<span class="p">(</span>df<span class="p">,</span> y<span class="p">)</span>
<span class="c1">#&gt; # A tibble: 10 x 1</span>
<span class="c1">#&gt;        y</span>
<span class="c1">#&gt;    &lt;int&gt;</span>
<span class="c1">#&gt;  1     9</span>
<span class="c1">#&gt;  2     2</span>
<span class="c1">#&gt;  3     5</span>
<span class="c1">#&gt;  4     1</span>
<span class="c1">#&gt;  5     6</span>
<span class="c1">#&gt;  6     7</span>
<span class="c1">#&gt;  7     8</span>
<span class="c1">#&gt;  8     3</span>
<span class="c1">#&gt;  9    10</span>
<span class="c1">#&gt; 10     4</span>

distinct<span class="p">(</span>df<span class="p">,</span> y<span class="p">,</span> <span class="m">.</span>keep_all <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>
<span class="c1">#&gt; # A tibble: 10 x 2</span>
<span class="c1">#&gt;        x     y</span>
<span class="c1">#&gt;    &lt;int&gt; &lt;int&gt;</span>
<span class="c1">#&gt;  1     1     9</span>
<span class="c1">#&gt;  2    10     2</span>
<span class="c1">#&gt;  3     9     5</span>
<span class="c1">#&gt;  4     3     1</span>
<span class="c1">#&gt;  5     9     6</span>
<span class="c1">#&gt;  6    10     7</span>
<span class="c1">#&gt;  7     7     8</span>
<span class="c1">#&gt;  8     8     3</span>
<span class="c1">#&gt;  9     5    10</span>
<span class="c1">#&gt; 10     9     4</span>

distinct<span class="p">(</span>df<span class="p">,</span> diff <span class="o">=</span> <span class="kp">abs</span><span class="p">(</span>x <span class="o">-</span> y<span class="p">))</span>
<span class="c1">#&gt; # A tibble: 9 x 1</span>
<span class="c1">#&gt;    diff</span>
<span class="c1">#&gt;   &lt;int&gt;</span>
<span class="c1">#&gt; 1     8</span>
<span class="c1">#&gt; 2     4</span>
<span class="c1">#&gt; 3     2</span>
<span class="c1">#&gt; 4     3</span>
<span class="c1">#&gt; 5     5</span>
<span class="c1">#&gt; 6     1</span>
<span class="c1">#&gt; 7     0</span>
<span class="c1">#&gt; 8     7</span>
<span class="c1">#&gt; 9     6</span></code></pre></td></tr></table>
</div>
</div>
<p><sup>Created on 2019-04-29 by the <a href="https://reprex.tidyverse.org">reprex package</a> (v0.2.1)</sup></p>

<p>同样地，这里的变量也可以scoped一下。</p>

<a class="post-dummy-target" id="do"></a><h1><code>do()</code></h1>

<p>Do <a href="https://dplyr.tidyverse.org/reference/do.html">anything</a>.😭</p>

<a class="post-dummy-target" id="sample-n-sample-frac"></a><h1><code>sample_n()</code>/<code>sample_frac()</code></h1>

<p>前者是按数量抽样，后者是按与原数据行数的比例抽样，以分数（小数）形式。</p>

<a class="post-dummy-target" id="slice"></a><h1><code>slice()</code></h1>

<p>按行的位置抽取行。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r">slice<span class="p">(</span>mtcars<span class="p">,</span> <span class="m">1L</span><span class="p">)</span>
<span class="c1">#&gt;   mpg cyl disp  hp drat   wt  qsec vs am gear carb</span>
<span class="c1">#&gt; 1  21   6  160 110  3.9 2.62 16.46  0  1    4    4</span>

slice<span class="p">(</span>mtcars<span class="p">,</span> n<span class="p">())</span>
<span class="c1">#&gt;    mpg cyl disp  hp drat   wt qsec vs am gear carb</span>
<span class="c1">#&gt; 1 21.4   4  121 109 4.11 2.78 18.6  1  1    4    2</span>

slice<span class="p">(</span>mtcars<span class="p">,</span> <span class="m">5</span><span class="o">:</span>n<span class="p">())</span>
<span class="c1">#&gt;     mpg cyl  disp  hp drat    wt  qsec vs am gear carb</span>
<span class="c1">#&gt; 1  18.7   8 360.0 175 3.15 3.440 17.02  0  0    3    2</span>
<span class="c1">#&gt; 2  18.1   6 225.0 105 2.76 3.460 20.22  1  0    3    1</span>
<span class="c1">#&gt; 3  14.3   8 360.0 245 3.21 3.570 15.84  0  0    3    4</span>
<span class="c1">#&gt; 4  24.4   4 146.7  62 3.69 3.190 20.00  1  0    4    2</span>
<span class="c1">#&gt; 5  22.8   4 140.8  95 3.92 3.150 22.90  1  0    4    2</span>
<span class="c1">#&gt; 6  19.2   6 167.6 123 3.92 3.440 18.30  1  0    4    4</span>
<span class="c1">#&gt; 7  17.8   6 167.6 123 3.92 3.440 18.90  1  0    4    4</span>
<span class="c1">#&gt; 8  16.4   8 275.8 180 3.07 4.070 17.40  0  0    3    3</span>
<span class="c1">#&gt; 9  17.3   8 275.8 180 3.07 3.730 17.60  0  0    3    3</span>
<span class="c1">#&gt; 10 15.2   8 275.8 180 3.07 3.780 18.00  0  0    3    3</span>
<span class="c1">#&gt; 11 10.4   8 472.0 205 2.93 5.250 17.98  0  0    3    4</span>
<span class="c1">#&gt; 12 10.4   8 460.0 215 3.00 5.424 17.82  0  0    3    4</span>
<span class="c1">#&gt; 13 14.7   8 440.0 230 3.23 5.345 17.42  0  0    3    4</span>
<span class="c1">#&gt; 14 32.4   4  78.7  66 4.08 2.200 19.47  1  1    4    1</span>
<span class="c1">#&gt; 15 30.4   4  75.7  52 4.93 1.615 18.52  1  1    4    2</span>
<span class="c1">#&gt; 16 33.9   4  71.1  65 4.22 1.835 19.90  1  1    4    1</span>
<span class="c1">#&gt; 17 21.5   4 120.1  97 3.70 2.465 20.01  1  0    3    1</span>
<span class="c1">#&gt; 18 15.5   8 318.0 150 2.76 3.520 16.87  0  0    3    2</span>
<span class="c1">#&gt; 19 15.2   8 304.0 150 3.15 3.435 17.30  0  0    3    2</span>
<span class="c1">#&gt; 20 13.3   8 350.0 245 3.73 3.840 15.41  0  0    3    4</span>
<span class="c1">#&gt; 21 19.2   8 400.0 175 3.08 3.845 17.05  0  0    3    2</span>
<span class="c1">#&gt; 22 27.3   4  79.0  66 4.08 1.935 18.90  1  1    4    1</span>
<span class="c1">#&gt; 23 26.0   4 120.3  91 4.43 2.140 16.70  0  1    5    2</span>
<span class="c1">#&gt; 24 30.4   4  95.1 113 3.77 1.513 16.90  1  1    5    2</span>
<span class="c1">#&gt; 25 15.8   8 351.0 264 4.22 3.170 14.50  0  1    5    4</span>
<span class="c1">#&gt; 26 19.7   6 145.0 175 3.62 2.770 15.50  0  1    5    6</span>
<span class="c1">#&gt; 27 15.0   8 301.0 335 3.54 3.570 14.60  0  1    5    8</span>
<span class="c1">#&gt; 28 21.4   4 121.0 109 4.11 2.780 18.60  1  1    4    2</span>

<span class="c1"># Equivalent</span>
<span class="c1"># filter(mtcars, row_number() == 1L)</span>
<span class="c1"># </span>
<span class="c1"># filter(mtcars, row_number() == n())</span>
<span class="c1"># </span>
<span class="c1"># filter(mtcars, between(row_number(), 5, n()))</span></code></pre></td></tr></table>
</div>
</div>
<p><sup>Created on 2019-04-29 by the <a href="https://reprex.tidyverse.org">reprex package</a> (v0.2.1)</sup></p>

<a class="post-dummy-target" id="tally-count"></a><h1><code>tally()</code>/<code>count()</code></h1>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="c1"># tally() is short-hand for summarise()</span>
mtcars <span class="o">%&gt;%</span> tally<span class="p">()</span>
<span class="c1">#&gt;    n</span>
<span class="c1">#&gt; 1 32</span>

mtcars <span class="o">%&gt;%</span> group_by<span class="p">(</span>cyl<span class="p">)</span> <span class="o">%&gt;%</span> tally<span class="p">()</span>
<span class="c1">#&gt; # A tibble: 3 x 2</span>
<span class="c1">#&gt;     cyl     n</span>
<span class="c1">#&gt;   &lt;dbl&gt; &lt;int&gt;</span>
<span class="c1">#&gt; 1     4    11</span>
<span class="c1">#&gt; 2     6     7</span>
<span class="c1">#&gt; 3     8    14</span>

<span class="c1"># count() is a short-hand for group_by() + tally()</span>
mtcars <span class="o">%&gt;%</span> count<span class="p">(</span>cyl<span class="p">)</span>
<span class="c1">#&gt; # A tibble: 3 x 2</span>
<span class="c1">#&gt;     cyl     n</span>
<span class="c1">#&gt;   &lt;dbl&gt; &lt;int&gt;</span>
<span class="c1">#&gt; 1     4    11</span>
<span class="c1">#&gt; 2     6     7</span>
<span class="c1">#&gt; 3     8    14</span>

<span class="c1"># add_tally() is short-hand for mutate()</span>
mtcars <span class="o">%&gt;%</span> add_tally<span class="p">()</span>
<span class="c1">#&gt; # A tibble: 32 x 12</span>
<span class="c1">#&gt;      mpg   cyl  disp    hp  drat    wt  qsec    vs    am  gear  carb     n</span>
<span class="c1">#&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt;</span>
<span class="c1">#&gt;  1  21       6  160    110  3.9   2.62  16.5     0     1     4     4    32</span>
<span class="c1">#&gt;  2  21       6  160    110  3.9   2.88  17.0     0     1     4     4    32</span>
<span class="c1">#&gt;  3  22.8     4  108     93  3.85  2.32  18.6     1     1     4     1    32</span>
<span class="c1">#&gt;  4  21.4     6  258    110  3.08  3.22  19.4     1     0     3     1    32</span>
<span class="c1">#&gt;  5  18.7     8  360    175  3.15  3.44  17.0     0     0     3     2    32</span>
<span class="c1">#&gt;  6  18.1     6  225    105  2.76  3.46  20.2     1     0     3     1    32</span>
<span class="c1">#&gt;  7  14.3     8  360    245  3.21  3.57  15.8     0     0     3     4    32</span>
<span class="c1">#&gt;  8  24.4     4  147.    62  3.69  3.19  20       1     0     4     2    32</span>
<span class="c1">#&gt;  9  22.8     4  141.    95  3.92  3.15  22.9     1     0     4     2    32</span>
<span class="c1">#&gt; 10  19.2     6  168.   123  3.92  3.44  18.3     1     0     4     4    32</span>
<span class="c1">#&gt; # ... with 22 more rows</span>

<span class="c1"># add_count() is a short-hand for group_by() + add_tally()</span>
mtcars <span class="o">%&gt;%</span> add_count<span class="p">(</span>cyl<span class="p">)</span>
<span class="c1">#&gt; # A tibble: 32 x 12</span>
<span class="c1">#&gt;      mpg   cyl  disp    hp  drat    wt  qsec    vs    am  gear  carb     n</span>
<span class="c1">#&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt;</span>
<span class="c1">#&gt;  1  21       6  160    110  3.9   2.62  16.5     0     1     4     4     7</span>
<span class="c1">#&gt;  2  21       6  160    110  3.9   2.88  17.0     0     1     4     4     7</span>
<span class="c1">#&gt;  3  22.8     4  108     93  3.85  2.32  18.6     1     1     4     1    11</span>
<span class="c1">#&gt;  4  21.4     6  258    110  3.08  3.22  19.4     1     0     3     1     7</span>
<span class="c1">#&gt;  5  18.7     8  360    175  3.15  3.44  17.0     0     0     3     2    14</span>
<span class="c1">#&gt;  6  18.1     6  225    105  2.76  3.46  20.2     1     0     3     1     7</span>
<span class="c1">#&gt;  7  14.3     8  360    245  3.21  3.57  15.8     0     0     3     4    14</span>
<span class="c1">#&gt;  8  24.4     4  147.    62  3.69  3.19  20       1     0     4     2    11</span>
<span class="c1">#&gt;  9  22.8     4  141.    95  3.92  3.15  22.9     1     0     4     2    11</span>
<span class="c1">#&gt; 10  19.2     6  168.   123  3.92  3.44  18.3     1     0     4     4     7</span>
<span class="c1">#&gt; # ... with 22 more rows</span></code></pre></td></tr></table>
</div>
</div>
<p><sup>Created on 2019-04-29 by the <a href="https://reprex.tidyverse.org">reprex package</a> (v0.2.1)</sup></p>

<a class="post-dummy-target" id="top-n"></a><h1><code>top_n()</code></h1>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r">df <span class="o">&lt;-</span> <span class="kt">data.frame</span><span class="p">(</span>x <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="m">10</span><span class="p">,</span> <span class="m">4</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">6</span><span class="p">,</span> <span class="m">3</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">))</span>
df <span class="o">%&gt;%</span> top_n<span class="p">(</span><span class="m">2</span><span class="p">)</span>
<span class="c1">#&gt; Selecting by x</span>
<span class="c1">#&gt;    x</span>
<span class="c1">#&gt; 1 10</span>
<span class="c1">#&gt; 2  6</span>

df <span class="o">%&gt;%</span> top_n<span class="p">(</span><span class="m">-2</span><span class="p">)</span>
<span class="c1">#&gt; Selecting by x</span>
<span class="c1">#&gt;   x</span>
<span class="c1">#&gt; 1 1</span>
<span class="c1">#&gt; 2 1</span>
<span class="c1">#&gt; 3 1</span></code></pre></td></tr></table>
</div>
</div>
<p><sup>Created on 2019-04-29 by the <a href="https://reprex.tidyverse.org">reprex package</a> (v0.2.1)</sup></p>

<a class="post-dummy-target" id="scoped"></a><h1>Scoped</h1>

<ul>
<li><code>arrange_all()</code>, <code>arrange_at()</code>, and <code>arrange_if()</code></li>
<li><code>distinct_all()</code>, <code>distinct_at()</code>, and <code>distinct_if()</code></li>
<li><code>filter_all()</code>, <code>filter_at()</code>, and <code>filter_if()</code></li>
<li><code>group_by_all()</code>, <code>group_by_at()</code>, and <code>group_by_if()</code></li>
<li><code>select_all()</code>, <code>select_at()</code>, and <code>select_if()</code></li>
</ul>
        </div>

        <div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>本文于 2019-04-29 更新</span>
            </div>
            <div class="post-info-license">
                
            </div>
        </div>
        <div class="post-info-line">
            <div class="post-info-md">
                
                    
                        <span><a class="link-to-markdown" href="/2019/04/2019-04-29-dplyr-for-single-table/index.md" target="_blank">阅读原始文档</a></span>
                    
                
            </div>
            <div class="post-info-share">
                
                    <span></span>
                
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section>
            
                
                    <span class="tag">
                        <a href="/tags/r/"><i class="fas fa-tag fa-fw"></i>R</a>
                    </span>
                
                    <span class="tag">
                        <a href="/tags/%E4%B8%AD%E6%96%87/"><i class="fas fa-tag fa-fw"></i>中文</a>
                    </span>
                
            
        </section>
        <section>
            <span><a href="javascript:window.history.back();">返回</a></span>&nbsp;|&nbsp;<span><a href="/">主页</a></span>
        </section>
    </div>

    <div class="post-nav">
        
            <a href="/2019/04/2019-04-27-update-r/" class="prev" rel="prev" title="更新R"><i class="fas fa-angle-left fa-fw"></i>更新R</a>
        
        
            <a href="/2019/04/2019-04-30-k-nearest-neighbor/" class="next" rel="next" title="k-NN">k-NN<i class="fas fa-angle-right fa-fw"></i></a>
        
    </div>
</div>

        <div class="post-comment">
            
            

            
        </div>
    </article></div>
            </main>
            <footer class="footer">
    <div class="copyright">
        <div class="copyright-line">
            由 <a href="https://gohugo.io/" target="_blank" rel="external nofollow noopener noreffer">Hugo</a> 强力驱动&nbsp;|&nbsp;主题 - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="external nofollow noopener noreffer">LoveIt<i class="far fa-heart fa-fw"></i></a>
        </div>
        <div class="copyright-line">
            <i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2018 - 2019</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/">hoas</a></span><span class="license">&nbsp;|&nbsp;<a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
    </div>
    <script>
        (function(u, c) {
         var d = document, t = 'script', o = d.createElement(t),
              s = d.getElementsByTagName(t)[0];
         o.src = u;
         if (c) { o.addEventListener('load', function(e) { c(e); }); }
         s.parentNode.insertBefore(o, s);
        })('//cdn.bootcss.com/pangu/3.3.0/pangu.min.js', function() {
            pangu.spacingPage();
            
        });
    </script>
</footer>


    
    




    
    




    
    





    
    



    
    



    
    





    
    





    
    



    
    





    
    




    
    




    
    



    
    





    
    


<script src="/js/lib/jquery/jquery.slim.min.min.js"></script>
<script src="/js/lib/lazysizes/lazysizes.min.min.js"></script>
<script src="/js/lib/smooth-scroll/smooth-scroll.polyfills.min.min.js"></script><script>window.scroll = new SmoothScroll('[data-scroll]', {speed: 300, speedAsDuration: true});</script>


    
    

    

    

    

    






<script src="/js/blog.min.js"></script>


    
</div>
        <a href="#" class="dynamic-to-top" id="dynamic-to-top" data-scroll><span>&nbsp;</span></a>
    </body>
</html>