<!DOCTYPE html>
<html lang="zh">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>janitor数据清洗 | hoas&#39; blog | One Stupid Boy</title><meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="robots" content="noodp" />
<meta name="Description" content="data cleaning with janitor in r">
<link rel="prev" href="/2019/04/2019-04-18-summary-of-course-design/" />
<link rel="next" href="/2019/04/2019-04-25-055/" />
<link rel="canonical" href="/2019/04/2019-04-23-data-cleaning-with-janitor-in-r/" />
<link rel='shortcut icon' type='image/x-icon' href='/favicon.ico' />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="janitor数据清洗"/>
<meta name="twitter:description" content="data cleaning with janitor in r"/>
<script type="application/ld+json">
    {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "headline": "janitor数据清洗",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "\/2019\/04\/2019-04-23-data-cleaning-with-janitor-in-r\/"
    },
    
        "image": {
            "@type": "ImageObject",
            "url": "\/cover.png",
            "width":  800 ,
            "height":  600 
        },
    
    "genre": "posts",
    
        "keywords": "R, 中文",
    
    "wordcount":  2254 ,
    "url": "\/2019\/04\/2019-04-23-data-cleaning-with-janitor-in-r\/",
    
        "datePublished": "2019-04-23T00:00:00\x2b00:00",
    
    
        "dateModified": "2019-04-23T16:58:11\x2b08:00",
    
    
        "license": "This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.",
    
    
        "publisher": {
            "@type": "Organization",
            "name": "XXXX",
            "logo": {
            "@type": "ImageObject",
            "url": "\/logo.png",
            "width":  127 ,
            "height":  40 
            }
        },
    
    
    "description": "data cleaning with janitor in r"
    }
    </script>
<link rel="stylesheet" href="/css/style.min.css">
<link rel="stylesheet" href="/css/lib/fontawesome-free/all.min.min.css">

<link rel="stylesheet" href="/css/lib/animate/animate.min.min.css">

        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.11.2/css/all.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    </head>
    <body>
        <script>
            window.isDark = (window.localStorage && window.localStorage.getItem('theme')) === 'dark';
            window.isDark && document.body.classList.add('dark-theme');
        </script>
        <div class="wrapper">
            <nav class="navbar">
    <div class="navbar-container">
        <div class="navbar-header">
            <a href="/">hoas&#39; blog | One Stupid Boy</a>
        </div>
        <div class="navbar-menu">
            
            
                <a class="menu-item" href="/posts/" title="">文章</a>
            
                <a class="menu-item" href="/tags/" title="">标签</a>
            
                <a class="menu-item" href="/categories/" title="">目录</a>
            
                <a class="menu-item" href="/about/" title="">关于</a>
            
            <a href="javascript:void(0);" class="theme-switch"><i class="fas fa-adjust fa-rotate-180 fa-fw"></i></a>
        </div>
    </div>
</nav>
<nav class="navbar-mobile">
     <div class="navbar-container">
        <div class="navbar-header">
            <div><a href="javascript:void(0);" class="theme-switch"><i class="fas fa-adjust fa-rotate-180 fa-fw"></i></a><a href="/">hoas&#39; blog | One Stupid Boy</a></div>
            <div class="menu-toggle" id="menu-toggle">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="navbar-menu" id="mobile-menu">
            
            
                <a class="menu-item" href="/posts/" title="">文章</a>
            
                <a class="menu-item" href="/tags/" title="">标签</a>
            
                <a class="menu-item" href="/categories/" title="">目录</a>
            
                <a class="menu-item" href="/about/" title="">关于</a>
            
        </div>
    </div>
</nav><main class="main">
                <div class="container">
                    
    
    
    
       
    

    <article class="post-warp">
        <h1 class="post-title animated flipInX">janitor数据清洗</h1>

        <div class="post-meta">
            <div class="post-meta-main">
                <a class="author" href="/" rel="author"><i class="fas fa-user-circle fa-fw"></i>hoas&nbsp;</a>
                <span class="post-category">
                        收录于
                        <i class="far fa-folder fa-fw"></i><a href="/categories/fragmentray/">fragmentray</a>
                            
                    </span>
            </div>
            <div class="post-meta-other">
                <i class="far fa-calendar-alt fa-fw"></i><time datetime=2019-04-23>2019-04-23</time>&nbsp;
                <i class="fas fa-pencil-alt fa-fw"></i>约 2254 字&nbsp;
                <i class="far fa-clock fa-fw"></i>预计阅读 5 分钟&nbsp;</div>
        </div>

        

        <div class="post-toc" id="post-toc">
                <h2 class="post-toc-title">目录</h2>
                <div class="post-toc-content always-active">
                    <nav id="TableOfContents">
<ul>
<li><a href="#数据清洗">数据清洗</a>
<ul>
<li><a href="#clean-names"><code>clean_names()</code></a></li>
<li><a href="#remove-empty"><code>remove_empty()</code></a></li>
<li><a href="#excel-numeric-to-date"><code>excel_numeric_to_date()</code></a></li>
<li><a href="#coalesce"><code>coalesce()</code></a></li>
</ul></li>
<li><a href="#数据审查">数据审查</a>
<ul>
<li><a href="#get-dupes"><code>get_dupes()</code></a></li>
<li><a href="#tabyl"><code>tabyl()</code></a>
<ul>
<li><a href="#单变量">单变量</a></li>
<li><a href="#双变量">双变量</a></li>
<li><a href="#三变量">三变量</a></li>
</ul></li>
<li><a href="#adorn"><code>adorn_</code></a></li>
</ul></li>
<li><a href="#其它">其它</a>
<ul>
<li><a href="#compare-df-cols"><code>compare_df_cols()</code></a></li>
<li><a href="#round-half-up"><code>round_half_up()</code></a></li>
<li><a href="#round-to-fraction"><code>round_to_fraction()</code></a></li>
<li><a href="#row-to-names"><code>row_to_names</code></a></li>
<li><a href="#top-levels"><code>top_levels()</code></a></li>
</ul></li>
</ul>
</nav>
                </div>
            </div>
            <div class="post-toc-mobile" id="post-toc-mobile">
                <details>
                    <summary><div class="post-toc-title"><span>目录</span><span><i class="details icon fas fa-angle-down"></i></span></div></summary>
                    <div class="post-toc-content">
                        
                        
                        <nav id="TableOfContentsMobile">
<ul>
<li><a href="#数据清洗">数据清洗</a>
<ul>
<li><a href="#clean-names"><code>clean_names()</code></a></li>
<li><a href="#remove-empty"><code>remove_empty()</code></a></li>
<li><a href="#excel-numeric-to-date"><code>excel_numeric_to_date()</code></a></li>
<li><a href="#coalesce"><code>coalesce()</code></a></li>
</ul></li>
<li><a href="#数据审查">数据审查</a>
<ul>
<li><a href="#get-dupes"><code>get_dupes()</code></a></li>
<li><a href="#tabyl"><code>tabyl()</code></a>
<ul>
<li><a href="#单变量">单变量</a></li>
<li><a href="#双变量">双变量</a></li>
<li><a href="#三变量">三变量</a></li>
</ul></li>
<li><a href="#adorn"><code>adorn_</code></a></li>
</ul></li>
<li><a href="#其它">其它</a>
<ul>
<li><a href="#compare-df-cols"><code>compare_df_cols()</code></a></li>
<li><a href="#round-half-up"><code>round_half_up()</code></a></li>
<li><a href="#round-to-fraction"><code>round_to_fraction()</code></a></li>
<li><a href="#row-to-names"><code>row_to_names</code></a></li>
<li><a href="#top-levels"><code>top_levels()</code></a></li>
</ul></li>
</ul>
</nav>
                    </div>
                </details>
            </div>

        <div class="post-content">
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            <blockquote>
<p>Data scientists, according to interviews and expert estimates, spend from 50 percent to 80 percent of their time mired in this more mundane labor of collecting and preparing unruly digital data, before it can be explored for useful nuggets.</p>

<p>根据访谈和专家的估计, 数据科学家将50%到80%的时间花在收集和准备不规范的数字数据这一更为平凡的工作中, 然后才能对其进行探索。</p>

<p>– *“<a href="http://www.nytimes.com/2014/08/18/technology/for-big-data-scientists-hurdle-to-insights-is-janitor-work.html">For Big-Data Scientists, ‘Janitor Work’ Is Key Hurdle to Insight</a>”</p>

<ul>
<li>The New York Times, 2014*</li>
</ul>
</blockquote>

<p>小包也有大大的力量，<strong><a href="https://github.com/sfirke/janitor">janitor</a></strong>值得拥有！虽然是数据清洗和一般的清洗一样本就是一项“脏”的工作，可是<strong>janitor</strong>教你便捷清洗而又不失优雅！</p>

<p><center></p>

<p><figure><img src=/images/loading.svg data-sizes=auto data-src=https://github.com/sfirke/janitor/raw/master/man/figures/logo_small.png alt=janitor class=lazyload><figcaption class=image-caption>janitor</figcaption></figure></p>

<p></center></p>

<p>The main janitor functions:</p>

<ul>
<li>perfectly format data.frame column names;</li>
<li>create and format frequency tables of one, two, or three variables - think an improved <code>table()</code>; and</li>
<li>isolate partially-duplicate records.</li>
</ul>

<a class="post-dummy-target" id="数据清洗"></a><h1>数据清洗</h1>

<p><a href="https://github.com/sfirke/janitor/blob/master/dirty_data.xlsx">示例</a>中的乱数据包括：</p>

<ul>
<li><p>令人不爽的列名；</p></li>

<li><p>不含数据的Excel格式的行和列；</p></li>

<li><p>被保存为数值的时间；</p></li>

<li><p>跨越多个行的断断续续的值。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="kn">library</span><span class="p">(</span>pacman<span class="p">)</span> <span class="c1"># for loading packages</span>
p_load<span class="p">(</span>readxl<span class="p">,</span> janitor<span class="p">,</span> dplyr<span class="p">,</span> here<span class="p">)</span>

<span class="c1"># here(&#34;dirty_data.xlsx&#34;)</span>
roster_raw <span class="o">&lt;-</span> read_excel<span class="p">(</span><span class="s">&#34;E:/1R/dirty_data.xlsx&#34;</span><span class="p">)</span> <span class="c1"># available at http://github.com/sfirke/janitor</span>
<span class="c1">#&gt; New names:</span>
<span class="c1">#&gt; * Certification -&gt; Certification...9</span>
<span class="c1">#&gt; * Certification -&gt; Certification...10</span>
<span class="c1">#&gt; * Certification -&gt; Certification...11</span>
glimpse<span class="p">(</span>roster_raw<span class="p">)</span>
<span class="c1">#&gt; Observations: 13</span>
<span class="c1">#&gt; Variables: 11</span>
<span class="c1">#&gt; $ `First Name`        &lt;chr&gt; &#34;Jason&#34;, &#34;Jason&#34;, &#34;Alicia&#34;, &#34;Ada&#34;, &#34;Desus&#34;...</span>
<span class="c1">#&gt; $ `Last Name`         &lt;chr&gt; &#34;Bourne&#34;, &#34;Bourne&#34;, &#34;Keys&#34;, &#34;Lovelace&#34;, &#34;N...</span>
<span class="c1">#&gt; $ `Employee Status`   &lt;chr&gt; &#34;Teacher&#34;, &#34;Teacher&#34;, &#34;Teacher&#34;, &#34;Teacher&#34;...</span>
<span class="c1">#&gt; $ Subject             &lt;chr&gt; &#34;PE&#34;, &#34;Drafting&#34;, &#34;Music&#34;, NA, &#34;Dean&#34;, &#34;Ph...</span>
<span class="c1">#&gt; $ `Hire Date`         &lt;dbl&gt; 39690, 39690, 37118, 27515, 41431, 11037, ...</span>
<span class="c1">#&gt; $ `% Allocated`       &lt;dbl&gt; 0.75, 0.25, 1.00, 1.00, 1.00, 0.50, 0.50, ...</span>
<span class="c1">#&gt; $ `Full time?`        &lt;chr&gt; &#34;Yes&#34;, &#34;Yes&#34;, &#34;Yes&#34;, &#34;Yes&#34;, &#34;Yes&#34;, &#34;Yes&#34;, ...</span>
<span class="c1">#&gt; $ `do not edit! ---&gt;` &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...</span>
<span class="c1">#&gt; $ Certification...9   &lt;chr&gt; &#34;Physical ed&#34;, &#34;Physical ed&#34;, &#34;Instr. musi...</span>
<span class="c1">#&gt; $ Certification...10  &lt;chr&gt; &#34;Theater&#34;, &#34;Theater&#34;, &#34;Vocal music&#34;, &#34;Comp...</span>
<span class="c1">#&gt; $ Certification...11  &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...</span>

roster <span class="o">&lt;-</span> roster_raw <span class="o">%&gt;%</span>
clean_names<span class="p">()</span> <span class="o">%&gt;%</span>
remove_empty<span class="p">(</span><span class="kt">c</span><span class="p">(</span><span class="s">&#34;rows&#34;</span><span class="p">,</span> <span class="s">&#34;cols&#34;</span><span class="p">))</span> <span class="o">%&gt;%</span>
mutate<span class="p">(</span>hire_date <span class="o">=</span> excel_numeric_to_date<span class="p">(</span>hire_date<span class="p">),</span>
     cert <span class="o">=</span> coalesce<span class="p">(</span>certification_9<span class="p">,</span> certification_10<span class="p">))</span> <span class="o">%&gt;%</span> <span class="c1"># from dplyr</span>
select<span class="p">(</span><span class="o">-</span>certification_9<span class="p">,</span> <span class="o">-</span>certification_10<span class="p">)</span> <span class="c1"># drop unwanted columns</span>

roster
<span class="c1">#&gt; # A tibble: 12 x 8</span>
<span class="c1">#&gt;    first_name last_name employee_status subject hire_date  percent_allocat~</span>
<span class="c1">#&gt;    &lt;chr&gt;      &lt;chr&gt;     &lt;chr&gt;           &lt;chr&gt;   &lt;date&gt;                &lt;dbl&gt;</span>
<span class="c1">#&gt;  1 Jason      Bourne    Teacher         PE      2008-08-30             0.75</span>
<span class="c1">#&gt;  2 Jason      Bourne    Teacher         Drafti~ 2008-08-30             0.25</span>
<span class="c1">#&gt;  3 Alicia     Keys      Teacher         Music   2001-08-15             1   </span>
<span class="c1">#&gt;  4 Ada        Lovelace  Teacher         &lt;NA&gt;    1975-05-01             1   </span>
<span class="c1">#&gt;  5 Desus      Nice      Administration  Dean    2013-06-06             1   </span>
<span class="c1">#&gt;  6 Chien-Shi~ Wu        Teacher         Physics 1930-03-20             0.5 </span>
<span class="c1">#&gt;  7 Chien-Shi~ Wu        Teacher         Chemis~ 1930-03-20             0.5 </span>
<span class="c1">#&gt;  8 James      Joyce     Teacher         English 1990-05-01             0.5 </span>
<span class="c1">#&gt;  9 Hedy       Lamarr    Teacher         Science 1976-06-08             0.5 </span>
<span class="c1">#&gt; 10 Carlos     Boozer    Coach           Basket~ 2015-08-05            NA   </span>
<span class="c1">#&gt; 11 Young      Boozer    Coach           &lt;NA&gt;    1995-01-01            NA   </span>
<span class="c1">#&gt; 12 Micheal    Larsen    Teacher         English 2009-09-15             0.8 </span>
<span class="c1">#&gt; # ... with 2 more variables: full_time &lt;chr&gt;, cert &lt;chr&gt;</span></code></pre></td></tr></table>
</div>
</div></li>
</ul>

<p><sup>Created on 2019-04-23 by the <a href="https://reprex.tidyverse.org">reprex package</a> (v0.2.1)</sup></p>

<p>配合<strong>reprex</strong>使用<code>here()</code>失败了，viewer中给出了一个C盘的路径，不知道为什么……</p>

<a class="post-dummy-target" id="clean-names"></a><h2><code>clean_names()</code></h2>

<p>列名的重命名有这些不同的格式，默认是全小写以<code>_</code>分开。</p>

<p>The desired target case (default is &ldquo;snake&rdquo;), indicated by these possible values:</p>

<ul>
<li><p>&ldquo;snake&rdquo; produces snake_case</p></li>

<li><p>&ldquo;lower_camel&rdquo; or &ldquo;small_camel&rdquo; produces lowerCamel</p></li>

<li><p>&ldquo;upper_camel&rdquo; or &ldquo;big_camel&rdquo; produces UpperCamel</p></li>

<li><p>&ldquo;screaming_snake&rdquo; or &ldquo;all_caps&rdquo; produces ALL_CAPS</p></li>

<li><p>&ldquo;lower_upper&rdquo; produces lowerUPPER</p></li>

<li><p>&ldquo;upper_lower&rdquo; produces UPPERlower</p></li>

<li><p>old_janitor: legacy compatibility option to preserve behavior of clean_names prior to addition of the &ldquo;case&rdquo; argument(janitor versions &lt;= 0.3.1 ). Provided as a quick fix for old scripts broken by the changes to clean_names in janitor v1.0.</p></li>

<li><p>&ldquo;parsed&rdquo;, &ldquo;mixed&rdquo;, &ldquo;none&rdquo;: less-common cases offered by snakecase::to_any_case. See to_any_case for details.</p></li>
</ul>

<p>base中也有统一规范化列名的函数<code>make.names()</code>，不过没有这个强大：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r">test_df <span class="o">&lt;-</span> <span class="kp">as.data.frame</span><span class="p">(</span><span class="kt">matrix</span><span class="p">(</span>ncol <span class="o">=</span> <span class="m">6</span><span class="p">))</span>
<span class="kp">names</span><span class="p">(</span>test_df<span class="p">)</span> <span class="o">&lt;-</span> <span class="kt">c</span><span class="p">(</span><span class="s">&#34;firstName&#34;</span><span class="p">,</span> <span class="s">&#34;ábc@!*&#34;</span><span class="p">,</span> <span class="s">&#34;% successful (2009)&#34;</span><span class="p">,</span>
                    <span class="s">&#34;REPEAT VALUE&#34;</span><span class="p">,</span> <span class="s">&#34;REPEAT VALUE&#34;</span><span class="p">,</span> <span class="s">&#34;&#34;</span><span class="p">)</span>

janitor<span class="o">::</span>clean_names<span class="p">(</span>test_df<span class="p">)</span>
<span class="c1">#&gt;   first_name abc percent_successful_2009 repeat_value repeat_value_2  x</span>
<span class="c1">#&gt; 1         NA  NA                      NA           NA             NA NA</span>

<span class="kp">make.names</span><span class="p">(</span><span class="kp">names</span><span class="p">(</span>test_df<span class="p">))</span>
<span class="c1">#&gt; [1] &#34;firstName&#34;            &#34;ábc...&#34;               &#34;X..successful..2009.&#34;</span>
<span class="c1">#&gt; [4] &#34;REPEAT.VALUE&#34;         &#34;REPEAT.VALUE&#34;         &#34;X&#34;</span></code></pre></td></tr></table>
</div>
</div>
<p><sup>Created on 2019-04-23 by the <a href="https://reprex.tidyverse.org">reprex package</a> (v0.2.1)</sup></p>

<p>对于单个向量有另外一个函数：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="kn">library</span><span class="p">(</span>janitor<span class="p">)</span>

x <span class="o">&lt;-</span> <span class="kp">structure</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">3</span><span class="p">,</span> names <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="s">&#34;name with space&#34;</span><span class="p">,</span> <span class="s">&#34;TwoWords&#34;</span><span class="p">,</span> <span class="s">&#34;total $ (2009)&#34;</span><span class="p">))</span>
x
<span class="c1">#&gt; name with space        TwoWords  total $ (2009) </span>
<span class="c1">#&gt;               1               2               3</span>
make_clean_names<span class="p">(</span>x<span class="p">)</span>
<span class="c1">#&gt; [1] &#34;x1&#34; &#34;x2&#34; &#34;x3&#34;</span>

name <span class="o">&lt;-</span> <span class="kt">c</span><span class="p">(</span><span class="s">&#34;hello world&#34;</span><span class="p">,</span><span class="s">&#34;hey! you$&#34;</span><span class="p">)</span>
make_clean_names<span class="p">(</span>name<span class="p">)</span>
<span class="c1">#&gt; [1] &#34;hello_world&#34; &#34;hey_you&#34;</span></code></pre></td></tr></table>
</div>
</div>
<p><sup>Created on 2019-04-23 by the <a href="https://reprex.tidyverse.org">reprex package</a> (v0.2.1)</sup></p>

<a class="post-dummy-target" id="remove-empty"></a><h2><code>remove_empty()</code></h2>

<p>移除空的行或者列：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r">q <span class="o">&lt;-</span> <span class="kt">data.frame</span><span class="p">(</span>v1 <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="kc">NA</span><span class="p">,</span> <span class="m">3</span><span class="p">),</span>
                v2 <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="kc">NA</span><span class="p">,</span> <span class="kc">NA</span><span class="p">,</span> <span class="kc">NA</span><span class="p">),</span>
                v3 <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="s">&#34;a&#34;</span><span class="p">,</span> <span class="kc">NA</span><span class="p">,</span> <span class="s">&#34;b&#34;</span><span class="p">))</span>

janitor<span class="o">::</span>remove_empty<span class="p">(</span><span class="kp">q</span><span class="p">,</span> <span class="kt">c</span><span class="p">(</span><span class="s">&#34;rows&#34;</span><span class="p">,</span> <span class="s">&#34;cols&#34;</span><span class="p">))</span>
<span class="c1">#&gt;   v1 v3</span>
<span class="c1">#&gt; 1  1  a</span>
<span class="c1">#&gt; 3  3  b</span></code></pre></td></tr></table>
</div>
</div>
<p><sup>Created on 2019-04-23 by the <a href="https://reprex.tidyverse.org">reprex package</a> (v0.2.1)</sup></p>

<p>另外<code>remove_constant()</code>是移除连续值的列。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r">janitor<span class="o">::</span>remove_constant<span class="p">(</span><span class="kt">data.frame</span><span class="p">(</span>A<span class="o">=</span><span class="m">1</span><span class="p">,</span> B<span class="o">=</span><span class="m">1</span><span class="o">:</span><span class="m">3</span><span class="p">))</span>
<span class="c1">#&gt;   B</span>
<span class="c1">#&gt; 1 1</span>
<span class="c1">#&gt; 2 2</span>
<span class="c1">#&gt; 3 3</span></code></pre></td></tr></table>
</div>
</div>
<p><sup>Created on 2019-04-23 by the <a href="https://reprex.tidyverse.org">reprex package</a> (v0.2.1)</sup></p>

<a class="post-dummy-target" id="excel-numeric-to-date"></a><h2><code>excel_numeric_to_date()</code></h2>

<p>虽然我不知道这个数字到底是怎么来的，好像和<code>POSIXlt</code>有关。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r">excel_numeric_to_date<span class="p">(</span><span class="m">41103</span><span class="p">)</span>
<span class="c1">#&gt; [1] &#34;2012-07-13&#34;</span>
excel_numeric_to_date<span class="p">(</span><span class="m">41103.01</span><span class="p">)</span> <span class="c1"># ignores decimal places, returns Date object</span>
<span class="c1">#&gt; [1] &#34;2012-07-13&#34;</span>
excel_numeric_to_date<span class="p">(</span><span class="m">41103.01</span><span class="p">,</span> include_time <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span> <span class="c1"># returns POSIXlt object</span>
<span class="c1">#&gt; [1] &#34;2012-07-13 01:14:24 EDT&#34;</span>
excel_numeric_to_date<span class="p">(</span><span class="m">41103.01</span><span class="p">,</span> date_system <span class="o">=</span> <span class="s">&#34;mac pre-2011&#34;</span><span class="p">)</span>
<span class="c1">#&gt; [1] &#34;2016-07-14&#34;</span></code></pre></td></tr></table>
</div>
</div>
<a class="post-dummy-target" id="coalesce"></a><h2><code>coalesce()</code></h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="kn">library</span><span class="p">(</span>dplyr<span class="p">)</span>

<span class="c1"># Use a single value to replace all missing values</span>
x <span class="o">&lt;-</span> <span class="kp">sample</span><span class="p">(</span><span class="kt">c</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">5</span><span class="p">,</span> <span class="kc">NA</span><span class="p">,</span> <span class="kc">NA</span><span class="p">,</span> <span class="kc">NA</span><span class="p">))</span>
coalesce<span class="p">(</span>x<span class="p">,</span> <span class="m">0L</span><span class="p">)</span>
<span class="c1">#&gt; [1] 0 1 2 0 3 0 4 5</span>

<span class="c1"># Or match together a complete vector from missing pieces</span>
y <span class="o">&lt;-</span> <span class="kt">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="kc">NA</span><span class="p">,</span> <span class="kc">NA</span><span class="p">,</span> <span class="m">5</span><span class="p">)</span>
z <span class="o">&lt;-</span> <span class="kt">c</span><span class="p">(</span><span class="kc">NA</span><span class="p">,</span> <span class="kc">NA</span><span class="p">,</span> <span class="m">3</span><span class="p">,</span> <span class="m">4</span><span class="p">,</span> <span class="m">5</span><span class="p">)</span>
coalesce<span class="p">(</span>y<span class="p">,</span> z<span class="p">)</span>
<span class="c1">#&gt; [1] 1 2 3 4 5</span>

<span class="c1"># Supply lists by splicing them into dots:</span>
vecs <span class="o">&lt;-</span> <span class="kt">list</span><span class="p">(</span>
  <span class="kt">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="kc">NA</span><span class="p">,</span> <span class="kc">NA</span><span class="p">,</span> <span class="m">5</span><span class="p">),</span>
  <span class="kt">c</span><span class="p">(</span><span class="kc">NA</span><span class="p">,</span> <span class="kc">NA</span><span class="p">,</span> <span class="m">3</span><span class="p">,</span> <span class="m">4</span><span class="p">,</span> <span class="m">5</span><span class="p">)</span>
<span class="p">)</span>
coalesce<span class="p">(</span><span class="o">!!!</span>vecs<span class="p">)</span>
<span class="c1">#&gt; [1] 1 2 3 4 5</span></code></pre></td></tr></table>
</div>
</div>
<p><sup>Created on 2019-04-23 by the <a href="https://reprex.tidyverse.org">reprex package</a> (v0.2.1)</sup></p>

<p>我惊了，三个感叹号什么鬼？！把列表合成向量？</p>

<a class="post-dummy-target" id="数据审查"></a><h1>数据审查</h1>

<a class="post-dummy-target" id="get-dupes"></a><h2><code>get_dupes()</code></h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r">roster <span class="o">%&gt;%</span> 
  get_dupes<span class="p">(</span>first_name<span class="p">,</span> last_name<span class="p">)</span>
<span class="c1">#&gt; # A tibble: 4 x 9</span>
<span class="c1">#&gt;   first_name last_name dupe_count employee_status subject hire_date </span>
<span class="c1">#&gt;   &lt;chr&gt;      &lt;chr&gt;          &lt;int&gt; &lt;chr&gt;           &lt;chr&gt;   &lt;date&gt;    </span>
<span class="c1">#&gt; 1 Chien-Shi~ Wu                 2 Teacher         Physics 1930-03-20</span>
<span class="c1">#&gt; 2 Chien-Shi~ Wu                 2 Teacher         Chemis~ 1930-03-20</span>
<span class="c1">#&gt; 3 Jason      Bourne             2 Teacher         PE      2008-08-30</span>
<span class="c1">#&gt; 4 Jason      Bourne             2 Teacher         Drafti~ 2008-08-30</span>
<span class="c1">#&gt; # ... with 3 more variables: percent_allocated &lt;dbl&gt;, full_time &lt;chr&gt;,</span>
<span class="c1">#&gt; #   cert &lt;chr&gt;</span></code></pre></td></tr></table>
</div>
</div>
<p><sup>Created on 2019-04-23 by the <a href="https://reprex.tidyverse.org">reprex package</a> (v0.2.1)</sup></p>

<a class="post-dummy-target" id="tabyl"></a><h2><code>tabyl()</code></h2>

<a class="post-dummy-target" id="单变量"></a><h3>单变量</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r">roster <span class="o">%&gt;%</span>
  tabyl<span class="p">(</span>subject<span class="p">)</span>
<span class="c1">#&gt;     subject n    percent valid_percent</span>
<span class="c1">#&gt;  Basketball 1 0.08333333           0.1</span>
<span class="c1">#&gt;   Chemistry 1 0.08333333           0.1</span>
<span class="c1">#&gt;        Dean 1 0.08333333           0.1</span>
<span class="c1">#&gt;    Drafting 1 0.08333333           0.1</span>
<span class="c1">#&gt;     English 2 0.16666667           0.2</span>
<span class="c1">#&gt;       Music 1 0.08333333           0.1</span>
<span class="c1">#&gt;          PE 1 0.08333333           0.1</span>
<span class="c1">#&gt;     Physics 1 0.08333333           0.1</span>
<span class="c1">#&gt;     Science 1 0.08333333           0.1</span>
<span class="c1">#&gt;        &lt;NA&gt; 2 0.16666667            NA</span></code></pre></td></tr></table>
</div>
</div>
<a class="post-dummy-target" id="双变量"></a><h3>双变量</h3>

<p>用来分类的变量放在第一个。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r">roster <span class="o">%&gt;%</span>
  filter<span class="p">(</span>hire_date <span class="o">&gt;</span> <span class="kp">as.Date</span><span class="p">(</span><span class="s">&#34;1950-01-01&#34;</span><span class="p">))</span> <span class="o">%&gt;%</span>
  tabyl<span class="p">(</span>employee_status<span class="p">,</span> full_time<span class="p">)</span>
<span class="c1">#&gt;  employee_status No Yes</span>
<span class="c1">#&gt;   Administration  0   1</span>
<span class="c1">#&gt;            Coach  2   0</span>
<span class="c1">#&gt;          Teacher  3   4</span></code></pre></td></tr></table>
</div>
</div>
<a class="post-dummy-target" id="三变量"></a><h3>三变量</h3>

<p>用来分类的变量放在了第三个？！</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r">roster <span class="o">%&gt;%</span>
  tabyl<span class="p">(</span>full_time<span class="p">,</span> subject<span class="p">,</span> employee_status<span class="p">,</span> show_missing_levels <span class="o">=</span> <span class="kc">FALSE</span><span class="p">)</span>
<span class="c1">#&gt; $Administration</span>
<span class="c1">#&gt;  full_time Dean</span>
<span class="c1">#&gt;        Yes    1</span>
<span class="c1">#&gt; </span>
<span class="c1">#&gt; $Coach</span>
<span class="c1">#&gt;  full_time Basketball NA_</span>
<span class="c1">#&gt;         No          1   1</span>
<span class="c1">#&gt; </span>
<span class="c1">#&gt; $Teacher</span>
<span class="c1">#&gt;  full_time Chemistry Drafting English Music PE Physics Science NA_</span>
<span class="c1">#&gt;         No         0        0       2     0  0       0       1   0</span>
<span class="c1">#&gt;        Yes         1        1       0     1  1       1       0   1</span></code></pre></td></tr></table>
</div>
</div>
<a class="post-dummy-target" id="adorn"></a><h2><code>adorn_</code></h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r">roster <span class="o">%&gt;%</span>
  tabyl<span class="p">(</span>employee_status<span class="p">,</span> full_time<span class="p">)</span> <span class="o">%&gt;%</span>
  adorn_totals<span class="p">(</span><span class="s">&#34;row&#34;</span><span class="p">)</span> <span class="o">%&gt;%</span>
  adorn_percentages<span class="p">(</span><span class="s">&#34;row&#34;</span><span class="p">)</span> <span class="o">%&gt;%</span>
  adorn_pct_formatting<span class="p">()</span> <span class="o">%&gt;%</span>
  adorn_ns<span class="p">()</span> <span class="o">%&gt;%</span>
  adorn_title<span class="p">(</span><span class="s">&#34;combined&#34;</span><span class="p">)</span>
<span class="c1">#&gt;  employee_status/full_time         No        Yes</span>
<span class="c1">#&gt;             Administration   0.0% (0) 100.0% (1)</span>
<span class="c1">#&gt;                      Coach 100.0% (2)   0.0% (0)</span>
<span class="c1">#&gt;                    Teacher  33.3% (3)  66.7% (6)</span>
<span class="c1">#&gt;                      Total  41.7% (5)  58.3% (7)</span></code></pre></td></tr></table>
</div>
</div>
<a class="post-dummy-target" id="其它"></a><h1>其它</h1>

<a class="post-dummy-target" id="compare-df-cols"></a><h2><code>compare_df_cols()</code></h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r">df1 <span class="o">&lt;-</span> <span class="kt">data.frame</span><span class="p">(</span>a <span class="o">=</span> <span class="m">1</span><span class="o">:</span><span class="m">2</span><span class="p">,</span> b <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="s">&#34;big&#34;</span><span class="p">,</span> <span class="s">&#34;small&#34;</span><span class="p">))</span> <span class="c1"># a factor by default</span>
df2 <span class="o">&lt;-</span> <span class="kt">data.frame</span><span class="p">(</span>a <span class="o">=</span> <span class="m">10</span><span class="o">:</span><span class="m">12</span><span class="p">,</span> b <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="s">&#34;medium&#34;</span><span class="p">,</span> <span class="s">&#34;small&#34;</span><span class="p">,</span> <span class="s">&#34;big&#34;</span><span class="p">),</span> <span class="kt">c</span> <span class="o">=</span> <span class="m">0</span><span class="p">,</span> stringsAsFactors <span class="o">=</span> <span class="kc">FALSE</span><span class="p">)</span>
df3 <span class="o">&lt;-</span> df1 <span class="o">%&gt;%</span>
  dplyr<span class="o">::</span>mutate<span class="p">(</span>b <span class="o">=</span> <span class="kp">as.character</span><span class="p">(</span>b<span class="p">))</span>

compare_df_cols<span class="p">(</span>df1<span class="p">,</span> df2<span class="p">,</span> df3<span class="p">)</span>
<span class="c1">#&gt;   column_name     df1       df2       df3</span>
<span class="c1">#&gt; 1           a integer   integer   integer</span>
<span class="c1">#&gt; 2           b  factor character character</span>
<span class="c1">#&gt; 3           c    &lt;NA&gt;   numeric      &lt;NA&gt;</span>

compare_df_cols<span class="p">(</span>df1<span class="p">,</span> df2<span class="p">,</span> df3<span class="p">,</span> <span class="kr">return</span> <span class="o">=</span> <span class="s">&#34;mismatch&#34;</span><span class="p">)</span>
<span class="c1">#&gt;   column_name    df1       df2       df3</span>
<span class="c1">#&gt; 1           b factor character character</span>
compare_df_cols<span class="p">(</span>df1<span class="p">,</span> df2<span class="p">,</span> df3<span class="p">,</span> <span class="kr">return</span> <span class="o">=</span> <span class="s">&#34;mismatch&#34;</span><span class="p">,</span> bind_method <span class="o">=</span> <span class="s">&#34;rbind&#34;</span><span class="p">)</span> <span class="c1"># default is dplyr::bind_rows</span>
<span class="c1">#&gt;   column_name    df1       df2       df3</span>
<span class="c1">#&gt; 1           b factor character character</span>
<span class="c1">#&gt; 2           c   &lt;NA&gt;   numeric      &lt;NA&gt;</span></code></pre></td></tr></table>
</div>
</div>
<p>另外：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r">compare_df_cols_same<span class="p">(</span>df1<span class="p">,</span> df3<span class="p">)</span>
<span class="c1">#&gt;   column_name    ..1       ..2</span>
<span class="c1">#&gt; 1           b factor character</span>
<span class="c1">#&gt; [1] FALSE</span>
compare_df_cols_same<span class="p">(</span>df2<span class="p">,</span> df3<span class="p">)</span>
<span class="c1">#&gt; [1] TRUE</span></code></pre></td></tr></table>
</div>
</div>
<a class="post-dummy-target" id="round-half-up"></a><h2><code>round_half_up()</code></h2>

<p><code>round()</code>关于5的舍取容易弄错，但是这个函数确实是四舍五入。详见：<a href="https://stackoverflow.com/questions/12688717/round-up-from-5/12688836#12688836">https://stackoverflow.com/questions/12688717/round-up-from-5/12688836#12688836</a></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r">nums <span class="o">&lt;-</span> <span class="kt">c</span><span class="p">(</span><span class="m">2.5</span><span class="p">,</span> <span class="m">3.5</span><span class="p">)</span>
<span class="kp">round</span><span class="p">(</span>nums<span class="p">)</span>
<span class="c1">#&gt; [1] 2 4</span>
round_half_up<span class="p">(</span>nums<span class="p">)</span>
<span class="c1">#&gt; [1] 3 4</span>

round_half_up<span class="p">(</span><span class="m">3.555</span><span class="p">,</span><span class="m">2</span><span class="p">)</span>
<span class="c1">#&gt; [1] 3.56</span></code></pre></td></tr></table>
</div>
</div>
<a class="post-dummy-target" id="round-to-fraction"></a><h2><code>round_to_fraction()</code></h2>

<p>这个也没搞懂，先写着吧。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r">round_to_fraction<span class="p">(</span><span class="m">1.6</span><span class="p">,</span> denominator <span class="o">=</span> <span class="m">2</span><span class="p">)</span>
<span class="c1">#&gt; [1] 1.5</span>
round_to_fraction<span class="p">(</span><span class="kc">pi</span><span class="p">,</span> denominator <span class="o">=</span> <span class="m">7</span><span class="p">)</span> <span class="c1"># 22/7</span>
<span class="c1">#&gt; [1] 3.142857</span>
round_to_fraction<span class="p">(</span><span class="kt">c</span><span class="p">(</span><span class="m">8.1</span><span class="p">,</span> <span class="m">9.2</span><span class="p">),</span> denominator <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="m">7</span><span class="p">,</span> <span class="m">8</span><span class="p">))</span>
<span class="c1">#&gt; [1] 8.142857 9.250000</span>
round_to_fraction<span class="p">(</span><span class="kt">c</span><span class="p">(</span><span class="m">8.1</span><span class="p">,</span> <span class="m">9.2</span><span class="p">),</span> denominator <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="m">7</span><span class="p">,</span> <span class="m">8</span><span class="p">),</span> digits <span class="o">=</span> <span class="m">3</span><span class="p">)</span>
<span class="c1">#&gt; [1] 8.143 9.250</span>
round_to_fraction<span class="p">(</span><span class="kt">c</span><span class="p">(</span><span class="m">8.1</span><span class="p">,</span> <span class="m">9.2</span><span class="p">,</span> <span class="m">10.3</span><span class="p">),</span> denominator <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="m">7</span><span class="p">,</span> <span class="m">8</span><span class="p">,</span> <span class="m">1001</span><span class="p">),</span> digits <span class="o">=</span> <span class="s">&#34;auto&#34;</span><span class="p">)</span>
<span class="c1">#&gt; [1]  8.1400  9.2500 10.2997</span></code></pre></td></tr></table>
</div>
</div>
<a class="post-dummy-target" id="row-to-names"></a><h2><code>row_to_names</code></h2>

<p>行转为列名：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r">dirt <span class="o">&lt;-</span> <span class="kt">data.frame</span><span class="p">(</span>X_1 <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="kc">NA</span><span class="p">,</span> <span class="s">&#34;ID&#34;</span><span class="p">,</span> <span class="m">1</span><span class="o">:</span><span class="m">3</span><span class="p">),</span>
           X_2 <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="kc">NA</span><span class="p">,</span> <span class="s">&#34;Value&#34;</span><span class="p">,</span> <span class="m">4</span><span class="o">:</span><span class="m">6</span><span class="p">))</span>

row_to_names<span class="p">(</span>dirt<span class="p">,</span> <span class="m">2</span><span class="p">)</span>
<span class="c1">#&gt;   ID Value</span>
<span class="c1">#&gt; 3  1     4</span>
<span class="c1">#&gt; 4  2     5</span>
<span class="c1">#&gt; 5  3     6</span></code></pre></td></tr></table>
</div>
</div>
<a class="post-dummy-target" id="top-levels"></a><h2><code>top_levels()</code></h2>

<p>计数和计算百分数：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r">f <span class="o">&lt;-</span> <span class="kp">factor</span><span class="p">(</span><span class="kt">c</span><span class="p">(</span><span class="s">&#34;strongly agree&#34;</span><span class="p">,</span> <span class="s">&#34;agree&#34;</span><span class="p">,</span> <span class="s">&#34;neutral&#34;</span><span class="p">,</span> <span class="s">&#34;neutral&#34;</span><span class="p">,</span> <span class="s">&#34;disagree&#34;</span><span class="p">,</span> <span class="s">&#34;strongly agree&#34;</span><span class="p">),</span>
            levels <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="s">&#34;strongly agree&#34;</span><span class="p">,</span> <span class="s">&#34;agree&#34;</span><span class="p">,</span> <span class="s">&#34;neutral&#34;</span><span class="p">,</span> <span class="s">&#34;disagree&#34;</span><span class="p">,</span> <span class="s">&#34;strongly disagree&#34;</span><span class="p">))</span>
top_levels<span class="p">(</span>f<span class="p">)</span>
<span class="c1">#&gt;                            f n   percent</span>
<span class="c1">#&gt;        strongly agree, agree 3 0.5000000</span>
<span class="c1">#&gt;                      neutral 2 0.3333333</span>
<span class="c1">#&gt;  disagree, strongly disagree 1 0.1666667</span>
top_levels<span class="p">(</span>f<span class="p">,</span> n <span class="o">=</span> <span class="m">1</span><span class="p">)</span>
<span class="c1">#&gt;                         f n   percent</span>
<span class="c1">#&gt;            strongly agree 2 0.3333333</span>
<span class="c1">#&gt;  agree, neutral, disagree 4 0.6666667</span>
<span class="c1">#&gt;         strongly disagree 0 0.0000000</span></code></pre></td></tr></table>
</div>
</div>
        </div>

        <div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>本文于 2019-04-23 更新</span>
            </div>
            <div class="post-info-license">
                
            </div>
        </div>
        <div class="post-info-line">
            <div class="post-info-md">
                
                    
                        <span><a class="link-to-markdown" href="/2019/04/2019-04-23-data-cleaning-with-janitor-in-r/index.md" target="_blank">阅读原始文档</a></span>
                    
                
            </div>
            <div class="post-info-share">
                
                    <span></span>
                
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section>
            
                
                    <span class="tag">
                        <a href="/tags/r/"><i class="fas fa-tag fa-fw"></i>R</a>
                    </span>
                
                    <span class="tag">
                        <a href="/tags/%E4%B8%AD%E6%96%87/"><i class="fas fa-tag fa-fw"></i>中文</a>
                    </span>
                
            
        </section>
        <section>
            <span><a href="javascript:window.history.back();">返回</a></span>&nbsp;|&nbsp;<span><a href="/">主页</a></span>
        </section>
    </div>

    <div class="post-nav">
        
            <a href="/2019/04/2019-04-18-summary-of-course-design/" class="prev" rel="prev" title="水文水利计算课设总结"><i class="fas fa-angle-left fa-fw"></i>水文水利计算课设总结</a>
        
        
            <a href="/2019/04/2019-04-25-055/" class="next" rel="next" title="055">055<i class="fas fa-angle-right fa-fw"></i></a>
        
    </div>
</div>

        <div class="post-comment">
            
            

            
        </div>
    </article></div>
            </main>
            <footer class="footer">
    <div class="copyright">
        <div class="copyright-line">
            由 <a href="https://gohugo.io/" target="_blank" rel="external nofollow noopener noreffer">Hugo</a> 强力驱动&nbsp;|&nbsp;主题 - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="external nofollow noopener noreffer">LoveIt<i class="far fa-heart fa-fw"></i></a>
        </div>
        <div class="copyright-line">
            <i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2018 - 2019</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/">hoas</a></span><span class="license">&nbsp;|&nbsp;<a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
    </div>
    <script>
        (function(u, c) {
         var d = document, t = 'script', o = d.createElement(t),
              s = d.getElementsByTagName(t)[0];
         o.src = u;
         if (c) { o.addEventListener('load', function(e) { c(e); }); }
         s.parentNode.insertBefore(o, s);
        })('//cdn.bootcss.com/pangu/3.3.0/pangu.min.js', function() {
            pangu.spacingPage();
            
        });
    </script>
</footer>


    
    




    
    




    
    





    
    



    
    



    
    





    
    





    
    



    
    





    
    




    
    




    
    



    
    





    
    


<script src="/js/lib/jquery/jquery.slim.min.min.js"></script>
<script src="/js/lib/lazysizes/lazysizes.min.min.js"></script>
<script src="/js/lib/smooth-scroll/smooth-scroll.polyfills.min.min.js"></script><script>window.scroll = new SmoothScroll('[data-scroll]', {speed: 300, speedAsDuration: true});</script>


    
    

    

    

    

    






<script src="/js/blog.min.js"></script>


    
</div>
        <a href="#" class="dynamic-to-top" id="dynamic-to-top" data-scroll><span>&nbsp;</span></a>
    </body>
</html>