<!DOCTYPE html>
<html lang="zh">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Particle Swarm Optimization, PSO | hoas&#39; blog | One Stupid Boy</title><meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="robots" content="noodp" />
<meta name="Description" content="Particle Swarm Optimization, PSO, 粒子群优化算法">
<link rel="prev" href="/2019/05/2019-05-02-naive-bayes/" />
<link rel="next" href="/2019/05/2019-05-04-decision-trees-and-rules/" />
<link rel="canonical" href="/2019/05/2019-05-03-particle-swarm-optimization-pso/" />
<link rel='shortcut icon' type='image/x-icon' href='/favicon.ico' />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Particle Swarm Optimization, PSO"/>
<meta name="twitter:description" content="Particle Swarm Optimization, PSO, 粒子群优化算法"/>
<script type="application/ld+json">
    {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "headline": "Particle Swarm Optimization, PSO",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "\/2019\/05\/2019-05-03-particle-swarm-optimization-pso\/"
    },
    
        "image": {
            "@type": "ImageObject",
            "url": "\/cover.png",
            "width":  800 ,
            "height":  600 
        },
    
    "genre": "posts",
    
        "keywords": "ML, R",
    
    "wordcount":  5500 ,
    "url": "\/2019\/05\/2019-05-03-particle-swarm-optimization-pso\/",
    
        "datePublished": "2019-05-03T00:00:00\x2b00:00",
    
    
        "dateModified": "2019-05-03T16:29:34\x2b08:00",
    
    
        "license": "This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.",
    
    
        "publisher": {
            "@type": "Organization",
            "name": "XXXX",
            "logo": {
            "@type": "ImageObject",
            "url": "\/logo.png",
            "width":  127 ,
            "height":  40 
            }
        },
    
    
    "description": "Particle Swarm Optimization, PSO, 粒子群优化算法"
    }
    </script>
<link rel="stylesheet" href="/css/style.min.css">
<link rel="stylesheet" href="/css/lib/fontawesome-free/all.min.min.css">

<link rel="stylesheet" href="/css/lib/animate/animate.min.min.css">

        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.11.2/css/all.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    </head>
    <body>
        <script>
            window.isDark = (window.localStorage && window.localStorage.getItem('theme')) === 'dark';
            window.isDark && document.body.classList.add('dark-theme');
        </script>
        <div class="wrapper">
            <nav class="navbar">
    <div class="navbar-container">
        <div class="navbar-header">
            <a href="/">hoas&#39; blog | One Stupid Boy</a>
        </div>
        <div class="navbar-menu">
            
            
                <a class="menu-item" href="/posts/" title="">文章</a>
            
                <a class="menu-item" href="/tags/" title="">标签</a>
            
                <a class="menu-item" href="/categories/" title="">目录</a>
            
                <a class="menu-item" href="/about/" title="">关于</a>
            
            <a href="javascript:void(0);" class="theme-switch"><i class="fas fa-adjust fa-rotate-180 fa-fw"></i></a>
        </div>
    </div>
</nav>
<nav class="navbar-mobile">
     <div class="navbar-container">
        <div class="navbar-header">
            <div><a href="javascript:void(0);" class="theme-switch"><i class="fas fa-adjust fa-rotate-180 fa-fw"></i></a><a href="/">hoas&#39; blog | One Stupid Boy</a></div>
            <div class="menu-toggle" id="menu-toggle">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="navbar-menu" id="mobile-menu">
            
            
                <a class="menu-item" href="/posts/" title="">文章</a>
            
                <a class="menu-item" href="/tags/" title="">标签</a>
            
                <a class="menu-item" href="/categories/" title="">目录</a>
            
                <a class="menu-item" href="/about/" title="">关于</a>
            
        </div>
    </div>
</nav><main class="main">
                <div class="container">
                    
    
    
    
       
    

    <article class="post-warp">
        <h1 class="post-title animated flipInX">Particle Swarm Optimization, PSO</h1>

        <div class="post-meta">
            <div class="post-meta-main">
                <a class="author" href="/" rel="author"><i class="fas fa-user-circle fa-fw"></i>hoas&nbsp;</a>
                <span class="post-category">
                        收录于
                        <i class="far fa-folder fa-fw"></i><a href="/categories/course/">course</a>
                            
                    </span>
            </div>
            <div class="post-meta-other">
                <i class="far fa-calendar-alt fa-fw"></i><time datetime=2019-05-03>2019-05-03</time>&nbsp;
                <i class="fas fa-pencil-alt fa-fw"></i>约 5500 字&nbsp;
                <i class="far fa-clock fa-fw"></i>预计阅读 11 分钟&nbsp;</div>
        </div>

        

        <div class="post-toc" id="post-toc">
                <h2 class="post-toc-title">目录</h2>
                <div class="post-toc-content always-active">
                    <nav id="TableOfContents">
<ul>
<li><a href="#pso">PSO</a>
<ul>
<li><a href="#principle">Principle</a></li>
<li><a href="#procedure">Procedure</a></li>
</ul></li>
<li><a href="#demo">Demo</a>
<ul>
<li><a href="#pso-psoptim"><code>pso::psoptim()</code></a>
<ul>
<li><a href="#1">1</a></li>
<li><a href="#2">2</a></li>
<li><a href="#3">3</a></li>
</ul></li>
<li><a href="#metaheuristicopt-pso"><code>metaheuristicOpt::PSO()</code></a></li>
</ul></li>
<li><a href="#optimize-for-parameters">Optimize for parameters</a></li>
</ul>
</nav>
                </div>
            </div>
            <div class="post-toc-mobile" id="post-toc-mobile">
                <details>
                    <summary><div class="post-toc-title"><span>目录</span><span><i class="details icon fas fa-angle-down"></i></span></div></summary>
                    <div class="post-toc-content">
                        
                        
                        <nav id="TableOfContentsMobile">
<ul>
<li><a href="#pso">PSO</a>
<ul>
<li><a href="#principle">Principle</a></li>
<li><a href="#procedure">Procedure</a></li>
</ul></li>
<li><a href="#demo">Demo</a>
<ul>
<li><a href="#pso-psoptim"><code>pso::psoptim()</code></a>
<ul>
<li><a href="#1">1</a></li>
<li><a href="#2">2</a></li>
<li><a href="#3">3</a></li>
</ul></li>
<li><a href="#metaheuristicopt-pso"><code>metaheuristicOpt::PSO()</code></a></li>
</ul></li>
<li><a href="#optimize-for-parameters">Optimize for parameters</a></li>
</ul>
</nav>
                    </div>
                </details>
            </div>

        <div class="post-content">
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            <blockquote>
<p>“Bees don’t swarm in a mango grove for nothing. Where can you see a wisp of smoke without a fire?”</p>

<p>– Hla Stavhana</p>
</blockquote>

<a class="post-dummy-target" id="pso"></a><h1>PSO</h1>

<p><strong>粒子群优化</strong>（<strong>Particle Swarm Optimization</strong>, <strong>PSO</strong>），又称<strong>微粒群算法</strong>，是由J. Kennedy和R. C. Eberhart等于1995年开发的一种演化计算技术，来源于对一个简化社会模型的模拟。其中“群（swarm）”来源于微粒群匹配M. M. Millonas在开发应用于<a href="https://zh.wikipedia.org/wiki/%E4%BA%BA%E5%B7%A5%E7%94%9F%E5%91%BD">人工生命</a>（artificial life）的模型时所提出的群体智能的5个基本原则。“粒子（particle）”是一个折衷的选择，因为既需要将群体中的成员描述为没有质量、没有体积的，同时也需要描述它的速度和加速状态。</p>

<p>PSO算法最初是为了图形化的模拟鸟群优美而不可预测的运动。而通过对动物社会行为的观察，发现在群体中对信息的社会共享提供一个演化的优势，并以此作为开发算法的基础。通过加入近邻的速度匹配、并考虑了多维搜索和根据距离的加速，形成了PSO的最初版本。之后引入了惯性权重*w*来更好的控制开发（exploitation）和探索（exploration），形成了标准版本。</p>

<p>PSO算法采用实数求解，不要求目标函数可微，而且模型参数的数量还行，原理有趣，易于实现，可以解决大规模、非线性、不可微和多峰值的复杂优化问题。该算法和其它全局优化算法一样可能陷入局部最优，后期收敛速度较慢，但是这个算法的思想还是很有意思的，非常值得学习。</p>

<a class="post-dummy-target" id="principle"></a><h2>Principle</h2>

<p>鸟群的运动给了J. Kennedy和R. C. Eberhart灵感。假设每只鸟的基本情况都是一样的，包括飞行速度（含区间）的调整、好的区域的趋向性以及经验和学习能力。它们唯一不同的地方就在于一开始在D维空间中分布的情况不同，因此可以简化为没有体积的“粒子”，在搜索空间中以一定的速度飞行，这个速度根据它本身的飞行经验和同伴的飞行经验来动态调整。第i个微粒表示为<code>Xi = （xi1, xi2, ..., xiD）</code>，它经历过的最好位置（有最好的适应值）记为<code>Pi = （pi1, pi2, ..., piD）</code>，也称为<code>pbest</code>。在群体所有微粒经历过的最好位置的索引号用符号g表示，即Pg，也称为<code>gbest</code>。微粒i的速度用<code>Vi = （vi1, vi2, ..., viD）</code>表示。对每一代，它的第d+1维（1 ≤ d+1 ≤ D）根据如下方程进行变化：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span><span class="lnt">2
</span></pre></td>
<td class="lntd">
<pre class="chroma">       vid+1 = w∙vid+c1∙rand()∙(pid-xid)+c2∙Rand()∙(pgd-xid)  
       xid+1 = xid+vid				                        </pre></td></tr></table>
</div>
</div>
<p>其中w为惯性权重（inertia weight），c1和c2为加速常数（acceleration constants），<code>rand()</code>和<code>Rand()</code>为两个在[0,1]范围里变化的随机值。</p>

<p>此外，微粒的速度Vi被一个最大速度Vmax所限制。如果当前对微粒的加速导致它的在某维的速度vid超过该维的最大速度vmax,d，则该维的速度被限制为该维最大速度vmax,d。</p>

<p>第一个公式的：</p>

<ol>
<li>第一部分为微粒先前行为的<strong>惯性</strong>；</li>
<li>第二部分为“<strong><a href="https://zh.wikipedia.org/wiki/%E8%AE%A4%E7%9F%A5">认知</a>（cognition）”部分</strong>，表示微粒本身的思考。“认知”部分可以由Thorndike的<a href="https://zh.wikipedia.org/w/index.php?title=%E6%95%88%E5%BA%94%E6%B3%95%E5%88%99&amp;action=edit&amp;redlink=1">效应法则</a>（law of effect）所解释，即一个得到加强的随机行为在将来更有可能出现。这里的行为即“认知”，并假设获得正确的知识是得到加强的，这样的一个模型假定微粒被激励着去减小误差；</li>
<li>第三部分为<strong>“社会（social）”部分</strong>，表示微粒间的信息共享与相互合作。“社会”部分可以由Bandura的<a href="https://zh.wikipedia.org/w/index.php?title=%E6%9B%BF%E4%BB%A3%E5%BC%BA%E5%8C%96&amp;action=edit&amp;redlink=1">替代强化</a>（vicarious reinforcement）所解释。根据该理论的预期，当观察者观察到一个模型在加强某一行为时，将增加它实行该行为的几率。即微粒本身的认知将被其它微粒所模仿。</li>
</ol>

<p>PSO算法使用如下心理学假设：在寻求一致的认知过程中，个体往往记住自身的信念，并同时考虑同事们的信念。当其察觉同事的信念较好的时候，将进行适应性地调整。这就是这个算法有趣的核心。</p>

<p>不过虽然粒子群法思路简单，但是相比于遗传算法的测试，PSO在收敛次数上更加不稳定，收敛次数波动较大，少则低于10，多则成百上千。</p>

<a class="post-dummy-target" id="procedure"></a><h2>Procedure</h2>

<p>标准PSO的算法流程如下：</p>

<ol>
<li>初始化一群微粒（群体规模为<code>m</code>），包括随机的位置和速度；</li>
<li>评价每个微粒的适应度；</li>
<li>对每个微粒，将它的适应值和它经历过的最好位置<code>pbest</code>的作比较，如果较好，则将其作为当前的最好位置<code>pbest</code>；</li>
<li>对每个微粒，将它的适应值和全局所经历最好位置<code>gbest</code>的作比较，如果较好，则重新设置<code>gbest</code>的索引号；</li>
<li>根据方程（1）变化微粒的速度和位置；</li>
<li>如未达到结束条件（通常为足够好的适应值或达到一个预设最大代数<code>Gmax</code>），回到2）。</li>
</ol>

<a class="post-dummy-target" id="demo"></a><h1>Demo</h1>

<a class="post-dummy-target" id="pso-psoptim"></a><h2><code>pso::psoptim()</code></h2>

<p>函数说明:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r">psoptim<span class="p">(</span>par<span class="p">,</span> fn<span class="p">,</span> gr <span class="o">=</span> <span class="kc">NULL</span><span class="p">,</span> …<span class="p">,</span> lower <span class="o">=</span> <span class="m">-1</span><span class="p">,</span> upper <span class="o">=</span> <span class="m">1</span><span class="p">,</span> control <span class="o">=</span> <span class="kt">list</span><span class="p">())</span></code></pre></td></tr></table>
</div>
</div>
<table>
<thead>
<tr>
<th>param</th>
<th>meaning</th>
</tr>
</thead>

<tbody>
<tr>
<td><code>par</code></td>
<td>Vector with length defining the dimensionality of the optimization problem. Providing actual values of <code>par</code> are not necessary (<code>NA</code> is just fine). Included primarily for compatibility with <code>optim</code> but if values are provided within the <code>lower</code> and <code>upper</code> bounds then the first particle will be initialized to the position provided by <code>par</code>.</td>
</tr>

<tr>
<td><code>fn</code></td>
<td>A function to be minimized (or maximized), with first argument the vector of parameters over which minimization is to take place. It should return a scalar result.</td>
</tr>

<tr>
<td><code>gr</code></td>
<td>A function to return the gradient if local search is BFGS. If it is <code>NULL</code>, a finite-difference approximation will be used.</td>
</tr>

<tr>
<td><code>...</code></td>
<td>Further arguments to be passed to <code>fn</code> and <code>gr</code>.</td>
</tr>

<tr>
<td><code>lower</code></td>
<td>Lower bounds on the variables.</td>
</tr>

<tr>
<td><code>upper</code></td>
<td>Upper bounds on the variables.</td>
</tr>

<tr>
<td><code>control</code></td>
<td>A list of control parameters. See “Details”.</td>
</tr>
</tbody>
</table>

<ul>
<li><strong>par</strong>  定义最佳化问题的维度，一般用NA就可以了</li>
<li><strong>fn</strong>  适应值函数（最佳化的目标函数）</li>
<li><strong>gr</strong>  如果局部搜索使用的是BFGS，那么这个参数表示返回对应梯度的函数。如果该参数为<code>NULL</code>，表示将使用有限差分的方法</li>
<li><strong>lower upper</strong>  搜索范围</li>
<li><strong>control</strong>  其他选项的控制，选项如下：</li>
<li><strong>trace</strong>  是否显示每次迭代的过程，显示(trace=1)不显示(trace = 0)，预设为0</li>
<li><strong>fnscale</strong>  最大化(fnscale = -1, 值为-1倍)或最小化(fnscale = 1)，预设为1，如果为2，那么values = values/2</li>
<li><strong>maxit</strong>  最大迭代次数，预设maxit=1000</li>
<li><strong>maxf</strong>  停止的条件，适应值函数的最大值，预设Inf</li>
<li><strong>abstol</strong>  停止的条件，适应值函数的最小值，预设-Inf</li>
<li><strong>REPORT</strong>  显示迭代过程的步长，预设50</li>
<li><strong>s</strong>  粒子群的大小（数量），预设floor(10+2*sqrt(length(par)))</li>
<li><strong>w</strong>  粒子移动速度的权重，预设1/(2*log(2))</li>
<li><strong>cp</strong>  个体最佳解的权重，预设5+log(2)</li>
<li><strong>cg</strong>  整体最佳解的权重，预设5+log(2)</li>
<li><strong>v.max</strong>  移动速度的大小，预设v.max*d</li>
</ul>

<p><a href="https://rdrr.io/cran/pso/man/psoptim.html">Details</a></p>

<a class="post-dummy-target" id="1"></a><h3>1</h3>

<p>直接上源码吧，接下来的问题是一个三维空间的求最小值的问题：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="kn">library</span><span class="p">(</span>rgl<span class="p">)</span>
x <span class="o">&lt;-</span> <span class="p">(</span><span class="m">-100</span><span class="o">:</span><span class="m">100</span><span class="p">)</span>
y <span class="o">&lt;-</span> <span class="p">(</span><span class="m">-100</span><span class="o">:</span><span class="m">100</span><span class="p">)</span>
z <span class="o">&lt;-</span> <span class="kt">matrix</span><span class="p">(</span><span class="kp">mapply</span><span class="p">(</span><span class="kr">function</span><span class="p">(</span>i<span class="p">)</span> <span class="p">{</span>
  <span class="kp">mapply</span><span class="p">(</span><span class="kr">function</span><span class="p">(</span>v0<span class="p">)</span> <span class="p">{</span>
    <span class="kr">return</span><span class="p">(</span><span class="kp">sqrt</span><span class="p">(</span>i<span class="o">^</span><span class="m">2</span> <span class="o">+</span> v0<span class="o">^</span><span class="m">2</span><span class="p">))</span>
  <span class="p">},</span> y<span class="p">)</span>
<span class="p">},</span> x<span class="p">),</span>
nrow <span class="o">=</span> <span class="m">201</span><span class="p">,</span> byrow <span class="o">=</span> <span class="bp">T</span>
<span class="p">)</span>
open3d<span class="p">()</span>
<span class="c1">#&gt; wgl </span>
<span class="c1">#&gt;   1</span>
surface3d<span class="p">(</span>x<span class="p">,</span> y<span class="p">,</span> z<span class="p">,</span> back <span class="o">=</span> <span class="s">&#34;lines&#34;</span><span class="p">,</span> color <span class="o">=</span> terrain.colors<span class="p">(</span>z<span class="o">^</span><span class="m">0.2</span><span class="p">))</span>

<span class="c1">#1.初始化粒子群（包含20个粒子）</span>
vmax<span class="o">&lt;-</span><span class="m">30</span>
pbest<span class="o">&lt;-</span><span class="kc">NULL</span>
gbest<span class="o">&lt;-</span><span class="kc">NULL</span>
gbest.add<span class="o">&lt;-</span><span class="kc">NULL</span>
w<span class="o">&lt;-</span><span class="m">1</span> <span class="c1">#设置惯性权重</span>
c1<span class="o">&lt;-</span>c2<span class="o">&lt;-</span><span class="m">2</span> <span class="c1">#设置加速度常数</span>
iters<span class="o">&lt;-</span><span class="m">1000</span><span class="c1">#设置最大迭代次数</span>
alpha<span class="o">&lt;-</span><span class="m">0.001</span><span class="c1">#设置最佳适应度值的增量阈值</span>

xMat<span class="o">&lt;-</span><span class="kt">matrix</span><span class="p">(</span><span class="kt">c</span><span class="p">(</span>x<span class="o">=</span>runif<span class="p">(</span><span class="m">20</span><span class="p">,</span><span class="m">-100</span><span class="p">,</span><span class="m">100</span><span class="p">),</span>y<span class="o">=</span>runif<span class="p">(</span><span class="m">20</span><span class="p">,</span><span class="m">-100</span><span class="p">,</span><span class="m">100</span><span class="p">)),</span>byrow<span class="o">=</span><span class="bp">F</span><span class="p">,</span>ncol<span class="o">=</span><span class="m">2</span><span class="p">,</span>
             dimnames<span class="o">=</span><span class="kt">list</span><span class="p">(</span><span class="kc">NULL</span><span class="p">,</span><span class="kt">c</span><span class="p">(</span><span class="s">&#34;x&#34;</span><span class="p">,</span><span class="s">&#34;y&#34;</span><span class="p">)))</span>

vMat<span class="o">&lt;-</span><span class="kt">matrix</span><span class="p">(</span><span class="kt">c</span><span class="p">(</span>x<span class="o">=</span>runif<span class="p">(</span><span class="m">20</span><span class="p">,</span><span class="o">-</span>vmax<span class="p">,</span>vmax<span class="p">),</span>y<span class="o">=</span>runif<span class="p">(</span><span class="m">20</span><span class="p">,</span><span class="o">-</span>vmax<span class="p">,</span>vmax<span class="p">)),</span>byrow<span class="o">=</span><span class="bp">F</span><span class="p">,</span>ncol<span class="o">=</span><span class="m">2</span><span class="p">,</span>
             dimnames<span class="o">=</span><span class="kt">list</span><span class="p">(</span><span class="kc">NULL</span><span class="p">,</span><span class="kt">c</span><span class="p">(</span><span class="s">&#34;x&#34;</span><span class="p">,</span><span class="s">&#34;y&#34;</span><span class="p">)))</span>

<span class="c1">#2.计算种群中所有粒子的适应度</span>
adjusts<span class="o">&lt;-</span><span class="kp">apply</span><span class="p">(</span>xMat<span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="kr">function</span><span class="p">(</span>v<span class="p">){</span><span class="m">1</span><span class="o">/</span><span class="kp">sqrt</span><span class="p">(</span><span class="kp">sum</span><span class="p">(</span>v<span class="o">^</span><span class="m">2</span><span class="p">)</span><span class="m">+1</span><span class="p">)})</span>

<span class="c1">#3.更新pbest、gbest，同时更新所有粒子的位置与速度</span>
pbest<span class="o">&lt;-</span>xMat
pbest<span class="o">&lt;-</span><span class="kp">cbind</span><span class="p">(</span>pbest<span class="p">,</span>adjusts<span class="p">)</span>
gbest<span class="o">&lt;-</span>pbest<span class="p">[</span><span class="kp">which.max</span><span class="p">(</span>pbest<span class="p">[,</span><span class="m">3</span><span class="p">]),]</span>
<span class="kr">for</span><span class="p">(</span>k <span class="kr">in</span> <span class="m">1</span><span class="o">:</span>iters<span class="p">)</span>
<span class="p">{</span>
  <span class="c1">#---更新pbest</span>
  <span class="c1">#遍历adjusts，如果对应粒子的适应度是历史中最高的，则完成替换</span>
  <span class="kp">mapply</span><span class="p">(</span><span class="kr">function</span><span class="p">(</span>no<span class="p">,</span>adj<span class="p">){</span>
    <span class="kr">if</span><span class="p">(</span>adj<span class="o">&gt;</span>pbest<span class="p">[</span>no<span class="p">,</span><span class="m">3</span><span class="p">])</span>
    <span class="p">{</span>
      pbest<span class="p">[</span>no<span class="p">,]</span><span class="o">&lt;&lt;-</span><span class="kt">c</span><span class="p">(</span>xMat<span class="p">[</span>no<span class="p">,],</span>adj<span class="p">)</span>
      <span class="c1">#print(&#34;--更新pbest&#34;)</span>
    <span class="p">}</span>
  <span class="p">},</span><span class="m">1</span><span class="o">:</span><span class="kp">length</span><span class="p">(</span>adjusts<span class="p">),</span>adjusts<span class="p">)</span>
  <span class="c1">#print(&#34;-----------pbest-----------&#34;)</span>
  <span class="c1">#print(pbest)</span>
  <span class="c1">#---更新gbest</span>
  <span class="kr">if</span><span class="p">(</span><span class="kp">max</span><span class="p">(</span>pbest<span class="p">[,</span><span class="m">3</span><span class="p">])</span><span class="o">&gt;</span>gbest<span class="p">[</span><span class="m">3</span><span class="p">]){</span>
    gbest.add<span class="o">&lt;-</span><span class="kp">max</span><span class="p">(</span>pbest<span class="p">[,</span><span class="m">3</span><span class="p">])</span><span class="o">-</span>gbest<span class="p">[</span><span class="m">3</span><span class="p">]</span>
    gbest<span class="o">&lt;-</span>pbest<span class="p">[</span><span class="kp">which.max</span><span class="p">(</span>pbest<span class="p">[,</span><span class="m">3</span><span class="p">]),]</span>
    <span class="kp">print</span><span class="p">(</span><span class="s">&#34;--更新gbest&#34;</span><span class="p">)</span>
    <span class="kp">print</span><span class="p">(</span>gbest.add<span class="p">)</span>
  <span class="p">}</span>
  <span class="c1">#print(&#34;-----------gbest-------------&#34;)</span>
  <span class="c1">#print(gbest)</span>
  <span class="c1">#画出对应位置的点</span>
  plot<span class="p">(</span>xMat<span class="p">[,</span><span class="m">1</span><span class="p">],</span>xMat<span class="p">[,</span><span class="m">2</span><span class="p">],</span>pch<span class="o">=</span><span class="m">20</span><span class="p">,</span>col<span class="o">=</span><span class="s">&#39;blue&#39;</span><span class="p">,</span>xlim<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="m">-100</span><span class="p">,</span><span class="m">100</span><span class="p">),</span>ylim<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="m">-100</span><span class="p">,</span><span class="m">100</span><span class="p">))</span>
  points<span class="p">(</span>gbest<span class="p">[</span><span class="m">1</span><span class="p">],</span>gbest<span class="p">[</span><span class="m">2</span><span class="p">],</span>pch<span class="o">=</span><span class="m">8</span><span class="p">,</span>col<span class="o">=</span><span class="s">&#39;red&#39;</span><span class="p">)</span>
  points<span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">,</span>pch<span class="o">=</span><span class="m">20</span><span class="p">,</span>cex<span class="o">=</span><span class="m">0.5</span><span class="p">)</span>
  points<span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">,</span>pch<span class="o">=</span><span class="m">21</span><span class="p">,</span>cex<span class="o">=</span><span class="m">2</span><span class="p">)</span>
  dev.off<span class="p">()</span>
  <span class="c1">#--更新所有粒子的位置与速度</span>
  old.xMat<span class="o">&lt;-</span>xMat
  xMat<span class="o">&lt;-</span>xMat<span class="o">+</span>vMat
  vMat<span class="o">&lt;-</span>w<span class="o">*</span>vMat<span class="o">+</span>c1<span class="o">*</span>runif<span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span>pbest<span class="p">[,</span><span class="m">1</span><span class="o">:</span><span class="m">2</span><span class="p">]</span><span class="o">-</span>old.xMat<span class="p">)</span><span class="o">+</span>c2<span class="o">*</span>runif<span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">1</span><span class="p">)</span><span class="o">*</span>
    <span class="p">(</span><span class="kt">matrix</span><span class="p">(</span><span class="kp">rep</span><span class="p">(</span>gbest<span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">2</span><span class="p">],</span><span class="m">20</span><span class="p">),</span>ncol<span class="o">=</span><span class="m">2</span><span class="p">,</span>byrow<span class="o">=</span><span class="bp">T</span><span class="p">)</span><span class="o">-</span>old.xMat<span class="p">)</span>
  <span class="c1">#----如果vMat有值超过了边界值，则设定为边界值</span>
  vMat<span class="p">[</span>vMat<span class="o">&lt;</span><span class="p">(</span><span class="o">-</span>vmax<span class="p">)]</span><span class="o">&lt;-</span><span class="p">(</span><span class="o">-</span>vmax<span class="p">)</span>
  vMat<span class="p">[</span>vMat<span class="o">&gt;</span>vmax<span class="p">]</span><span class="o">&lt;-</span>vmax
  <span class="c1">#计算更新后种群中所有粒子的适应度</span>
  adjusts<span class="o">&lt;-</span><span class="kp">apply</span><span class="p">(</span>xMat<span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="kr">function</span><span class="p">(</span>v<span class="p">){</span><span class="m">1</span><span class="o">/</span><span class="kp">sqrt</span><span class="p">(</span><span class="kp">sum</span><span class="p">(</span>v<span class="o">^</span><span class="m">2</span><span class="p">)</span><span class="m">+1</span><span class="p">)})</span>
  <span class="c1">#检查全局适应度的增量，如果小于0.0002，则算法停止</span>
  <span class="kr">if</span><span class="p">(</span><span class="o">!</span><span class="kp">is.null</span><span class="p">(</span>gbest.add<span class="p">)</span> <span class="o">&amp;&amp;</span> gbest.add<span class="o">&lt;</span><span class="m">0.0002</span><span class="p">){</span>
    <span class="kp">print</span><span class="p">(</span><span class="kp">paste</span><span class="p">(</span><span class="s">&#34;k=&#34;</span><span class="p">,</span>k<span class="p">,</span><span class="s">&#34;算法结束！&#34;</span><span class="p">))</span>
    <span class="kr">break</span><span class="p">;</span>
  <span class="p">}</span> 
<span class="p">}</span>
<span class="c1">#&gt; [1] &#34;--更新gbest&#34;</span>
<span class="c1">#&gt;    adjusts </span>
<span class="c1">#&gt; 0.02892844</span>
<span class="c1">#&gt; [1] &#34;--更新gbest&#34;</span>
<span class="c1">#&gt;     adjusts </span>
<span class="c1">#&gt; 0.005120944</span>
<span class="c1">#&gt; [1] &#34;--更新gbest&#34;</span>
<span class="c1">#&gt;    adjusts </span>
<span class="c1">#&gt; 0.02275194</span>
<span class="c1">#&gt; [1] &#34;--更新gbest&#34;</span>
<span class="c1">#&gt;   adjusts </span>
<span class="c1">#&gt; 0.1004123</span>
<span class="c1">#&gt; [1] &#34;--更新gbest&#34;</span>
<span class="c1">#&gt;    adjusts </span>
<span class="c1">#&gt; 0.03512447</span>
<span class="c1">#&gt; [1] &#34;--更新gbest&#34;</span>
<span class="c1">#&gt;    adjusts </span>
<span class="c1">#&gt; 0.04253347</span>
<span class="c1">#&gt; [1] &#34;--更新gbest&#34;</span>
<span class="c1">#&gt;   adjusts </span>
<span class="c1">#&gt; 0.2045966</span>
<span class="c1">#&gt; [1] &#34;--更新gbest&#34;</span>
<span class="c1">#&gt;    adjusts </span>
<span class="c1">#&gt; 0.00544671</span>
<span class="c1">#&gt; [1] &#34;--更新gbest&#34;</span>
<span class="c1">#&gt;   adjusts </span>
<span class="c1">#&gt; 0.1941632</span>
<span class="c1">#&gt; [1] &#34;--更新gbest&#34;</span>
<span class="c1">#&gt;    adjusts </span>
<span class="c1">#&gt; 0.06251679</span>
<span class="c1">#&gt; [1] &#34;--更新gbest&#34;</span>
<span class="c1">#&gt;   adjusts </span>
<span class="c1">#&gt; 0.1545025</span>
<span class="c1">#&gt; [1] &#34;--更新gbest&#34;</span>
<span class="c1">#&gt;    adjusts </span>
<span class="c1">#&gt; 0.09263582</span>
<span class="c1">#&gt; [1] &#34;--更新gbest&#34;</span>
<span class="c1">#&gt;     adjusts </span>
<span class="c1">#&gt; 0.006755617</span>
<span class="c1">#&gt; [1] &#34;--更新gbest&#34;</span>
<span class="c1">#&gt;      adjusts </span>
<span class="c1">#&gt; 9.462714e-05</span>
<span class="c1">#&gt; [1] &#34;k= 220 算法结束！&#34;</span>

gbest<span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">2</span><span class="p">]</span>
<span class="c1">#&gt;          x          y </span>
<span class="c1">#&gt; 0.06911701 0.04933046</span>


<span class="kn">library</span><span class="p">(</span>pso<span class="p">)</span>
psoObj <span class="o">&lt;-</span> psoptim<span class="p">(</span><span class="kp">rep</span><span class="p">(</span><span class="kc">NA</span><span class="p">,</span> <span class="m">2</span><span class="p">),</span>
                  <span class="kr">function</span><span class="p">(</span>x<span class="p">)</span> <span class="kp">sqrt</span><span class="p">(</span>x<span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="o">^</span><span class="m">2</span> <span class="o">+</span> x<span class="p">[</span><span class="m">2</span><span class="p">]</span><span class="o">^</span><span class="m">2</span><span class="p">),</span>
                  lower <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="m">-100</span><span class="p">,</span> <span class="m">-100</span><span class="p">),</span>
                  upper <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="m">100</span><span class="p">,</span> <span class="m">100</span><span class="p">),</span> control <span class="o">=</span> <span class="kt">list</span><span class="p">(</span>s <span class="o">=</span> <span class="m">50</span><span class="p">)</span>
<span class="p">)</span>
psoObj
<span class="c1">#&gt; $par</span>
<span class="c1">#&gt; [1]  1.149967e-49 -5.720875e-49</span>
<span class="c1">#&gt; </span>
<span class="c1">#&gt; $value</span>
<span class="c1">#&gt; [1] 5.835309e-49</span>
<span class="c1">#&gt; </span>
<span class="c1">#&gt; $counts</span>
<span class="c1">#&gt;  function iteration  restarts </span>
<span class="c1">#&gt;     50000      1000         0 </span>
<span class="c1">#&gt; </span>
<span class="c1">#&gt; $convergence</span>
<span class="c1">#&gt; [1] 2</span>
<span class="c1">#&gt; </span>
<span class="c1">#&gt; $message</span>
<span class="c1">#&gt; [1] &#34;Maximal number of iterations reached&#34;</span></code></pre></td></tr></table>
</div>
</div>
<p><sup>Created on 2019-05-03 by the <a href="https://reprex.tidyverse.org">reprex package</a> (v0.2.1)</sup></p>

<a class="post-dummy-target" id="2"></a><h3>2</h3>

<p>当然也可以这样玩，在维数D较少的时候最好可视化以下方便查看：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="kn">library</span><span class="p">(</span>pso<span class="p">)</span>

formula <span class="o">&lt;-</span> <span class="kr">function</span><span class="p">(</span>x<span class="p">)</span> x<span class="o">*</span><span class="kp">sin</span><span class="p">(</span><span class="m">10</span><span class="o">*</span><span class="kc">pi</span> <span class="o">*</span> x<span class="p">)</span> <span class="o">+</span> <span class="m">2</span>
<span class="c1"># curve(formula, -1, 2)</span>

psoptim<span class="p">(</span><span class="kp">rep</span><span class="p">(</span><span class="kc">NA</span><span class="p">,</span> <span class="m">1</span><span class="p">),</span>
        <span class="kr">function</span><span class="p">(</span>x<span class="p">)</span> x<span class="o">*</span><span class="kp">sin</span><span class="p">(</span><span class="m">10</span><span class="o">*</span><span class="kc">pi</span> <span class="o">*</span> x<span class="p">)</span> <span class="o">+</span> <span class="m">2</span><span class="p">,</span>
        lower <span class="o">=</span> <span class="m">0</span><span class="p">,</span>
        upper <span class="o">=</span> <span class="m">2</span><span class="p">,</span>
        control <span class="o">=</span> <span class="kt">list</span><span class="p">(</span>fnscale <span class="o">=</span> <span class="m">-1</span><span class="p">,</span>
                       maxit <span class="o">=</span> <span class="m">100</span><span class="p">),</span>
<span class="p">)</span>
<span class="c1">#&gt; $par</span>
<span class="c1">#&gt; [1] 1.850547</span>
<span class="c1">#&gt; </span>
<span class="c1">#&gt; $value</span>
<span class="c1">#&gt; [1] -3.850274</span>
<span class="c1">#&gt; </span>
<span class="c1">#&gt; $counts</span>
<span class="c1">#&gt;  function iteration  restarts </span>
<span class="c1">#&gt;      1200       100         0 </span>
<span class="c1">#&gt; </span>
<span class="c1">#&gt; $convergence</span>
<span class="c1">#&gt; [1] 2</span>
<span class="c1">#&gt; </span>
<span class="c1">#&gt; $message</span>
<span class="c1">#&gt; [1] &#34;Maximal number of iterations reached&#34;</span>


formula2 <span class="o">&lt;-</span> <span class="kr">function</span><span class="p">(</span>x<span class="p">)</span> <span class="kp">ifelse</span><span class="p">(</span>x<span class="o">&lt;</span><span class="m">1</span><span class="p">,</span> x<span class="p">,</span> <span class="m">2</span><span class="o">-</span>x<span class="p">)</span>
<span class="c1"># curve(formula2, 0, 2)</span>

psoptim<span class="p">(</span><span class="kp">rep</span><span class="p">(</span><span class="kc">NA</span><span class="p">,</span> <span class="m">1</span><span class="p">),</span>
        <span class="kr">function</span><span class="p">(</span>x<span class="p">)</span> <span class="kp">ifelse</span><span class="p">(</span>x<span class="o">&lt;</span><span class="m">1</span><span class="p">,</span> x<span class="p">,</span> <span class="m">2</span><span class="o">-</span>x<span class="p">),</span>
        lower <span class="o">=</span> <span class="m">0</span><span class="p">,</span>
        upper <span class="o">=</span> <span class="m">2</span><span class="p">,</span>
        control <span class="o">=</span> <span class="kt">list</span><span class="p">(</span>s <span class="o">=</span> <span class="m">1</span><span class="p">,</span>
                       fnscale <span class="o">=</span> <span class="m">-1</span><span class="p">),</span>
<span class="p">)</span>
<span class="c1">#&gt; $par</span>
<span class="c1">#&gt; [1] 0.5014604</span>
<span class="c1">#&gt; </span>
<span class="c1">#&gt; $value</span>
<span class="c1">#&gt; [1] -0.5014604</span>
<span class="c1">#&gt; </span>
<span class="c1">#&gt; $counts</span>
<span class="c1">#&gt;  function iteration  restarts </span>
<span class="c1">#&gt;      1000      1000         0 </span>
<span class="c1">#&gt; </span>
<span class="c1">#&gt; $convergence</span>
<span class="c1">#&gt; [1] 2</span>
<span class="c1">#&gt; </span>
<span class="c1">#&gt; $message</span>
<span class="c1">#&gt; [1] &#34;Maximal number of iterations reached&#34;</span></code></pre></td></tr></table>
</div>
</div>
<p><sup>Created on 2019-05-03 by the <a href="https://reprex.tidyverse.org">reprex package</a> (v0.2.1)</sup></p>

<p>引用一下<a href="https://www.r-bloggers.com/feature-selection-3-swarm-mentality/">R-Blogger</a>中的一幅动图（与上下文无关）：</p>

<p><center>
<figure><img src=/images/loading.svg data-sizes=auto data-src=https://i2.wp.com/static.squarespace.com/static/51156277e4b0b8b2ffe11c00/t/51ae3f26e4b08dce860b9b6e/1370373942285/pso.gif?zoom=1.25&amp;w=456 alt=pso class=lazyload><figcaption class=image-caption>pso</figcaption></figure>
</center></p>

<a class="post-dummy-target" id="3"></a><h3>3</h3>

<p>当然也可以参考：<a href="https://blog.csdn.net/qq_27755195/article/details/62216762">https://blog.csdn.net/qq_27755195/article/details/62216762</a></p>

<p>代码搬运：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="c1"># 调节参数以及生成初始粒子群 -----------------------------------------------------------</span>

<span class="c1"># 1. 定义求解函数</span>
sloveFun <span class="o">&lt;-</span> <span class="kr">function</span><span class="p">(</span>x<span class="p">){</span>
  x<span class="o">*</span><span class="kp">sin</span><span class="p">(</span><span class="m">10</span><span class="o">*</span><span class="kc">pi</span> <span class="o">*</span> x<span class="p">)</span> <span class="o">+</span> <span class="m">2</span>
<span class="p">}</span>

<span class="c1">#2. 初始化粒子群</span>
limitX <span class="o">&lt;-</span> <span class="kt">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span> <span class="m">2</span><span class="p">)</span> <span class="c1"># x限制范围</span>
vmax <span class="o">&lt;-</span> <span class="m">0.15</span> <span class="o">*</span> <span class="p">(</span>limitX<span class="p">[</span><span class="m">2</span><span class="p">]</span> <span class="o">-</span> limitX<span class="p">[</span><span class="m">1</span><span class="p">])</span>  <span class="c1"># 速度变化范围为x定义域的15%</span>
particleNum <span class="o">&lt;-</span> <span class="m">20</span> <span class="c1"># 粒子个数</span>
pbest <span class="o">&lt;-</span> <span class="kc">NULL</span>
gbest <span class="o">&lt;-</span> <span class="kc">NULL</span>
gbestAdd <span class="o">&lt;-</span> <span class="kc">NULL</span>
w <span class="o">&lt;-</span> <span class="m">1</span>          <span class="c1"># 设置惯性权重</span>
c1 <span class="o">&lt;-</span> c2 <span class="o">&lt;-</span> <span class="m">2</span>   <span class="c1"># 设置加速度常数</span>
iters <span class="o">&lt;-</span> <span class="m">10000</span>  <span class="c1"># 设置最大迭代次数</span>
alpha <span class="o">&lt;-</span> <span class="m">0.0002</span> <span class="c1"># 设置最佳适应度值的增值阈值</span>

xMat <span class="o">&lt;-</span> <span class="kt">matrix</span><span class="p">(</span><span class="kt">c</span><span class="p">(</span>x <span class="o">=</span> runif<span class="p">(</span>particleNum<span class="p">,</span> limitX<span class="p">[</span><span class="m">1</span><span class="p">],</span> limitX<span class="p">[</span><span class="m">2</span><span class="p">])),</span> dimnames <span class="o">=</span> <span class="kt">list</span><span class="p">(</span><span class="kc">NULL</span><span class="p">,</span> <span class="kt">c</span><span class="p">(</span><span class="s">&#34;x&#34;</span><span class="p">)))</span>

vMat <span class="o">&lt;-</span> <span class="kt">matrix</span><span class="p">(</span><span class="kt">c</span><span class="p">(</span>x <span class="o">=</span> runif<span class="p">(</span>particleNum<span class="p">,</span> <span class="o">-</span>vmax<span class="p">,</span> vmax<span class="p">)),</span>  dimnames <span class="o">=</span> <span class="kt">list</span><span class="p">(</span><span class="kc">NULL</span><span class="p">,</span> <span class="kt">c</span><span class="p">(</span><span class="s">&#34;x&#34;</span><span class="p">)))</span>

<span class="c1"># 计算适应度并初始化pbest/gbest ----------------------------------------------------</span>

<span class="c1">#3. 计算种群中所有粒子适应度</span>
adjusts <span class="o">&lt;-</span> <span class="kp">apply</span><span class="p">(</span>xMat<span class="p">,</span> <span class="m">1</span><span class="p">,</span> sloveFun<span class="p">)</span>

<span class="c1"># 迭代更新 --------------------------------------------------------------------</span>

<span class="c1">#4. 更新迭代pbest\gbest,同时更新所有粒子的位置与速度</span>
pbest <span class="o">&lt;-</span> <span class="kp">cbind</span><span class="p">(</span>xMat<span class="p">,</span> adjusts<span class="p">)</span>

idxAdjusts <span class="o">&lt;-</span> <span class="kp">ncol</span><span class="p">(</span>pbest<span class="p">)</span>
gbest <span class="o">&lt;-</span> pbest<span class="p">[</span><span class="kp">which.max</span><span class="p">(</span>pbest<span class="p">[,</span> idxAdjusts<span class="p">]),]</span>

<span class="kr">for</span> <span class="p">(</span>i <span class="kr">in</span> <span class="m">1</span><span class="o">:</span>iters<span class="p">){</span>
  <span class="c1">#4.1 更新pbest</span>
  <span class="c1"># ---如果当前位置比之前的位置更适应则替换之前信息</span>
  <span class="kp">mapply</span><span class="p">(</span><span class="kr">function</span><span class="p">(</span>no<span class="p">,</span> adj<span class="p">){</span>
    <span class="kr">if</span><span class="p">(</span>adj <span class="o">&gt;</span> pbest<span class="p">[</span>no<span class="p">,</span> idxAdjusts<span class="p">]){</span>
      pbest<span class="p">[</span>no<span class="p">,</span> <span class="p">]</span> <span class="o">&lt;&lt;-</span> <span class="kt">c</span><span class="p">(</span>xMat<span class="p">[</span>no<span class="p">,</span> <span class="p">],</span> adj<span class="p">)</span>
    <span class="p">}</span>
  <span class="p">},</span> <span class="m">1</span><span class="o">:</span><span class="kp">length</span><span class="p">(</span>adjusts<span class="p">),</span> adjusts<span class="p">)</span>
  
  <span class="c1">#4.2 更新gbest</span>
  <span class="kr">if</span> <span class="p">(</span><span class="kp">max</span><span class="p">(</span>pbest<span class="p">[,</span> idxAdjusts<span class="p">])</span> <span class="o">&gt;</span> gbest<span class="p">[</span>idxAdjusts<span class="p">])</span> <span class="p">{</span>
    gbestAdd <span class="o">&lt;-</span> <span class="kp">max</span><span class="p">(</span>pbest<span class="p">[,</span> idxAdjusts<span class="p">])</span> <span class="o">-</span> gbest<span class="p">[</span>idxAdjusts<span class="p">]</span>
    gbest <span class="o">&lt;-</span> pbest<span class="p">[</span><span class="kp">which.max</span><span class="p">(</span>pbest<span class="p">[,</span> idxAdjusts<span class="p">]),</span> <span class="p">]</span>
    <span class="kp">print</span><span class="p">(</span><span class="s">&#34;--更新gbest&#34;</span><span class="p">)</span>
    <span class="kp">print</span><span class="p">(</span>gbestAdd<span class="p">)</span>
  <span class="p">}</span>
  
  <span class="c1">#4.3 更新所有粒子的位置与速度</span>
  xMatOld <span class="o">&lt;-</span> xMat
  xMat <span class="o">&lt;-</span> xMat <span class="o">+</span> vMat
  vMat <span class="o">&lt;-</span> w<span class="o">*</span>vMat <span class="o">+</span>  <span class="c1"># 惯性</span>
    c1 <span class="o">*</span> runif<span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span>pbest<span class="p">[,</span> <span class="m">1</span><span class="o">:</span><span class="p">(</span>idxAdjusts <span class="o">-</span> <span class="m">1</span><span class="p">),</span> drop<span class="o">=</span><span class="bp">F</span><span class="p">]</span> <span class="o">-</span> xMatOld<span class="p">)</span> <span class="o">+</span>    <span class="c1"># 自身经验，向自身最优值靠近</span>
    c2 <span class="o">*</span> runif<span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="kt">matrix</span><span class="p">(</span><span class="kp">rep</span><span class="p">(</span>gbest<span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="p">(</span>idxAdjusts <span class="o">-</span> <span class="m">1</span><span class="p">)],</span> particleNum<span class="p">),</span> ncol <span class="o">=</span> idxAdjusts <span class="o">-</span> <span class="m">1</span> <span class="p">,</span> byrow <span class="o">=</span> <span class="bp">T</span><span class="p">)</span><span class="o">-</span>xMatOld<span class="p">)</span> <span class="c1"># 最优值信息共享</span>
  
  <span class="c1">#4.4 超界修正 </span>
  <span class="c1">#---如果vMat有值超过边界值，则设定为边界值</span>
  vMat<span class="p">[</span><span class="kp">which</span><span class="p">(</span>vMat <span class="o">&lt;</span> <span class="p">(</span><span class="o">-</span>vmax<span class="p">))]</span> <span class="o">&lt;-</span> <span class="p">(</span><span class="o">-</span>vmax<span class="p">)</span>
  vMat<span class="p">[</span><span class="kp">which</span><span class="p">(</span>vMat <span class="o">&gt;</span> <span class="p">(</span>vmax<span class="p">))]</span>  <span class="o">&lt;-</span> <span class="p">(</span>vmax<span class="p">)</span>
  <span class="c1">#---如果xMat有值超过边界值，则设为边界值</span>
  xMat<span class="p">[</span><span class="kp">which</span><span class="p">(</span>xMat <span class="o">&lt;</span> <span class="p">(</span>limitX<span class="p">[</span><span class="m">1</span><span class="p">]))]</span> <span class="o">&lt;-</span> <span class="p">(</span>limitX<span class="p">[</span><span class="m">1</span><span class="p">])</span>
  xMat<span class="p">[</span><span class="kp">which</span><span class="p">(</span>xMat <span class="o">&gt;</span> <span class="p">(</span>limitX<span class="p">[</span><span class="m">2</span><span class="p">]))]</span> <span class="o">&lt;-</span> <span class="p">(</span>limitX<span class="p">[</span><span class="m">2</span><span class="p">])</span>
  
  <span class="c1">#4.5 计算更新候选的种群适应度</span>
  adjusts <span class="o">&lt;-</span> <span class="kp">apply</span><span class="p">(</span>xMat<span class="p">,</span> <span class="m">1</span><span class="p">,</span> sloveFun<span class="p">)</span>
  
  <span class="c1">#4.6 检查全局适应度增量，如果小于最佳适应度值的增值阈值，则算法停止</span>
  <span class="kr">if</span> <span class="p">(</span><span class="o">!</span><span class="kp">is.null</span><span class="p">(</span>gbestAdd<span class="p">)</span> <span class="o">&amp;&amp;</span> gbestAdd <span class="o">&lt;</span> alpha<span class="p">)</span> <span class="p">{</span>
    <span class="kp">cat</span><span class="p">(</span><span class="s">&#34;k =&#34;</span><span class="p">,</span> i<span class="p">,</span> <span class="s">&#34;算法结束！&#34;</span><span class="p">)</span>
    <span class="kp">cat</span><span class="p">(</span><span class="s">&#34;\n&#34;</span><span class="p">,</span> <span class="s">&#34;最终结果为：&#34;</span><span class="p">,</span> gbest<span class="p">)</span>
    <span class="kr">break</span><span class="p">()</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="c1">#&gt; [1] &#34;--更新gbest&#34;</span>
<span class="c1">#&gt;   adjusts </span>
<span class="c1">#&gt; 0.5351993 </span>
<span class="c1">#&gt; [1] &#34;--更新gbest&#34;</span>
<span class="c1">#&gt;    adjusts </span>
<span class="c1">#&gt; 0.05458686 </span>
<span class="c1">#&gt; [1] &#34;--更新gbest&#34;</span>
<span class="c1">#&gt;     adjusts </span>
<span class="c1">#&gt; 0.008073979 </span>
<span class="c1">#&gt; [1] &#34;--更新gbest&#34;</span>
<span class="c1">#&gt;   adjusts </span>
<span class="c1">#&gt; 0.1086601 </span>
<span class="c1">#&gt; [1] &#34;--更新gbest&#34;</span>
<span class="c1">#&gt;  adjusts </span>
<span class="c1">#&gt; 0.225013 </span>
<span class="c1">#&gt; [1] &#34;--更新gbest&#34;</span>
<span class="c1">#&gt;      adjusts </span>
<span class="c1">#&gt; 0.0009148691 </span>
<span class="c1">#&gt; [1] &#34;--更新gbest&#34;</span>
<span class="c1">#&gt;     adjusts </span>
<span class="c1">#&gt; 0.001881695 </span>
<span class="c1">#&gt; [1] &#34;--更新gbest&#34;</span>
<span class="c1">#&gt;     adjusts </span>
<span class="c1">#&gt; 0.004746028 </span>
<span class="c1">#&gt; [1] &#34;--更新gbest&#34;</span>
<span class="c1">#&gt;      adjusts </span>
<span class="c1">#&gt; 0.0002471547 </span>
<span class="c1">#&gt; [1] &#34;--更新gbest&#34;</span>
<span class="c1">#&gt;      adjusts </span>
<span class="c1">#&gt; 9.552659e-05 </span>
<span class="c1">#&gt; k = 134 算法结束！</span>
<span class="c1">#&gt;  最终结果为： 1.850536 3.850274</span></code></pre></td></tr></table>
</div>
</div>
<p><sup>Created on 2019-05-03 by the <a href="https://reprex.tidyverse.org">reprex package</a> (v0.2.1)</sup></p>

<p><center></p>

<p><figure><img src=/images/loading.svg data-sizes=auto data-src=https://img-blog.csdn.net/20170317133206580?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjc3NTUxOTU=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast alt=pso2 class=lazyload><figcaption class=image-caption>pso2</figcaption></figure></p>

<p></center></p>

<a class="post-dummy-target" id="metaheuristicopt-pso"></a><h2><code>metaheuristicOpt::PSO()</code></h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r">PSO<span class="p">(</span>FUN<span class="p">,</span> optimType <span class="o">=</span> <span class="s">&#34;MIN&#34;</span><span class="p">,</span> numVar<span class="p">,</span> numPopulation <span class="o">=</span> <span class="m">40</span><span class="p">,</span> maxIter <span class="o">=</span> <span class="m">500</span><span class="p">,</span>
  rangeVar<span class="p">,</span> Vmax <span class="o">=</span> <span class="m">2</span><span class="p">,</span> ci <span class="o">=</span> <span class="m">1.49445</span><span class="p">,</span> cg <span class="o">=</span> <span class="m">1.49445</span><span class="p">,</span> w <span class="o">=</span> <span class="m">0.729</span><span class="p">)</span></code></pre></td></tr></table>
</div>
</div>
<p>Arguments:</p>

<table>
<thead>
<tr>
<th>param</th>
<th>meaning</th>
</tr>
</thead>

<tbody>
<tr>
<td><code>FUN</code></td>
<td>an objective function or cost function,</td>
</tr>

<tr>
<td><code>optimType</code></td>
<td>a string value that represent the type of optimization. There are two option for this arguments: <code>&quot;MIN&quot;</code> and <code>&quot;MAX&quot;</code>. The default value is <code>&quot;MIN&quot;</code>, which the function will do minimization. Otherwise, you can use <code>&quot;MAX&quot;</code>for maximization problem.</td>
</tr>

<tr>
<td><code>numVar</code></td>
<td>a positive integer to determine the number variable.<br />定义最后函数返回的变量（数值）的数量。</td>
</tr>

<tr>
<td><code>numPopulation</code></td>
<td>a positive integer to determine the number population.<br />定义粒子的数量。</td>
</tr>

<tr>
<td><code>maxIter</code></td>
<td>a positive integer to determine the maximum number of iteration.</td>
</tr>

<tr>
<td><code>rangeVar</code></td>
<td>a matrix (<em>2 \times n</em>) containing the range of variables, where <em>n</em> is the number of variables, and first and second rows are the lower bound (minimum) and upper bound (maximum) values, respectively. If all variable have equal upper bound, you can define <code>rangeVar</code> as matrix (<em>2 \times 1</em>).</td>
</tr>

<tr>
<td><code>Vmax</code></td>
<td>a positive integer to determine the maximum particle&rsquo;s velocity.</td>
</tr>

<tr>
<td><code>ci</code></td>
<td>a positive integer to determine individual cognitive.</td>
</tr>

<tr>
<td><code>cg</code></td>
<td>a positive integer to determine group cognitive.</td>
</tr>

<tr>
<td><code>w</code></td>
<td>a positive integer to determine inertia weight.</td>
</tr>
</tbody>
</table>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="c1"># PSO-1 ---------------------------------------------------------------------</span>

<span class="kn">library</span><span class="p">(</span>metaheuristicOpt<span class="p">)</span>
<span class="c1"># define sphere function as objective function</span>
f <span class="o">&lt;-</span> <span class="kr">function</span><span class="p">(</span>x<span class="p">){</span>
  x<span class="o">*</span><span class="kp">sin</span><span class="p">(</span><span class="m">10</span><span class="o">*</span><span class="kc">pi</span> <span class="o">*</span> x<span class="p">)</span> <span class="o">+</span> <span class="m">2</span>
<span class="p">}</span>

<span class="c1">## Define parameter</span>
Vmax <span class="o">&lt;-</span> <span class="m">2</span>
ci <span class="o">&lt;-</span> <span class="m">1.5</span>
cg <span class="o">&lt;-</span> <span class="m">1.5</span>
w <span class="o">&lt;-</span> <span class="m">0.7</span>
numVar <span class="o">&lt;-</span> <span class="m">2</span> <span class="c1"># 最好为1</span>
rangeVar <span class="o">&lt;-</span> <span class="kt">matrix</span><span class="p">(</span><span class="kt">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span> <span class="m">2</span><span class="p">),</span> nrow <span class="o">=</span> <span class="m">2</span><span class="p">)</span>

<span class="c1">## calculate the optimum solution using Particle Swarm Optimization Algorithm</span>
resultPSO <span class="o">&lt;-</span> PSO<span class="p">(</span>f<span class="p">,</span>
                 optimType <span class="o">=</span> <span class="s">&#34;MAX&#34;</span><span class="p">,</span> numVar<span class="p">,</span> numPopulation <span class="o">=</span> <span class="m">20</span><span class="p">,</span>
                 maxIter <span class="o">=</span> <span class="m">100</span><span class="p">,</span> rangeVar<span class="p">,</span> Vmax<span class="p">,</span> ci<span class="p">,</span> cg<span class="p">,</span> w
<span class="p">)</span>
resultPSO
<span class="c1">#&gt; [1] 1.850547 1.677820</span>

<span class="c1">## calculate the optimum value using sphere function</span>
f<span class="p">(</span>resultPSO<span class="p">)</span>
<span class="c1">#&gt; [1] 3.850274 3.076761</span>

<span class="c1"># PSO-2 -------------------------------------------------------------------</span>

<span class="kn">library</span><span class="p">(</span>metaheuristicOpt<span class="p">)</span>
<span class="c1"># define sphere function as objective function</span>
f <span class="o">&lt;-</span> <span class="kr">function</span><span class="p">(</span>x<span class="p">){</span>
  <span class="kp">sqrt</span><span class="p">(</span>x<span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="o">^</span><span class="m">2</span> <span class="o">+</span> x<span class="p">[</span><span class="m">2</span><span class="p">]</span><span class="o">^</span><span class="m">2</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1">## Define parameter</span>
Vmax <span class="o">&lt;-</span> <span class="m">2</span>
ci <span class="o">&lt;-</span> <span class="m">1.5</span>
cg <span class="o">&lt;-</span> <span class="m">1.5</span>
w <span class="o">&lt;-</span> <span class="m">0.7</span>
numVar <span class="o">&lt;-</span> <span class="m">2</span>
rangeVar <span class="o">&lt;-</span> <span class="kt">matrix</span><span class="p">(</span><span class="kt">c</span><span class="p">(</span><span class="m">-100</span><span class="p">,</span> <span class="m">100</span><span class="p">,</span> <span class="m">-100</span><span class="p">,</span> <span class="m">100</span><span class="p">),</span> nrow <span class="o">=</span> <span class="m">2</span><span class="p">)</span>

<span class="c1">## calculate the optimum solution using Particle Swarm Optimization Algorithm</span>
resultPSO <span class="o">&lt;-</span> PSO<span class="p">(</span>f<span class="p">,</span>
                 optimType <span class="o">=</span> <span class="s">&#34;MIN&#34;</span><span class="p">,</span> numVar<span class="p">,</span> numPopulation <span class="o">=</span> <span class="m">20</span><span class="p">,</span>
                 maxIter <span class="o">=</span> <span class="m">100</span><span class="p">,</span> rangeVar<span class="p">,</span> Vmax<span class="p">,</span> ci<span class="p">,</span> cg<span class="p">,</span> w
<span class="p">)</span>
resultPSO
<span class="c1">#&gt; [1] 1.203468e-06 1.165472e-06</span>

<span class="c1">## calculate the optimum value using sphere function</span>
f<span class="p">(</span>resultPSO<span class="p">)</span>
<span class="c1">#&gt; [1] 1.675309e-06</span>

<span class="c1"># demo --------------------------------------------------------------------</span>

sphere <span class="o">&lt;-</span> <span class="kr">function</span><span class="p">(</span>X<span class="p">){</span>
  <span class="kr">return</span><span class="p">(</span><span class="kp">sum</span><span class="p">(</span>X<span class="o">^</span><span class="m">2</span><span class="p">))</span>
<span class="p">}</span>

<span class="c1">## Define parameter </span>
Vmax <span class="o">&lt;-</span> <span class="m">2</span>
ci <span class="o">&lt;-</span> <span class="m">1.5</span>
cg <span class="o">&lt;-</span> <span class="m">1.5</span>
w <span class="o">&lt;-</span> <span class="m">0.7</span>
numVar <span class="o">&lt;-</span> <span class="m">5</span> <span class="c1"># 最好为1</span>
rangeVar <span class="o">&lt;-</span> <span class="kt">matrix</span><span class="p">(</span><span class="kt">c</span><span class="p">(</span><span class="m">-10</span><span class="p">,</span><span class="m">10</span><span class="p">),</span> nrow<span class="o">=</span><span class="m">2</span><span class="p">)</span>

<span class="c1">## calculate the optimum solution using Particle Swarm Optimization Algorithm</span>
PSO<span class="p">(</span>sphere<span class="p">,</span> optimType<span class="o">=</span><span class="s">&#34;MIN&#34;</span><span class="p">,</span> numVar<span class="p">,</span> numPopulation<span class="o">=</span><span class="m">20</span><span class="p">,</span> 
    maxIter<span class="o">=</span><span class="m">100</span><span class="p">,</span> rangeVar<span class="p">,</span> Vmax<span class="p">,</span> ci<span class="p">,</span> cg<span class="p">,</span> w<span class="p">)</span>
<span class="c1">#&gt; [1]  2.752593e-05 -3.125573e-05 -3.122459e-06 -1.217008e-05 -1.571504e-05</span>

<span class="c1">## calculate the optimum value using sphere function</span>
sphere<span class="p">(</span>resultPSO<span class="p">)</span>
<span class="c1">#&gt; [1] 2.806661e-12</span></code></pre></td></tr></table>
</div>
</div>
<p><sup>Created on 2019-05-04 by the <a href="https://reprex.tidyverse.org">reprex package</a> (v0.2.1)</sup></p>

<a class="post-dummy-target" id="optimize-for-parameters"></a><h1>Optimize for parameters</h1>

<p>当然对一个模型来说，确定该模型的目标函数，然后给出该模型所需的一系列待确定的参数以及参数的取值范围，那么如果想要目标函数取得一个最值（最大或者最小）那么可以采用PSO。又因为参数过多所以导致计算会很慢。</p>
        </div>

        <div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>本文于 2019-05-03 更新</span>
            </div>
            <div class="post-info-license">
                
            </div>
        </div>
        <div class="post-info-line">
            <div class="post-info-md">
                
                    
                        <span><a class="link-to-markdown" href="/2019/05/2019-05-03-particle-swarm-optimization-pso/index.md" target="_blank">阅读原始文档</a></span>
                    
                
            </div>
            <div class="post-info-share">
                
                    <span></span>
                
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section>
            
                
                    <span class="tag">
                        <a href="/tags/ml/"><i class="fas fa-tag fa-fw"></i>ML</a>
                    </span>
                
                    <span class="tag">
                        <a href="/tags/r/"><i class="fas fa-tag fa-fw"></i>R</a>
                    </span>
                
            
        </section>
        <section>
            <span><a href="javascript:window.history.back();">返回</a></span>&nbsp;|&nbsp;<span><a href="/">主页</a></span>
        </section>
    </div>

    <div class="post-nav">
        
            <a href="/2019/05/2019-05-02-naive-bayes/" class="prev" rel="prev" title="Naive Bayes"><i class="fas fa-angle-left fa-fw"></i>Naive Bayes</a>
        
        
            <a href="/2019/05/2019-05-04-decision-trees-and-rules/" class="next" rel="next" title="Decision Trees and Rules">Decision Trees and Rules<i class="fas fa-angle-right fa-fw"></i></a>
        
    </div>
</div>

        <div class="post-comment">
            
            

            
        </div>
    </article></div>
            </main>
            <footer class="footer">
    <div class="copyright">
        <div class="copyright-line">
            由 <a href="https://gohugo.io/" target="_blank" rel="external nofollow noopener noreffer">Hugo</a> 强力驱动&nbsp;|&nbsp;主题 - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="external nofollow noopener noreffer">LoveIt<i class="far fa-heart fa-fw"></i></a>
        </div>
        <div class="copyright-line">
            <i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2018 - 2019</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/">hoas</a></span><span class="license">&nbsp;|&nbsp;<a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
    </div>
    <script>
        (function(u, c) {
         var d = document, t = 'script', o = d.createElement(t),
              s = d.getElementsByTagName(t)[0];
         o.src = u;
         if (c) { o.addEventListener('load', function(e) { c(e); }); }
         s.parentNode.insertBefore(o, s);
        })('//cdn.bootcss.com/pangu/3.3.0/pangu.min.js', function() {
            pangu.spacingPage();
            
        });
    </script>
</footer>


    
    




    
    




    
    





    
    



    
    



    
    





    
    





    
    



    
    





    
    




    
    




    
    



    
    





    
    


<script src="/js/lib/jquery/jquery.slim.min.min.js"></script>
<script src="/js/lib/lazysizes/lazysizes.min.min.js"></script>
<script src="/js/lib/smooth-scroll/smooth-scroll.polyfills.min.min.js"></script><script>window.scroll = new SmoothScroll('[data-scroll]', {speed: 300, speedAsDuration: true});</script>


    
    

    

    

    

    






<script src="/js/blog.min.js"></script>


    
</div>
        <a href="#" class="dynamic-to-top" id="dynamic-to-top" data-scroll><span>&nbsp;</span></a>
    </body>
</html>