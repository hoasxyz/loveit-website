<!DOCTYPE html>
<html lang="zh">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Naive Bayes | hoas&#39; blog | One Stupid Boy</title><meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="robots" content="noodp" />
<meta name="Description" content="Naive Bayes, 朴素贝叶斯">
<link rel="prev" href="/2019/04/2019-04-30-k-nearest-neighbor/" />
<link rel="next" href="/2019/05/2019-05-03-particle-swarm-optimization-pso/" />
<link rel="canonical" href="/2019/05/2019-05-02-naive-bayes/" />
<link rel='shortcut icon' type='image/x-icon' href='/favicon.ico' />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Naive Bayes"/>
<meta name="twitter:description" content="Naive Bayes, 朴素贝叶斯"/>
<script type="application/ld+json">
    {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "headline": "Naive Bayes",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "\/2019\/05\/2019-05-02-naive-bayes\/"
    },
    
        "image": {
            "@type": "ImageObject",
            "url": "\/cover.png",
            "width":  800 ,
            "height":  600 
        },
    
    "genre": "posts",
    
        "keywords": "ML, R, 中文",
    
    "wordcount":  1616 ,
    "url": "\/2019\/05\/2019-05-02-naive-bayes\/",
    
        "datePublished": "2019-05-02T00:00:00\x2b00:00",
    
    
        "dateModified": "2019-05-02T09:00:39\x2b08:00",
    
    
        "license": "This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.",
    
    
        "publisher": {
            "@type": "Organization",
            "name": "XXXX",
            "logo": {
            "@type": "ImageObject",
            "url": "\/logo.png",
            "width":  127 ,
            "height":  40 
            }
        },
    
    
    "description": "Naive Bayes, 朴素贝叶斯"
    }
    </script>
<link rel="stylesheet" href="/css/style.min.css">
<link rel="stylesheet" href="/css/lib/fontawesome-free/all.min.min.css">

<link rel="stylesheet" href="/css/lib/animate/animate.min.min.css">

        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.11.2/css/all.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    </head>
    <body>
        <script>
            window.isDark = (window.localStorage && window.localStorage.getItem('theme')) === 'dark';
            window.isDark && document.body.classList.add('dark-theme');
        </script>
        <div class="wrapper">
            <nav class="navbar">
    <div class="navbar-container">
        <div class="navbar-header">
            <a href="/">hoas&#39; blog | One Stupid Boy</a>
        </div>
        <div class="navbar-menu">
            
            
                <a class="menu-item" href="/posts/" title="">文章</a>
            
                <a class="menu-item" href="/tags/" title="">标签</a>
            
                <a class="menu-item" href="/categories/" title="">目录</a>
            
                <a class="menu-item" href="/about/" title="">关于</a>
            
            <a href="javascript:void(0);" class="theme-switch"><i class="fas fa-adjust fa-rotate-180 fa-fw"></i></a>
        </div>
    </div>
</nav>
<nav class="navbar-mobile">
     <div class="navbar-container">
        <div class="navbar-header">
            <div><a href="javascript:void(0);" class="theme-switch"><i class="fas fa-adjust fa-rotate-180 fa-fw"></i></a><a href="/">hoas&#39; blog | One Stupid Boy</a></div>
            <div class="menu-toggle" id="menu-toggle">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="navbar-menu" id="mobile-menu">
            
            
                <a class="menu-item" href="/posts/" title="">文章</a>
            
                <a class="menu-item" href="/tags/" title="">标签</a>
            
                <a class="menu-item" href="/categories/" title="">目录</a>
            
                <a class="menu-item" href="/about/" title="">关于</a>
            
        </div>
    </div>
</nav><main class="main">
                <div class="container">
                    
    
    
    
       
    

    <article class="post-warp">
        <h1 class="post-title animated flipInX">Naive Bayes</h1>

        <div class="post-meta">
            <div class="post-meta-main">
                <a class="author" href="/" rel="author"><i class="fas fa-user-circle fa-fw"></i>hoas&nbsp;</a>
                <span class="post-category">
                        收录于
                        <i class="far fa-folder fa-fw"></i><a href="/categories/fragmentray/">fragmentray</a>
                            
                    </span>
            </div>
            <div class="post-meta-other">
                <i class="far fa-calendar-alt fa-fw"></i><time datetime=2019-05-02>2019-05-02</time>&nbsp;
                <i class="fas fa-pencil-alt fa-fw"></i>约 1616 字&nbsp;
                <i class="far fa-clock fa-fw"></i>预计阅读 4 分钟&nbsp;</div>
        </div>

        

        <div class="post-toc" id="post-toc">
                <h2 class="post-toc-title">目录</h2>
                <div class="post-toc-content always-active">
                    <nav id="TableOfContents">
<ul>
<li><a href="#bayes-theorem">Bayes’ theorem</a></li>
<li><a href="#naive-bayes">Naive Bayes</a></li>
<li><a href="#filtering-mobile-phone-spam">Filtering mobile phone spam</a></li>
<li><a href="#more">More</a>
<ul>
<li><a href="#klar-naivebayes"><code>klaR::NaiveBayes()</code></a></li>
</ul></li>
</ul>
</nav>
                </div>
            </div>
            <div class="post-toc-mobile" id="post-toc-mobile">
                <details>
                    <summary><div class="post-toc-title"><span>目录</span><span><i class="details icon fas fa-angle-down"></i></span></div></summary>
                    <div class="post-toc-content">
                        
                        
                        <nav id="TableOfContentsMobile">
<ul>
<li><a href="#bayes-theorem">Bayes’ theorem</a></li>
<li><a href="#naive-bayes">Naive Bayes</a></li>
<li><a href="#filtering-mobile-phone-spam">Filtering mobile phone spam</a></li>
<li><a href="#more">More</a>
<ul>
<li><a href="#klar-naivebayes"><code>klaR::NaiveBayes()</code></a></li>
</ul></li>
</ul>
</nav>
                    </div>
                </details>
            </div>

        <div class="post-content">
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            <a class="post-dummy-target" id="bayes-theorem"></a><h1>Bayes’ theorem</h1>

<p>这是一种和天气预报大致相同的概念方法。托马斯·贝叶斯（Thomas Bayes）发明了用来描述时间的概率以及如何根据附加信息修正概率的基本原则，这些原则构成了现在称为的<strong>贝叶斯方法</strong>（Bayesian methods）的基础。</p>

<p>基于贝叶斯方法的分类器是利用训练数据并根据特征取值提供的证据来计算每一个结果被观察到的概率。</p>

<p><strong>独立事件</strong>（independent event）同时发生的概率等于它们各自概率的乘积，但是<strong>相关事件</strong>（dependent event）却没有这么简单。相关事件之间的关系可以用贝叶斯定理（Bayes’ theorem）来描述。如下式，<strong>条件概率</strong>（conditional probability）：
$$
p(A|B)=\frac{P(A\bigcap B)}{P(B)}=\frac{P(B|A)P(A)}{P(B)}
$$
<center>
<img src="/post/!image/Bayes1.jpg" alt="Bayes' theorem">
</center></p>

<a class="post-dummy-target" id="naive-bayes"></a><h1>Naive Bayes</h1>

<p><strong>朴素贝叶斯</strong>（Naive Bayes）算法描述了一种将贝叶斯定理应用于分类问题的简单方法。</p>

<ul>
<li>朴素贝叶斯分类</li>
</ul>

<p>如果事件增加了Venn图的复杂性，那么可以利用朴素贝叶斯中的事件独立性的假设，假设<strong>类条件独立</strong>（class-conditional independence），这意味着只要事件受限于相同的类值，那么这些事件就是相互独立的。</p>

<ul>
<li>拉普拉斯估计</li>
</ul>

<p>本质上拉普拉斯估计是给频率表中的每一个计数加上一个较小的数，这样就保证每类中的每个特征发生的概率非零（别忘了分母也要加！）通常加上的数值为1。</p>

<ul>
<li>朴素贝叶斯算法中使用数值特征</li>
</ul>

<p>由于数值特征没有类别值，一个简单有效的方法就是将数值<strong>离散化</strong>（discretize），这就意味着将数值分到不同的分段（bin）中。基于这个原因，离散化有时也叫做分段（Binning）。最常用的分段方法就是探索用于自然分类的数据或者数据中分布的分割点（cut point）。</p>

<a class="post-dummy-target" id="filtering-mobile-phone-spam"></a><h1>Filtering mobile phone spam</h1>

<p>仍然是一个识别的方法。不过既然这里涉及到了文本处理，因此数据的清洗和处理会占据相当大的工作量——当然是相对于朴素贝叶斯分类来说的。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="kn">library</span><span class="p">(</span>pacman<span class="p">)</span>
p_load<span class="p">(</span>tm<span class="p">,</span> magrittr<span class="p">,</span> tidyverse<span class="p">,</span> SnowballC<span class="p">,</span> wordcloud<span class="p">,</span> e1071<span class="p">,</span> gmodels<span class="p">)</span>

<span class="kp">Sys.setlocale</span><span class="p">(</span><span class="s">&#34;LC_ALL&#34;</span><span class="p">,</span> <span class="s">&#34;English&#34;</span><span class="p">)</span>
<span class="c1">#&gt; [1] &#34;LC_COLLATE=English_United States.1252;LC_CTYPE=English_United States.1252;LC_MONETARY=English_United States.1252;LC_NUMERIC=C;LC_TIME=English_United States.1252&#34;</span>

sms_raw <span class="o">&lt;-</span> read.csv<span class="p">(</span><span class="s">&#34;E:\\1R\\Machine-Learning-with-R-datasets-master\\ML\\sms_spam.csv&#34;</span><span class="p">,</span>
                    stringsAsFactors <span class="o">=</span> <span class="kc">FALSE</span><span class="p">)</span>

<span class="c1"># str(sms_raw)</span>

sms_raw<span class="o">$</span>type <span class="o">&lt;-</span> <span class="kp">factor</span><span class="p">(</span>sms_raw<span class="o">$</span>type<span class="p">)</span>

<span class="kp">table</span><span class="p">(</span>sms_raw<span class="o">$</span>type<span class="p">)</span>
<span class="c1">#&gt; </span>
<span class="c1">#&gt;  ham spam </span>
<span class="c1">#&gt; 4827  747</span>

sms_corpus <span class="o">&lt;-</span> VCorpus<span class="p">(</span>VectorSource<span class="p">(</span>sms_raw<span class="o">$</span>text<span class="p">))</span>

<span class="c1"># lapply(sms_corpus[1:2], as.character)</span>

sms_corpus_clean <span class="o">&lt;-</span> tm_map<span class="p">(</span>sms_corpus<span class="p">,</span> content_transformer<span class="p">(</span><span class="kp">tolower</span><span class="p">))</span> <span class="o">%&gt;%</span>
  tm_map<span class="p">(</span>removeNumbers<span class="p">)</span> <span class="o">%&gt;%</span>
  tm_map<span class="p">(</span>removeWords<span class="p">,</span> stopwords<span class="p">())</span> <span class="o">%&gt;%</span>
  tm_map<span class="p">(</span>removePunctuation<span class="p">)</span> <span class="o">%&gt;%</span>
  tm_map<span class="p">(</span>stemDocument<span class="p">)</span> <span class="o">%&gt;%</span>
  tm_map<span class="p">(</span>stripWhitespace<span class="p">)</span>

<span class="c1"># replacePunctuation &lt;- function(x) {</span>
<span class="c1">#   gsub(&#34;[[:punct:]]+&#34;, &#34; &#34;, x)</span>
<span class="c1"># }</span>

sms_dtm <span class="o">&lt;-</span> DocumentTermMatrix<span class="p">(</span>sms_corpus_clean<span class="p">)</span>

<span class="c1"># sms_dtm2 &lt;- DocumentTermMatrix(sms_corpus, control = list(</span>
<span class="c1">#   tolower = TRUE,</span>
<span class="c1">#   removeNumbers = TRUE,</span>
<span class="c1">#   stopwords = TRUE,</span>
<span class="c1">#   removePunctuation = TRUE,</span>
<span class="c1">#   stemming = TRUE</span>
<span class="c1"># ))</span>

<span class="c1"># stopwords = function(x) { removeWords(x, stopwords()) }</span>

sms_dtm_train <span class="o">&lt;-</span> sms_dtm<span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">4169</span><span class="p">,</span> <span class="p">]</span>
sms_dtm_test <span class="o">&lt;-</span> sms_dtm<span class="p">[</span><span class="m">4170</span><span class="o">:</span><span class="m">5574</span><span class="p">,</span> <span class="p">]</span>

sms_train_labels <span class="o">&lt;-</span> sms_raw<span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">4169</span><span class="p">,</span> <span class="p">]</span><span class="o">$</span>type
sms_test_labels <span class="o">&lt;-</span> sms_raw<span class="p">[</span><span class="m">4170</span><span class="o">:</span><span class="m">5574</span><span class="p">,</span> <span class="p">]</span><span class="o">$</span>type

<span class="c1"># wordcloud(sms_corpus_clean, min.freq = 50, random.order = FALSE)</span>

spam <span class="o">&lt;-</span> <span class="kp">subset</span><span class="p">(</span>sms_raw<span class="p">,</span> type <span class="o">==</span> <span class="s">&#34;spam&#34;</span><span class="p">)</span>
ham <span class="o">&lt;-</span> <span class="kp">subset</span><span class="p">(</span>sms_raw<span class="p">,</span> type <span class="o">==</span> <span class="s">&#34;ham&#34;</span><span class="p">)</span>

<span class="c1"># wordcloud(spam$text, max.words = 40, scale = c(3, 0.5))</span>
<span class="c1"># wordcloud(ham$text, max.words = 40, scale = c(3, 0.5))</span>

findFreqTerms<span class="p">(</span>sms_dtm_train<span class="p">,</span> <span class="m">5</span><span class="p">)</span> <span class="o">-&gt;</span> sms_freq_words

<span class="c1"># str(sms_freq_words)</span>

sms_dtm_freq_train<span class="o">&lt;-</span> sms_dtm_train<span class="p">[</span> <span class="p">,</span> sms_freq_words<span class="p">]</span>
sms_dtm_freq_test <span class="o">&lt;-</span> sms_dtm_test<span class="p">[</span> <span class="p">,</span> sms_freq_words<span class="p">]</span>

convert_counts <span class="o">&lt;-</span> <span class="kr">function</span><span class="p">(</span>x<span class="p">)</span> <span class="p">{</span>
  x <span class="o">&lt;-</span> <span class="kp">ifelse</span><span class="p">(</span>x <span class="o">&gt;</span> <span class="m">0</span><span class="p">,</span> <span class="s">&#34;Yes&#34;</span><span class="p">,</span> <span class="s">&#34;No&#34;</span><span class="p">)</span>
<span class="p">}</span>

sms_train <span class="o">&lt;-</span> <span class="kp">apply</span><span class="p">(</span>sms_dtm_freq_train<span class="p">,</span> MARGIN <span class="o">=</span> <span class="m">2</span><span class="p">,</span>
                   convert_counts<span class="p">)</span>
sms_test <span class="o">&lt;-</span> <span class="kp">apply</span><span class="p">(</span>sms_dtm_freq_test<span class="p">,</span> MARGIN <span class="o">=</span> <span class="m">2</span><span class="p">,</span>
                    convert_counts<span class="p">)</span>

<span class="c1"># 1 -----------------------------------------------------------------------</span>

sms_classifier <span class="o">&lt;-</span> naiveBayes<span class="p">(</span>sms_train<span class="p">,</span> sms_train_labels<span class="p">)</span>

sms_test_pred <span class="o">&lt;-</span> predict<span class="p">(</span>sms_classifier<span class="p">,</span> sms_test<span class="p">)</span>

CrossTable<span class="p">(</span>sms_test_pred<span class="p">,</span> sms_test_labels<span class="p">,</span>
           prop.chisq <span class="o">=</span> <span class="kc">FALSE</span><span class="p">,</span> prop.t <span class="o">=</span> <span class="kc">FALSE</span><span class="p">,</span>
           dnn <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="s">&#39;predicted&#39;</span><span class="p">,</span> <span class="s">&#39;actual&#39;</span><span class="p">))</span>
<span class="c1">#&gt; </span>
<span class="c1">#&gt;  </span>
<span class="c1">#&gt;    Cell Contents</span>
<span class="c1">#&gt; |-------------------------|</span>
<span class="c1">#&gt; |                       N |</span>
<span class="c1">#&gt; |           N / Row Total |</span>
<span class="c1">#&gt; |           N / Col Total |</span>
<span class="c1">#&gt; |-------------------------|</span>
<span class="c1">#&gt; </span>
<span class="c1">#&gt;  </span>
<span class="c1">#&gt; Total Observations in Table:  1405 </span>
<span class="c1">#&gt; </span>
<span class="c1">#&gt;  </span>
<span class="c1">#&gt;              | actual </span>
<span class="c1">#&gt;    predicted |       ham |      spam | Row Total | </span>
<span class="c1">#&gt; -------------|-----------|-----------|-----------|</span>
<span class="c1">#&gt;          ham |      1213 |        20 |      1233 | </span>
<span class="c1">#&gt;              |     0.984 |     0.016 |     0.878 | </span>
<span class="c1">#&gt;              |     0.993 |     0.109 |           | </span>
<span class="c1">#&gt; -------------|-----------|-----------|-----------|</span>
<span class="c1">#&gt;         spam |         9 |       163 |       172 | </span>
<span class="c1">#&gt;              |     0.052 |     0.948 |     0.122 | </span>
<span class="c1">#&gt;              |     0.007 |     0.891 |           | </span>
<span class="c1">#&gt; -------------|-----------|-----------|-----------|</span>
<span class="c1">#&gt; Column Total |      1222 |       183 |      1405 | </span>
<span class="c1">#&gt;              |     0.870 |     0.130 |           | </span>
<span class="c1">#&gt; -------------|-----------|-----------|-----------|</span>
<span class="c1">#&gt; </span>
<span class="c1">#&gt; </span>

<span class="c1"># 2 -----------------------------------------------------------------------</span>

sms_classifier2 <span class="o">&lt;-</span> naiveBayes<span class="p">(</span>sms_train<span class="p">,</span> sms_train_labels<span class="p">,</span>
                              laplace <span class="o">=</span> <span class="m">1</span><span class="p">)</span>

sms_test_pred2 <span class="o">&lt;-</span> predict<span class="p">(</span>sms_classifier2<span class="p">,</span> sms_test<span class="p">)</span>

CrossTable<span class="p">(</span>sms_test_pred2<span class="p">,</span> sms_test_labels<span class="p">,</span>
           prop.chisq <span class="o">=</span> <span class="kc">FALSE</span><span class="p">,</span> prop.t <span class="o">=</span> <span class="kc">FALSE</span><span class="p">,</span> prop.r <span class="o">=</span> <span class="kc">FALSE</span><span class="p">,</span>
           dnn <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="s">&#39;predicted&#39;</span><span class="p">,</span> <span class="s">&#39;actual&#39;</span><span class="p">))</span>
<span class="c1">#&gt; </span>
<span class="c1">#&gt;  </span>
<span class="c1">#&gt;    Cell Contents</span>
<span class="c1">#&gt; |-------------------------|</span>
<span class="c1">#&gt; |                       N |</span>
<span class="c1">#&gt; |           N / Col Total |</span>
<span class="c1">#&gt; |-------------------------|</span>
<span class="c1">#&gt; </span>
<span class="c1">#&gt;  </span>
<span class="c1">#&gt; Total Observations in Table:  1405 </span>
<span class="c1">#&gt; </span>
<span class="c1">#&gt;  </span>
<span class="c1">#&gt;              | actual </span>
<span class="c1">#&gt;    predicted |       ham |      spam | Row Total | </span>
<span class="c1">#&gt; -------------|-----------|-----------|-----------|</span>
<span class="c1">#&gt;          ham |      1215 |        28 |      1243 | </span>
<span class="c1">#&gt;              |     0.994 |     0.153 |           | </span>
<span class="c1">#&gt; -------------|-----------|-----------|-----------|</span>
<span class="c1">#&gt;         spam |         7 |       155 |       162 | </span>
<span class="c1">#&gt;              |     0.006 |     0.847 |           | </span>
<span class="c1">#&gt; -------------|-----------|-----------|-----------|</span>
<span class="c1">#&gt; Column Total |      1222 |       183 |      1405 | </span>
<span class="c1">#&gt;              |     0.870 |     0.130 |           | </span>
<span class="c1">#&gt; -------------|-----------|-----------|-----------|</span>
<span class="c1">#&gt; </span>
<span class="c1">#&gt; </span></code></pre></td></tr></table>
</div>
</div>
<p><sup>Created on 2019-05-02 by the <a href="https://reprex.tidyverse.org">reprex package</a>0.2.1&rdquo;)`)</sup></p>

<p>代码涉及多种文本处理，包括创建<strong>语料库</strong>（corpus）、简化单词（hello、HELLO、Hello!）、<strong>停用词</strong>（stop word, <code>tm::stopwords()</code>）处理、创建<strong>文档-单词矩阵</strong>（Document Term Matrix, DTM, or TDM），由于单词在行的出现次数很少，因此可以认为是<strong>稀疏矩阵</strong>（sparse matrix）。</p>

<p>为了适当调节模型的性能，可以在<code>naiveBayes()</code>中设置<code>laplace = 1</code>。</p>

<p>这里的例子是离散化的字符形式，没有涉及到数值的分段。</p>

<a class="post-dummy-target" id="more"></a><h1>More</h1>

<a class="post-dummy-target" id="klar-naivebayes"></a><h2><code>klaR::NaiveBayes()</code></h2>
        </div>

        <div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>本文于 2019-05-02 更新</span>
            </div>
            <div class="post-info-license">
                
            </div>
        </div>
        <div class="post-info-line">
            <div class="post-info-md">
                
                    
                        <span><a class="link-to-markdown" href="/2019/05/2019-05-02-naive-bayes/index.md" target="_blank">阅读原始文档</a></span>
                    
                
            </div>
            <div class="post-info-share">
                
                    <span></span>
                
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section>
            
                
                    <span class="tag">
                        <a href="/tags/ml/"><i class="fas fa-tag fa-fw"></i>ML</a>
                    </span>
                
                    <span class="tag">
                        <a href="/tags/r/"><i class="fas fa-tag fa-fw"></i>R</a>
                    </span>
                
                    <span class="tag">
                        <a href="/tags/%E4%B8%AD%E6%96%87/"><i class="fas fa-tag fa-fw"></i>中文</a>
                    </span>
                
            
        </section>
        <section>
            <span><a href="javascript:window.history.back();">返回</a></span>&nbsp;|&nbsp;<span><a href="/">主页</a></span>
        </section>
    </div>

    <div class="post-nav">
        
            <a href="/2019/04/2019-04-30-k-nearest-neighbor/" class="prev" rel="prev" title="k-NN"><i class="fas fa-angle-left fa-fw"></i>k-NN</a>
        
        
            <a href="/2019/05/2019-05-03-particle-swarm-optimization-pso/" class="next" rel="next" title="Particle Swarm Optimization, PSO">Particle Swarm Optimization, PSO<i class="fas fa-angle-right fa-fw"></i></a>
        
    </div>
</div>

        <div class="post-comment">
            
            

            
        </div>
    </article></div>
            </main>
            <footer class="footer">
    <div class="copyright">
        <div class="copyright-line">
            由 <a href="https://gohugo.io/" target="_blank" rel="external nofollow noopener noreffer">Hugo</a> 强力驱动&nbsp;|&nbsp;主题 - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="external nofollow noopener noreffer">LoveIt<i class="far fa-heart fa-fw"></i></a>
        </div>
        <div class="copyright-line">
            <i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2018 - 2019</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/">hoas</a></span><span class="license">&nbsp;|&nbsp;<a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
    </div>
    <script>
        (function(u, c) {
         var d = document, t = 'script', o = d.createElement(t),
              s = d.getElementsByTagName(t)[0];
         o.src = u;
         if (c) { o.addEventListener('load', function(e) { c(e); }); }
         s.parentNode.insertBefore(o, s);
        })('//cdn.bootcss.com/pangu/3.3.0/pangu.min.js', function() {
            pangu.spacingPage();
            
        });
    </script>
</footer>


    
    




    
    




    
    





    
    



    
    



    
    





    
    





    
    



    
    





    
    




    
    




    
    



    
    





    
    


<script src="/js/lib/jquery/jquery.slim.min.min.js"></script>
<script src="/js/lib/lazysizes/lazysizes.min.min.js"></script>
<script src="/js/lib/smooth-scroll/smooth-scroll.polyfills.min.min.js"></script><script>window.scroll = new SmoothScroll('[data-scroll]', {speed: 300, speedAsDuration: true});</script>


    
    

    

    

    

    






<script src="/js/blog.min.js"></script>


    
</div>
        <a href="#" class="dynamic-to-top" id="dynamic-to-top" data-scroll><span>&nbsp;</span></a>
    </body>
</html>